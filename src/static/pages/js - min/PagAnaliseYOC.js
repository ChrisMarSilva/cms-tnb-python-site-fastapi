function iniciarAnimacaoPesquisarAnaliseYiedlCost(){$("#iRefreshYiledCost").addClass("fa-spin"),$("#btnAnaliseYiledCostPesquisar").addClass("disabled")}function finalizarAnimacaoPesquisaAnaliseYiedlCost(){$("#iRefreshYiledCost").removeClass("fa-spin"),$("#btnAnaliseYiledCostPesquisar").removeClass("disabled")}async function fLimparGridAnaliseYiedlCost(e){promise=new Promise((a,i)=>{fLimparAreaAlerta("AreaAlertaPrincAnaliseYiledCost"),$("#txtFiltroAnaliseYiledCostAtivo").val(""),fDefinirPadraoSelect("txtFiltroAnaliseYiledCostAtivo"),$("#txtFiltroAnaliseYiledCostAno").val(""),fDefinirPadraoSelect("txtFiltroAnaliseYiledCostAno"),fLimparSomenteGridAnaliseYiedlCost(e),a(!0)}).then(e=>{}).catch(e=>{})}async function fLimparSomenteGridAnaliseYiedlCost(e){try{promise=new Promise((e,a)=>{finalizarAnimacaoPesquisaAnaliseYiedlCost(),$("th").addClass("text-center"),$("#GridAnaliseYiledCost").dataTable().fnClearTable(),$("#GridAnaliseYiledCost").dataTable({bDestroy:!0}).fnDestroy(),$("#GridAnaliseYiledCost").DataTable({oLanguage:fTraduzirGrid(),aoColumns:[{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:0},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:1},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:2},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:3},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:4},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:5}],order:[],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!1,bSortable:!1,bAutoWidth:!1,bPaginate:!1,bOrdering:!1}),e(!0)}).then(e=>{}).catch(e=>{})}catch(e){fCriarAlerta("AreaAlertaPrincAnaliseYiledCost",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGridAnaliseYiedlCost(e,a){try{promise=new Promise((i,t)=>{var l=(new Date).getFullYear(),r="",s="",n="table-info";$("#GridAnaliseYiledCost").DataTable({processing:!0,serverSide:!1,iDisplayLength:10,oLanguage:fTraduzirGrid(),data:a,aoColumns:[{bSortable:!0,bOrderable:!0,sWidth:"50px",targets:0,render:function(a,i,t){return"display"==i?'<a class="text-dark font-weight-bold" style="text-decoration:none;" title="Clique Aqui para Detalhar os Proventos" href="javascript:void(0);" onclick="fAbrirModalDetalheAnaliseCalProv( \''+e+"', '"+t[0]+"', '"+t[1]+"', '13' );\"> "+t[0]+" </i> </a>":a}},{bSortable:!0,bOrderable:!0,sWidth:"50px",targets:1},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:2},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:3},{bSortable:!0,bOrderable:!0,sWidth:"50px",targets:4},{bSortable:!0,bOrderable:!0,sWidth:"50px",targets:5}],createdRow:function(e,a,i){$("td",e).addClass("text-center"),r=a[0],Ano=a[1],r!=s&&(s=r,n="table-info"==n?"":"table-info"),$(e).addClass(n),Ano==l&&$(e).addClass("font-weight-bold")},initComplete:function(e,a){finalizarAnimacaoPesquisaAnaliseYiedlCost()},order:[],dom:"frtBpi",buttons:[{extend:"excelHtml5",text:'<i class="fa fa-file-excel-o"></i> Excel',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - An치lise do Yield on Cost",titleAttr:"Excel",exportOptions:{columns:[0,1,2,3,4,5]}},{extend:"csvHtml5",charset:"UTF-8",fieldSeparator:";",titleAttr:"CSV",text:'<i class="fa fa-file-o"></i> CSV',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - An치lise do Yield on Cost",bom:!0,exportOptions:{columns:[0,1,2,3,4,5]}},{extend:"pdfHtml5",text:'<i class="fa fa-file-pdf-o"></i> PDF',className:"btn btn-default btn-sm",titleAttr:"PDF",title:NOME_PROJETO+" - An치lise do Yield on Cost",pageSize:"A3",alignment:"center",exportOptions:{columns:[0,1,2,3,4,5]},footer:!0,customize:function(e){e.defaultStyle.fontSize=12,e.styles.tableHeader.fontSize=14}},{extend:"print",text:'<i class="fa fa-print"></i> Imprimir',title:NOME_PROJETO+" - An치lise do Yield on Cost",titleAttr:"Imprimir",className:"btn btn-default btn-sm",exportOptions:{columns:[0,1,2,3,4,5]}}],order:[[0,"asc"],[1,"asc"]],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!0,bSortable:!0,bAutoWidth:!1,bPaginate:!1,bOrdering:!0}),i(!0)}).then(e=>{}).catch(e=>{})}catch(a){fLimparSomenteGridAnaliseYiedlCost(e),finalizarAnimacaoPesquisaAnaliseYiedlCost(),null!=a.description&&fCriarAlerta("AreaAlertaPrincAnaliseYiledCost",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fCarregarGridAnaliseYiedlCost(e){try{promise=new Promise((a,i)=>{fLimparAreaAlertaPrinc(),$("#GridAnaliseYiledCost").dataTable().fnClearTable(),$("#GridAnaliseYiledCost").dataTable({bDestroy:!0}).fnDestroy(),finalizarAnimacaoPesquisaAnaliseYiedlCost(),iniciarAnimacaoPesquisarAnaliseYiedlCost();var t=$("#txtFiltroAnaliseYiledCostAtivo").val(),l=$("#txtFiltroAnaliseYiledCostAno").val();$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:e+"Analise/gridYieldOnCost",data:{CodAtivo:t,Ano:l},success:function(a){var i=a.data.Resultado,t=a.data.Mensagem,l=a.data.Lista;return"NSESSAO"==i?($(location).attr("href",e+"/login"),!1):"NOK"==i?(finalizarAnimacaoPesquisaAnaliseYiedlCost(),fLimparSomenteGridAnaliseYiedlCost(e),void fCriarAlerta("AreaAlertaPrincAnaliseYiledCost",TP_ALERTA_AVISO,t)):"FALHA"==i?(finalizarAnimacaoPesquisaAnaliseYiedlCost(),fLimparSomenteGridAnaliseYiedlCost(e),void fCriarAlerta("AreaAlertaPrincAnaliseYiledCost",TP_ALERTA_ERRO,t)):"OK"!=i?(finalizarAnimacaoPesquisaAnaliseYiedlCost(),fLimparSomenteGridAnaliseYiedlCost(e),void fCriarAlerta("AreaAlertaPrincAnaliseYiledCost",TP_ALERTA_ERRO,t)):void fMontarGridAnaliseYiedlCost(e,l)},error:function(a){return finalizarAnimacaoPesquisaAnaliseYiedlCost(),fLimparSomenteGridAnaliseYiedlCost(e),fCriarAlerta("AreaAlertaPrincAnaliseYiledCost",TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}),a(!0)}).then(e=>{}).catch(e=>{})}catch(a){finalizarAnimacaoPesquisaAnaliseYiedlCost(),fLimparSomenteGridAnaliseYiedlCost(e),null!=a.description&&fCriarAlerta("AreaAlertaPrincAnaliseYiledCost",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}