function fCarregarListaGrupos(a,r){try{$("#btnAdicionarAtivo").hide(),$("#btnAlterarGrupo").hide(),$("#btnRemoverGrupo").hide(),$("#btnAdicionarGrupo").show(),$("#TabGrupos").empty(),""==r?$("#TabGrupos").append('<li class="nav-item"> <a class="nav-link active" id="TabPortfolio" data-toggle="tab" href="#Portfolio" aria-selected="true">Meu Portfólio <span id="TabQtdePortfolio">( 0 )</span> </a> </li>'):$("#TabGrupos").append('<li class="nav-item"> <a class="nav-link"        id="TabPortfolio" data-toggle="tab" href="#Portfolio"aria-selected="false">Meu Portfólio <span id="TabQtdePortfolio">( 0 )</span> </a> </li>'),$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"listas/lista_nomes_radar_user",success:function(t){var i=t.data.Resultado,o=t.data.Mensagem,e=t.data.Lista;return"NSESSAO"==i?($(location).attr("href",a+"/login"),!1):"NOK"==i?(fCriarAlertaPrinc(TP_ALERTA_AVISO,o),!1):"FALHA"==i?(fCriarAlertaPrinc(TP_ALERTA_ERRO,o),!1):"OK"==i?(e.length>0&&$.each(e,function(a,t){r==t[0]?$('<li class="nav-item"> <a class="nav-link active" id="Tab'+t[0]+'" data-toggle="tab" href="#'+t[0]+'" aria-selected="true" >'+t[1]+' <span id="TabQtde'+t[0]+'">( '+t[2]+" )</span></a> </li>").appendTo("#TabGrupos"):$('<li class="nav-item"> <a class="nav-link"        id="Tab'+t[0]+'" data-toggle="tab" href="#'+t[0]+'" aria-selected="false">'+t[1]+' <span id="TabQtde'+t[0]+'">( '+t[2]+" )</span></a> </li>").appendTo("#TabGrupos")}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(r){r.target,r.relatedTarget,fCarregarGrid(a)}),!0):(fCriarAlertaPrinc(TP_ALERTA_ERRO,o),!1)},error:function(a){return fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fLimparGrid(a){try{$("th").addClass("text-center"),$("#Grid").dataTable().fnClearTable(),$("#Grid").dataTable({bDestroy:!0}).fnDestroy(),$("#Grid").DataTable({data:[],oLanguage:fTraduzirGrid(),aoColumns:[{bSortable:!0,sWidth:"50px",targets:0},{bSortable:!0,sWidth:"50px",targets:1},{bSortable:!0,sWidth:"50px",targets:2},{bSortable:!0,sWidth:"50px",targets:3},{bSortable:!0,sWidth:"50px",targets:4},{bSortable:!0,sWidth:"50px",targets:5},{bSortable:!0,sWidth:"50px",targets:6},{visible:!1,targets:7},{visible:!1,targets:8},{bSortable:!1,sWidth:"10px",targets:9}],order:[],bFilter:!1,bInfo:!1,iDisplayLength:100,bLengthChange:!1,bSearchable:!1,bOrderable:!1,bSortable:!1,bAutoWidth:!1,bPaginate:!1,bOrdering:!1})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fMontarGrid(a,r,t){try{$("#Grid").DataTable({processing:!0,serverSide:!1,oLanguage:fTraduzirGrid(),data:r,aoColumns:[{bSortable:!0,sWidth:"50px",targets:0},{bSortable:!0,sWidth:"50px",targets:1},{bSortable:!0,sWidth:"50px",targets:2},{bSortable:!0,sWidth:"50px",targets:3},{bSortable:!0,sWidth:"50px",targets:4},{bSortable:!0,sWidth:"10px",targets:5,render:function(a,r,t){return"display"==r?"R$ "+t[5]:a}},{bSortable:!0,sWidth:"10px",targets:6,render:function(a,r,t){return"display"==r?t[6]+"%":a}},{visible:!1,targets:7},{visible:!1,targets:8},{bSortable:!1,sWidth:"10px",targets:9,render:function(r,i,o){var e="";if("display"==i){var l=o[3],n=o[5],d=o[7],A=o[8];e+='<div class="btn-group btn-group-sm" role="group" aria-label="Basic example">',e+='<a class="btn btn-sm btn-success btn-icon btn-icon-mini btn-round btn-simple" style="font-size:9px;" title="Comprar Ativo '+l+'" href="javascript:void(0);" onclick="fAbrirModalDetalheOper( \''+a+"', '', 'Novo', 'C', '"+l+"', '100', '"+n+"' );\"> ",e+='  <i class="fa fa-plus-square" aria-hidden="true"></i> ',e+="</a>",e+="  &nbsp;",""!=t?(e+='<a class="btn btn-sm btn-dark btn-icon btn-icon-mini btn-round btn-simple" style="font-size:9px;" title="Remover Ativo '+l+' do Radar Personalizado" href="javascript:void(0);" role="button" aria-pressed="true" onclick="fAbrirModalRemoverAtivo( \''+a+"', '"+d+"', '"+A+"', '"+l+"' );\"> ",e+='   <i class="fa fa-trash-o fa-lg" aria-hidden="true"></i> ',e+="</a>"):(e+='<a class="btn btn-sm btn-danger btn-icon btn-icon-mini btn-round btn-simple" style="font-size:9px;" title="Vender Ativo '+l+'" href="javascript:void(0);" role="button" aria-pressed="true" onclick="fAbrirModalDetalheOper( \''+a+"', '', 'Novo', 'V', '"+l+"', '100', '"+n+"' );\">",e+='  <i class="fa fa-minus-square" aria-hidden="true"></i> ',e+="</a>"),e+="</div>"}return e}}],createdRow:function(a,r,t){$("td",a).addClass("text-center");var i=parseFloat(GetValorDecimal(r[6]));i>0&&$("td",a).addClass("text-success"),i<0&&$("td",a).addClass("text-danger")},initComplete:function(a,i){""==t?$("#TabQtdePortfolio").html("( "+r.length+" )"):$("#TabQtde"+t).html("( "+r.length+" )")},order:[[3,"asc"]],iDisplayLength:100,bLengthChange:!1,bFilter:!1,bInfo:!1,bSearchable:!1,bPaginate:!1,bOrderable:!0,bSortable:!0,bOrdering:!0,searchable:!0,orderable:!0,bAutoWidth:!1}),$(document).ajaxError(function(r,t,i,o){fLimparGrid(a)})}catch(r){fLimparGrid(a),null!=r.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fCarregarGrid(a){try{fLimparAreaAlertaPrinc(),$("#Grid").dataTable().fnClearTable(),$("#Grid").dataTable({bDestroy:!0}).fnDestroy();var r="";$("#TabGrupos li a").each(function(){1==$(this).hasClass("active")&&(r=$(this).attr("id"))}),""==(r=(r=r.replace("TabPortfolio","")).replace("Tab",""))?($("#btnAdicionarAtivo").hide(),$("#btnAlterarGrupo").hide(),$("#btnRemoverGrupo").hide(),$("#btnAdicionarGrupo").show()):($("#btnAdicionarAtivo").show(),$("#btnAlterarGrupo").show(),$("#btnRemoverGrupo").show(),$("#btnAdicionarGrupo").hide()),$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"ativo/grid",data:{IdGrupo:r},success:function(t){var i=t.data.Resultado,o=t.data.Mensagem,e=t.data.Lista;return"NSESSAO"==i?($(location).attr("href",a+"/login"),!1):"NOK"==i?(fLimparGrid(a),void fCriarAlertaPrinc(TP_ALERTA_AVISO,o)):"FALHA"==i?(fLimparGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,o)):"OK"!=i?(fLimparGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,o)):void fMontarGrid(a,e,r)},error:function(r){return fLimparGrid(a),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}})}catch(r){fLimparGrid(a),null!=r.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fAbrirModalDetalheGrupo(a,r){try{if(fLimparAreaAlertaModalCad(),$("#txtCadGrupoId").val(""),$("#txtCadGrupoNome").val(""),$("#PopModalDetalheGrupoTit").html(" - "+r),"Alterar"==r||"Visualizar"==r){var t="";if($("#TabGrupos li a").each(function(){1==$(this).hasClass("active")&&(t=$(this).attr("id"))}),""==(t=t.replace("Tab","")))return void fCriarAlertaPrinc(TP_ALERTA_AVISO,"Id. Grupo não informado!");var i=$("#Tab"+t).html(),o=i.indexOf(" <span");i=i.substring(0,o).trim(),$("#txtCadGrupoId").val(t),$("#txtCadGrupoNome").val(i)}$("#PopModalDetalheGrupo").modal({backdrop:"static"}),$("#PopModalDetalheGrupo").on("shown.bs.modal",function(){$("#txtCadGrupoNome").focus()})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fValidarDadosGrupo(){try{return fLimparAreaAlertaModalCad(),""!=$("#txtCadGrupoNome").val()||(fCriarAlertaModalCad(TP_ALERTA_AVISO,"Por favor, preencha o campo Nome!"),!1)}catch(a){return fCriarAlertaModalCad(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}function fSalvarDadosGrupo(a){try{if(!fValidarDadosGrupo())return!1;iniciarAnimacaoSalvar();var r=$("#txtCadGrupoId").val(),t=$("#txtCadGrupoNome").val();$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"ativo/salvargrupo",data:{Id:r,Nome:t},success:function(i){finalizarAnimacaoSalvar();var o=i.data.Resultado,e=i.data.Mensagem;if("NSESSAO"==o)return $(location).attr("href",a+"/login"),!1;"NOK"!=o?"FALHA"!=o&&"OK"==o?($("#PopModalDetalheGrupo").modal("hide"),fCriarAlertaPrinc(TP_ALERTA_SUCESSO,"Dados salvo com sucesso!"),""==r?(fCarregarListaGrupos(a,r),fCarregarGrid(a)):$("#Tab"+r).html(t)):fCriarAlertaModalCad(TP_ALERTA_ERRO,e):fCriarAlertaModalCad(TP_ALERTA_AVISO,e)},error:function(a){finalizarAnimacaoSalvar(),fCriarAlertaModalCad(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}})}catch(a){return finalizarAnimacaoSalvar(),void CriarAlertaModal(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fAbrirModalRemoverGrupo(){try{$("#txtDelGrupoId").val("");var a="";if($("#TabGrupos li a").each(function(){1==$(this).hasClass("active")&&(a=$(this).attr("id"))}),""==(a=a.replace("Tab","")))return void fCriarAlertaPrinc(TP_ALERTA_AVISO,"Id. Grupo não informado!");$("#txtDelGrupoId").val(a),$("#PopModalDelGrupo").modal({backdrop:"static"})}catch(a){$("#PopModalDelGrupo").modal("hide"),finalizarAnimacaoExcluir(),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fExcluirDadosGrupo(a){try{finalizarAnimacaoExcluir();var r=$("#txtDelGrupoId").val();if(""==r)return void fCriarAlertaModalExc(TP_ALERTA_AVISO,"Id. Grupo não informado!");iniciarAnimacaoExcluir(),$.ajax({dataType:"json",type:"post",url:a+"ativo/excluirgrupo",data:{IdGrupo:r},success:function(r){finalizarAnimacaoExcluir();var t=r.data.Resultado,i=r.data.Mensagem;return"NSESSAO"==t?($(location).attr("href",a+"/login"),!1):"NOK"==t?(fCriarAlertaModalExc(TP_ALERTA_AVISO,i),!1):"FALHA"==t?void fCriarAlertaModalExc(TP_ALERTA_ERRO,i):"OK"==t?(fCriarAlertaPrinc(TP_ALERTA_SUCESSO,i),$("#txtDelGrupoId").val(""),$("#PopModalDelGrupo").modal("hide"),fCarregarListaGrupos(a,""),fCarregarGrid(a),!0):(fCriarAlertaModalExc(TP_ALERTA_ERRO,i),!1)},error:function(a){$("#PopModalDelGrupo").modal("hide"),finalizarAnimacaoExcluir(),fCriarAlertaModalExc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}})}catch(a){$("#PopModalDelGrupo").modal("hide"),finalizarAnimacaoExcluir(),fCriarAlertaModalExc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fAbrirModalDetalheAtivo(a){try{$("#AreaAlertaModalCadAtivo").html(""),$("#txtCadAtivoCodigo").val(""),fDefinirPadraoSelect("txtCadAtivoCodigo"),$("#PopModalDetalheAtivo").modal({backdrop:"static"}),$("#PopModalDetalheAtivo").on("shown.bs.modal",function(){$("#txtCadAtivoCodigo").focus()})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fCriarAlertaModalCadAtivo(a,r){var t=$("<div/>");t.addClass("alert "+a+" alert-dismissible fade show"),t.attr("id","DivAlerta"+fGerarNumeroAleatorio()),t.append('<button type="button" class="close" data-dismiss="alert" aria-label="Close"> <span aria-hidden="true">&times;</span> </button>'),a==TP_ALERTA_AVISO&&t.append("<small> <strong>Aviso:</strong> "+r+"</small> "),a==TP_ALERTA_SUCESSO&&t.append("<small> <strong>OK:</strong> "+r+"</small> "),a==TP_ALERTA_ERRO&&t.append("<small> <strong>Erro:</strong> "+r+"</small> "),a==TP_ALERTA_ALERTA&&t.append("<small> <strong>Alerta:</strong> "+r+"</small> "),t.delay(5e3).fadeOut("slow",function(){$(this).remove()}),$("#AreaAlertaModalCadAtivo").append(t)}function fValidarDadosAtivo(){try{return $("#AreaAlertaModalCadAtivo").html(""),""!=$("#txtCadAtivoCodigo").val()||(fCriarAlertaModalCadAtivo(TP_ALERTA_AVISO,"Por favor, preencha o campo Cód Ativo!"),!1)}catch(a){return fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}function fSalvarDadosAtivo(a){try{var r="";if($("#TabGrupos li a").each(function(){1==$(this).hasClass("active")&&(r=$(this).attr("id"))}),""==(r=r.replace("Tab","")))return void fCriarAlertaModalCadAtivo(TP_ALERTA_AVISO,"Id. Grupo não informado!");if(!fValidarDadosAtivo())return!1;iniciarAnimacaoSalvar();var t=$("#txtCadAtivoCodigo").val();$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"ativo/salvarativo",data:{IdGrupo:r,CodAtivo:t},success:function(r){finalizarAnimacaoSalvar();var t=r.data.Resultado,i=r.data.Mensagem;if("NSESSAO"==t)return $(location).attr("href",a+"/login"),!1;"NOK"!=t?"FALHA"!=t&&"OK"==t?($("#PopModalDetalheAtivo").modal("hide"),fCriarAlertaPrinc(TP_ALERTA_SUCESSO,"Dados salvo com sucesso!"),fCarregarGrid(a)):fCriarAlertaModalCadAtivo(TP_ALERTA_ERRO,i):fCriarAlertaModalCadAtivo(TP_ALERTA_AVISO,i)},error:function(a,r,t){finalizarAnimacaoSalvar(),fCriarAlertaModalCadAtivo(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}})}catch(a){return finalizarAnimacaoSalvar(),void fCriarAlertaModalCadAtivo(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fAbrirModalRemoverAtivo(a,r,t,i){try{if(fLimparAreaAlertaPrinc(),""==r)return void fCriarAlertaPrinc(TP_ALERTA_AVISO,"Id. Grupo não informado!");if(""==t)return void fCriarAlertaPrinc(TP_ALERTA_AVISO,"Id. Ativo não informado!");if(""==i)return void fCriarAlertaPrinc(TP_ALERTA_AVISO,"Cód Ativo não informado!");$.ajax({dataType:"json",type:"post",url:a+"ativo/excluirativo",data:{IdUserGrupo:r,IdUserAtivo:t,CodAtivo:i},success:function(r){var t=r.data.Resultado,i=r.data.Mensagem;return"NSESSAO"==t?($(location).attr("href",a+"/login"),!1):"NOK"==t?(fCriarAlertaPrinc(TP_ALERTA_AVISO,i),!1):"FALHA"==t?void fCriarAlertaPrinc(TP_ALERTA_ERRO,i):"OK"==t?(fCriarAlertaPrinc(TP_ALERTA_SUCESSO,i),fCarregarGrid(a),!0):(fCriarAlertaPrinc(TP_ALERTA_ERRO,i),!1)},error:function(a,r,t){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}})}catch(a){$("#PopModalDelGrupo").modal("hide"),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}$(document).ready(function(){$("#MnPrincAtivos").addClass("active open"),fLimparAreaAlertaPrinc(),fLimparAreaAlertaModalCad(),fLimparAreaAlertaModalExc(),$("#FormOper input[type=text]").bind("keyup change",function(){fCalcularPrecoTotal(),fCalcularOperacao()})});