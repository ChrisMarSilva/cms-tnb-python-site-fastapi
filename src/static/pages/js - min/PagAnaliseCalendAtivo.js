function iniciarAnimacaoPesquisarAnaliseCalProvAtivo(){$("#iRefreshCalendProvAtivo").addClass("fa-spin"),$("#btnAnaliseCalendProvAtivoPesquisar").addClass("disabled"),$("#txtFiltroAnaliseCalendProvAtivoAtivo").attr("disabled","disabled"),fDefinirPadraoSelect("txtFiltroAnaliseCalendProvAtivoAtivo")}function finalizarAnimacaoPesquisaAnaliseCalProvAtivo(){$("#iRefreshCalendProvAtivo").removeClass("fa-spin"),$("#btnAnaliseCalendProvAtivoPesquisar").removeClass("disabled"),$("#txtFiltroAnaliseCalendProvAtivoAtivo").removeAttr("disabled"),fDefinirPadraoSelect("txtFiltroAnaliseCalendProvAtivoAtivo")}function fLimparGridAnaliseCalendProvAtivo(t){$("#txtFiltroAnaliseCalendProvAtivoAtivo").val(""),fDefinirPadraoSelect("txtFiltroAnaliseCalendProvAtivoAtivo"),fLimparAreaAlerta("AreaAlertaPrincAnaliseCalProvAtivo"),fLimparSomenteGridAnaliseCalendProvAtivo(t)}async function fLimparSomenteGridAnaliseCalendProvAtivo(t){try{promise=new Promise((t,e)=>{finalizarAnimacaoPesquisaAnaliseCalProvAtivo(),$("th").addClass("text-center"),$("#GridAnaliseCalProvAtivo").dataTable().fnClearTable(),$("#GridAnaliseCalProvAtivo").dataTable({bDestroy:!0}).fnDestroy(),$("#GridAnaliseCalProvAtivo").DataTable({oLanguage:fTraduzirGrid(),aoColumns:[{bSortable:!0,sWidth:"50px",targets:0},{bSortable:!0,sWidth:"50px",targets:1},{bSortable:!0,sWidth:"50px",targets:2},{bSortable:!0,sWidth:"50px",targets:3},{bSortable:!0,sWidth:"50px",targets:4},{bSortable:!0,sWidth:"50px",targets:5},{bSortable:!0,sWidth:"50px",targets:6},{bSortable:!0,sWidth:"50px",targets:7},{bSortable:!0,sWidth:"50px",targets:8},{bSortable:!0,sWidth:"50px",targets:9},{bSortable:!0,sWidth:"50px",targets:10},{bSortable:!0,sWidth:"50px",targets:11},{bSortable:!0,sWidth:"50px",targets:12},{bSortable:!0,sWidth:"50px",targets:13},{bSortable:!0,sWidth:"50px",targets:14}],order:[],bFilter:!1,bInfo:!1,bLengthChange:!1,searchable:!1,orderable:!1,bAutoWidth:!1,bPaginate:!1,ordering:!1}),t(!0)}).then(t=>{}).catch(t=>{})}catch(t){fCriarAlerta("AreaAlertaPrincAnaliseCalProvAtivo",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGridAnaliseCalProvAtivo(t,e,a){try{promise=new Promise((i,r)=>{var o=[],l=[],s=[],n=[],d=[],A=[],c=[],v=[],f=[],b=[],h=[],p=[],u=[],C=[],P=[];$("#GridAnaliseCalProvAtivo").DataTable({processing:!0,serverSide:!1,iDisplayLength:10,oLanguage:fTraduzirGrid(),data:e,aoColumns:[{bSortable:!0,sWidth:"50px",targets:0},{bSortable:!0,sWidth:"50px",targets:1,render:function(e,i,r){return"display"==i&&"TOTAL"!=r[0]&&"MÉDIA"!=r[0]&&"RANKING"!=r[0]?"0,00"!=r[1]?'<a class="text-success font-weight-bold" style="text-decoration:none;" title="Clique Aqui para Detalhar os Proventos" href="javascript:void(0);" onclick="fAbrirModalDetalheAnaliseCalProv( \''+t+"', '"+a+"', '"+r[0]+"', '1' );\"> "+r[1]+" </i> </a>":r[1]:e}},{bSortable:!0,sWidth:"50px",targets:2,render:function(e,i,r){return"display"==i&&"TOTAL"!=r[0]&&"MÉDIA"!=r[0]&&"RANKING"!=r[0]?"0,00"!=r[2]?'<a class="text-success font-weight-bold" style="text-decoration:none;" title="Clique Aqui para Detalhar os Proventos" href="javascript:void(0);" onclick="fAbrirModalDetalheAnaliseCalProv( \''+t+"', '"+a+"', '"+r[0]+"', '2' );\"> "+r[2]+" </i> </a>":r[2]:e}},{bSortable:!0,sWidth:"50px",targets:3,render:function(e,i,r){return"display"==i&&"TOTAL"!=r[0]&&"MÉDIA"!=r[0]&&"RANKING"!=r[0]?"0,00"!=r[3]?'<a class="text-success font-weight-bold" style="text-decoration:none;" title="Clique Aqui para Detalhar os Proventos" href="javascript:void(0);" onclick="fAbrirModalDetalheAnaliseCalProv( \''+t+"', '"+a+"', '"+r[0]+"', '3' );\"> "+r[3]+" </i> </a>":r[3]:e}},{bSortable:!0,sWidth:"50px",targets:4,render:function(e,i,r){return"display"==i&&"TOTAL"!=r[0]&&"MÉDIA"!=r[0]&&"RANKING"!=r[0]?"0,00"!=r[4]?'<a class="text-success font-weight-bold" style="text-decoration:none;" title="Clique Aqui para Detalhar os Proventos" href="javascript:void(0);" onclick="fAbrirModalDetalheAnaliseCalProv( \''+t+"', '"+a+"', '"+r[0]+"', '4' );\"> "+r[4]+" </i> </a>":r[4]:e}},{bSortable:!0,sWidth:"50px",targets:5,render:function(e,i,r){return"display"==i&&"TOTAL"!=r[0]&&"MÉDIA"!=r[0]&&"RANKING"!=r[0]?"0,00"!=r[5]?'<a class="text-success font-weight-bold" style="text-decoration:none;" title="Clique Aqui para Detalhar os Proventos" href="javascript:void(0);" onclick="fAbrirModalDetalheAnaliseCalProv( \''+t+"', '"+a+"', '"+r[0]+"', '5' );\"> "+r[5]+" </i> </a>":r[5]:e}},{bSortable:!0,sWidth:"50px",targets:6,render:function(e,i,r){return"display"==i&&"TOTAL"!=r[0]&&"MÉDIA"!=r[0]&&"RANKING"!=r[0]?"0,00"!=r[6]?'<a class="text-success font-weight-bold" style="text-decoration:none;" title="Clique Aqui para Detalhar os Proventos" href="javascript:void(0);" onclick="fAbrirModalDetalheAnaliseCalProv( \''+t+"', '"+a+"', '"+r[0]+"', '6' );\"> "+r[6]+" </i> </a>":r[6]:e}},{bSortable:!0,sWidth:"50px",targets:7,render:function(e,i,r){return"display"==i&&"TOTAL"!=r[0]&&"MÉDIA"!=r[0]&&"RANKING"!=r[0]?"0,00"!=r[7]?'<a class="text-success font-weight-bold" style="text-decoration:none;" title="Clique Aqui para Detalhar os Proventos" href="javascript:void(0);" onclick="fAbrirModalDetalheAnaliseCalProv( \''+t+"', '"+a+"', '"+r[0]+"', '7' );\"> "+r[7]+" </i> </a>":r[7]:e}},{bSortable:!0,sWidth:"50px",targets:8,render:function(e,i,r){return"display"==i&&"TOTAL"!=r[0]&&"MÉDIA"!=r[0]&&"RANKING"!=r[0]?"0,00"!=r[8]?'<a class="text-success font-weight-bold" style="text-decoration:none;" title="Clique Aqui para Detalhar os Proventos" href="javascript:void(0);" onclick="fAbrirModalDetalheAnaliseCalProv( \''+t+"', '"+a+"', '"+r[0]+"', '8' );\"> "+r[8]+" </i> </a>":r[8]:e}},{bSortable:!0,sWidth:"50px",targets:9,render:function(e,i,r){return"display"==i&&"TOTAL"!=r[0]&&"MÉDIA"!=r[0]&&"RANKING"!=r[0]?"0,00"!=r[9]?'<a class="text-success font-weight-bold" style="text-decoration:none;" title="Clique Aqui para Detalhar os Proventos" href="javascript:void(0);" onclick="fAbrirModalDetalheAnaliseCalProv( \''+t+"', '"+a+"', '"+r[0]+"', '9' );\"> "+r[9]+" </i> </a>":r[9]:e}},{bSortable:!0,sWidth:"50px",targets:10,render:function(e,i,r){return"display"==i&&"TOTAL"!=r[0]&&"MÉDIA"!=r[0]&&"RANKING"!=r[0]?"0,00"!=r[10]?'<a class="text-success font-weight-bold" style="text-decoration:none;" title="Clique Aqui para Detalhar os Proventos" href="javascript:void(0);" onclick="fAbrirModalDetalheAnaliseCalProv( \''+t+"', '"+a+"', '"+r[0]+"', '10' );\"> "+r[10]+" </i> </a>":r[10]:e}},{bSortable:!0,sWidth:"50px",targets:11,render:function(e,i,r){return"display"==i&&"TOTAL"!=r[0]&&"MÉDIA"!=r[0]&&"RANKING"!=r[0]?"0,00"!=r[11]?'<a class="text-success font-weight-bold" style="text-decoration:none;" title="Clique Aqui para Detalhar os Proventos" href="javascript:void(0);" onclick="fAbrirModalDetalheAnaliseCalProv( \''+t+"', '"+a+"', '"+r[0]+"', '11' );\"> "+r[11]+" </i> </a>":r[11]:e}},{bSortable:!0,sWidth:"50px",targets:12,render:function(e,i,r){return"display"==i&&"TOTAL"!=r[0]&&"MÉDIA"!=r[0]&&"RANKING"!=r[0]?"0,00"!=r[12]?'<a class="text-success font-weight-bold" style="text-decoration:none;" title="Clique Aqui para Detalhar os Proventos" href="javascript:void(0);" onclick="fAbrirModalDetalheAnaliseCalProv( \''+t+"', '"+a+"', '"+r[0]+"', '12' );\"> "+r[12]+" </i> </a>":r[12]:e}},{bSortable:!0,sWidth:"50px",targets:13,render:function(e,i,r){return"display"==i&&"TOTAL"!=r[0]&&"MÉDIA"!=r[0]&&"RANKING"!=r[0]?"0,00"!=r[13]?'<a class="text-dark font-weight-bold" style="text-decoration:none;" title="Clique Aqui para Detalhar os Proventos" href="javascript:void(0);" onclick="fAbrirModalDetalheAnaliseCalProv( \''+t+"', '"+a+"', '"+r[0]+"', '13' );\"> "+r[13]+" </i> </a>":r[13]:e}},{bSortable:!0,sWidth:"50px",targets:14,render:function(t,e,a){return"display"==e?a[14]:t}}],createdRow:function(t,e,a){$("td",t).addClass("text-center");var i=e[0];"TOTAL"==i?($(t).addClass("bg-light text-dark font-weight-bold"),$(t).css("height","35")):"MÉDIA"==i?($(t).addClass("bg-light text-muted font-weight-bold"),$(t).css("height","35"),$(t).css("font-size","12px")):"RANKING"==i?($(t).addClass("bg-light text-muted font-weight-bold"),$(t).css("height","35"),$(t).css("font-size","10px")):(o[a]=i,l[a]=parseFloat(GetValorDecimal(e[1])),s[a]=parseFloat(GetValorDecimal(e[2])),n[a]=parseFloat(GetValorDecimal(e[3])),d[a]=parseFloat(GetValorDecimal(e[4])),A[a]=parseFloat(GetValorDecimal(e[5])),c[a]=parseFloat(GetValorDecimal(e[6])),v[a]=parseFloat(GetValorDecimal(e[7])),f[a]=parseFloat(GetValorDecimal(e[8])),b[a]=parseFloat(GetValorDecimal(e[9])),h[a]=parseFloat(GetValorDecimal(e[10])),p[a]=parseFloat(GetValorDecimal(e[11])),u[a]=parseFloat(GetValorDecimal(e[12])),C[a]=parseFloat(GetValorDecimal(e[13])),P[a]=parseFloat(GetValorDecimal(e[14])),$("td",t).eq(0).addClass("text-dark font-weight-bold"),$("td",t).eq(13).addClass("text-dark font-weight-bold"),$("td",t).eq(14).addClass("text-dark font-weight-bold"),"0,00"!=e[1]&&$("td",t).eq(1).addClass("text-success font-weight-bold"),"0,00"!=e[2]&&$("td",t).eq(2).addClass("text-success font-weight-bold"),"0,00"!=e[3]&&$("td",t).eq(3).addClass("text-success font-weight-bold"),"0,00"!=e[4]&&$("td",t).eq(4).addClass("text-success font-weight-bold"),"0,00"!=e[5]&&$("td",t).eq(5).addClass("text-success font-weight-bold"),"0,00"!=e[6]&&$("td",t).eq(6).addClass("text-success font-weight-bold"),"0,00"!=e[7]&&$("td",t).eq(7).addClass("text-success font-weight-bold"),"0,00"!=e[8]&&$("td",t).eq(8).addClass("text-success font-weight-bold"),"0,00"!=e[9]&&$("td",t).eq(9).addClass("text-success font-weight-bold"),"0,00"!=e[10]&&$("td",t).eq(10).addClass("text-success font-weight-bold"),"0,00"!=e[11]&&$("td",t).eq(11).addClass("text-success font-weight-bold"),"0,00"!=e[12]&&$("td",t).eq(12).addClass("text-success font-weight-bold"))},initComplete:function(t,e){fDrawChartGraficoAnaliseCalProvAtivo(o,l,s,n,d,A,c,v,f,b,h,p,u,C,P),finalizarAnimacaoPesquisaAnaliseCalProvAtivo()},order:[],dom:"frtBpi",buttons:[{extend:"excelHtml5",text:'<i class="fa fa-file-excel-o"></i> Excel',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Análise do Calendário de Proventos - Ativo "+a,titleAttr:"Excel",exportOptions:{columns:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]}},{extend:"csvHtml5",charset:"UTF-8",fieldSeparator:";",titleAttr:"CSV",text:'<i class="fa fa-file-o"></i> CSV',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Análise do Calendário de Proventos - Ativo "+a,bom:!0,exportOptions:{columns:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]}},{extend:"pdfHtml5",text:'<i class="fa fa-file-pdf-o"></i> PDF',className:"btn btn-default btn-sm",titleAttr:"PDF",title:NOME_PROJETO+" - Análise do Calendário de Proventos - Ativo "+a,pageSize:"A3",alignment:"center",exportOptions:{columns:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]},footer:!0,customize:function(t){t.defaultStyle.fontSize=12,t.styles.tableHeader.fontSize=14}},{extend:"print",text:'<i class="fa fa-print"></i> Imprimir',title:NOME_PROJETO+" - Análise do Calendário de Proventos - Ativo "+a,titleAttr:"Imprimir",className:"btn btn-default btn-sm",exportOptions:{columns:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]}}],bFilter:!1,bInfo:!1,bLengthChange:!1,searchable:!1,orderable:!1,bAutoWidth:!1,bPaginate:!1,ordering:!1}),i(!0)}).then(t=>{}).catch(t=>{})}catch(e){fLimparSomenteGridAnaliseCalendProvAtivo(t),finalizarAnimacaoPesquisaAnaliseCalProvAtivo(),null!=e.description&&fCriarAlerta("AreaAlertaPrincAnaliseCalProvAtivo",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fDrawChartGraficoAnaliseCalProvAtivo(t,e,a,r,o,l,s,n,d,A,c,v,f,b,h){promise=new Promise((p,u)=>{$("#DivGraficoAnaliseCalProvAtivo").show(),$("#DivGraficoAnaliseCalProvAtivo").css("display","block");var C=t.length,P=[];for(i=0;i<C;i++)P[i]={name:t[i],data:[e[i],a[i],r[i],o[i],l[i],s[i],n[i],d[i],A[i],c[i],v[i],f[i],b[i],h[i]]};Highcharts.chart("DivGraficoAnaliseCalProvAtivo",{chart:{type:"column"},title:{text:null},legend:{enabled:!0,align:"center",verticalAlign:"top",floating:!0,backgroundColor:Highcharts.defaultOptions.legend.backgroundColor||"white",borderColor:"#CCC",borderWidth:1,shadow:!1},xAxis:{categories:["JAN","FEV","MAR","ABR","MAI","JUN","JUL","AGO","SET","OUT","NOV","DEZ","TOTAL","MÉDIA"],crosshair:!0},yAxis:{min:0,title:{text:"Rainfall (mm)"}},tooltip:{pointFormatter:function(){var t=Number(this.y).toFixed(2).replace(/./g,function(t,e,a){return e>0&&"."!==t&&(a.length-e)%3==0?"X"+t:t}).replace(".",",").replace(/X/g,".");return'<span style="color:'+this.series.color+'">'+this.series.name+"</span>: <b>R$ "+t+"</b><br />"},shared:!0},plotOptions:{column:{pointPadding:.2,borderWidth:0}},series:P}),p(!0)}).then(t=>{}).catch(t=>{})}async function fCarregarGridAnaliseCalendProvAtivo(t){try{promise=new Promise((e,a)=>{$("#DivGraficoAnaliseCalProvAtivo").hide(),$("#DivGraficoAnaliseCalProvAtivo").css("display","none"),fLimparAreaAlerta("AreaAlertaPrincAnaliseCalProvAtivo"),$("#GridAnaliseCalProvAtivo").dataTable().fnClearTable(),$("#GridAnaliseCalProvAtivo").dataTable({bDestroy:!0}).fnDestroy(),finalizarAnimacaoPesquisaAnaliseCalProvAtivo(),iniciarAnimacaoPesquisarAnaliseCalProvAtivo();var i=$("#txtFiltroAnaliseCalendProvAtivoAtivo").val();$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:t+"Analise/gridCalProvAtivo",data:{CodAtivo:i},success:function(e){var a=e.data.Resultado,r=e.data.Mensagem,o=e.data.Lista;return"NSESSAO"==a?($(location).attr("href",t+"/login"),!1):"NOK"==a?(fLimparSomenteGridAnaliseCalendProvAtivo(t),void fCriarAlerta("AreaAlertaPrincAnaliseCalProvAtivo",TP_ALERTA_AVISO,r)):"FALHA"==a?(fLimparSomenteGridAnaliseCalendProvAtivo(t),void fCriarAlerta("AreaAlertaPrincAnaliseCalProvAtivo",TP_ALERTA_AVISO,r)):"OK"!=a?(fLimparSomenteGridAnaliseCalendProvAtivo(t),void fCriarAlerta("AreaAlertaPrincAnaliseCalProvAtivo",TP_ALERTA_AVISO,r)):void fMontarGridAnaliseCalProvAtivo(t,o,i)},error:function(e){return fLimparSomenteGridAnaliseCalendProvAtivo(t),fCriarAlerta("AreaAlertaPrincAnaliseCalProvAtivo",TP_ALERTA_AVISO,MSG_ALERTA_ERRO),!1}}),e(!0)}).then(t=>{}).catch(t=>{})}catch(e){fLimparSomenteGridAnaliseCalendProvAtivo(t),null!=e.description&&fCriarAlerta("AreaAlertaPrincAnaliseCalProvAtivo",TP_ALERTA_AVISO,MSG_ALERTA_ERRO)}}