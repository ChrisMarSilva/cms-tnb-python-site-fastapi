var arNomeMeses=["","JAN","FEV","MAR","ABR","MAI","JUN","JUL","AGO","SET","OUT","NOV","DEZ"],WidthCampo01=1,WidthCampo02=1,WidthCampo03=1,WidthCampo04=30,WidthCampo05=40,WidthCampo06=40,WidthCampo07=1,WidthCampo08=40,WidthCampo09=30,WidthCampo10=1,WidthCampo11=30,WidthCampo12=1,WidthCampo13=30,WidthCampo14=1,WidthCampo15=1,WidthCampo16=1;async function fLimparDadosModalProjecao(){promise=new Promise((a,r)=>{fLimparAreaAlerta("AreaAlertaPrincAnaliseEvoluProjetada"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetada"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetadaExc"),$("#txtAnaliseEvoluProjetDescricao").val("Projeção Criada em "+(new Date).toLocaleDateString("pt-BR")),$("#txtAnaliseEvoluProjetAnoInicial").val((new Date).getFullYear()),$("#txtAnaliseEvoluProjetMesInicial").val((new Date).getMonth()+1),$("#txtAnaliseEvoluProjetTotInicial").val("10.000,0"),$("#txtAnaliseEvoluProjetInvestMensal").val("1.000,00"),$("#txtAnaliseEvoluProjetRendMensal").val("1,00"),$("#txtAnaliseEvoluProjetQtdeMeses").val("120"),fDefinirPadraoSelect("txtAnaliseEvoluProjetMesInicial"),a(!0)}).then(a=>{}).catch(a=>{})}function fAbrirDadosModalProjecao(a){fLimparDadosModalProjecao(),$("#PopModalDetalheEvolucaoProjecao").modal({backdrop:"static"}),$(document).on("shown.bs.modal",function(a){$("#txtAnaliseEvoluProjetDescricao").focus()})}function fValidarDadosProjecao(){try{fLimparAreaAlerta("AreaAlertaPrincAnaliseEvoluProjetada"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetada"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetadaExc");var a=$("#txtAnaliseEvoluProjetDescricao").val(),r=parseInt(GetValorInteiro($("#txtAnaliseEvoluProjetAnoInicial").val())),o=parseInt(GetValorInteiro($("#txtAnaliseEvoluProjetMesInicial").val())),e=parseFloat(GetValorDecimal($("#txtAnaliseEvoluProjetTotInicial").val())),t=parseFloat(GetValorDecimal($("#txtAnaliseEvoluProjetInvestMensal").val())),l=(parseFloat(GetValorDecimal($("#txtAnaliseEvoluProjetRendMensal").val())),parseInt(GetValorInteiro($("#txtAnaliseEvoluProjetQtdeMeses").val()))),i="";return""==a&&(i+=" - Ano Descrição<br/>"),r<=0&&(i+=" - Ano Início<br/>"),o<=0&&(i+=" - Mês Início<br/>"),e<=0&&t<=0&&(i+=" - Valor Inicial ou Mensal<br/>"),l<=0&&(i+=" - Qtd. Meses<br/>"),""==i||(fCriarAlerta("AreaAlertaModalAnaliseEvoluProjetada",TP_ALERTA_AVISO,"Os seguintes campos não estão preenchido: <br/>"+i),!1)}catch(a){return fCriarAlerta("AreaAlertaModalAnaliseEvoluProjetada",TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}function iniciarAnimacaoCriarAnaliseProjecao(){$("#iSalvarProjecao").removeClass("fa-check-square-o"),$("#iSalvarProjecao").addClass("fa-spinner"),$("#iSalvarProjecao").addClass("fa-pulse"),$("#BtnModalDetalheProjecaoSalvar").addClass("disabled")}function finalizarAnimacaoCriarAnaliseProjecao(){$("#iSalvarProjecao").addClass("fa-check-square-o"),$("#iSalvarProjecao").removeClass("fa-spinner"),$("#iSalvarProjecao").removeClass("fa-pulse"),$("#BtnModalDetalheProjecaoSalvar").removeClass("disabled")}async function fSalvarDadosProjecao(a){try{promise=new Promise((r,o)=>{if(!fValidarDadosProjecao())return!1;finalizarAnimacaoCriarAnaliseProjecao(),iniciarAnimacaoCriarAnaliseProjecao();var e=$("#txtAnaliseEvoluProjetDescricao").val(),t=parseInt(GetValorInteiro($("#txtAnaliseEvoluProjetAnoInicial").val())),l=parseInt(GetValorInteiro($("#txtAnaliseEvoluProjetMesInicial").val())),i=parseFloat(GetValorDecimal($("#txtAnaliseEvoluProjetTotInicial").val())),n=parseFloat(GetValorDecimal($("#txtAnaliseEvoluProjetInvestMensal").val())),d=parseFloat(GetValorDecimal($("#txtAnaliseEvoluProjetRendMensal").val())),s=parseInt(GetValorInteiro($("#txtAnaliseEvoluProjetQtdeMeses").val()));$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"Analise/salvarProjecao",data:{Descricao:e,AnoInicio:t,MesInicio:l,QtdMeses:s,VlrInvestInicio:i,VlrInvestMensal:n,TxRendMensal:d},success:function(r){finalizarAnimacaoCriarAnaliseProjecao();var o=r.data.Resultado,e=r.data.Mensagem,t=r.data.Dados;if("NSESSAO"==o)return $(location).attr("href",a+"/login"),!1;"NOK"!=o?"FALHA"!=o&&"OK"==o?($("#PopModalDetalheEvolucaoProjecao").modal("hide"),buscar_todos_nomes_projecoes(a,"txtFiltroProjecaoDescricao",!1,!1,!0),BuscarDadosProjecao(a,t.Id)):fCriarAlerta("AreaAlertaModalAnaliseEvoluProjetada",TP_ALERTA_ERRO,e):fCriarAlerta("AreaAlertaModalAnaliseEvoluProjetada",TP_ALERTA_AVISO,e)},error:function(a,r,o){finalizarAnimacaoCriarAnaliseProjecao(),fCriarAlerta("AreaAlertaModalAnaliseEvoluProjetada",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}),r(!0)}).then(a=>{}).catch(a=>{$("#PopModalGraficoEvolucaoProjecao").modal("hide"),fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,"Erro ao Montar Tabela da Projeção - "+a+" - "+MSG_ALERTA_ERRO)})}catch(a){return finalizarAnimacaoCriarAnaliseProjecao(),void fCriarAlerta("AreaAlertaModalAnaliseEvoluProjetada",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function BuscarDadosProjecao(a,r=""){try{promise=new Promise((o,e)=>{$("#DivEvolucaoProjetada").html(""),fLimparAreaAlerta("AreaAlertaPrincAnaliseEvoluProjetada"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetada"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetadaExc"),$("#BtnProjecaoSalvar").addClass("disabled"),$("#BtnProjecaoExcluir").addClass("disabled"),$("#BtnProjecaoSalvar").hide(),$("#BtnProjecaoExcluir").hide(),""==r&&(r=$("#txtFiltroProjecaoDescricao").val()),""!=r&&($("#txtFiltroProjecaoDescricao").val(r),fDefinirPadraoSelect("txtFiltroProjecaoDescricao"),$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"Analise/carregarProjecao",data:{IdProjecao:r},success:function(o){var e=o.data.Resultado,t=o.data.Mensagem,l=o.data.Lista;if("NSESSAO"==e)return $(location).attr("href",a+"/login"),!1;"NOK"!=e?"FALHA"!=e&&"OK"==e?(MontarTabelaProjetada(a,l),$("#txtFiltroProjecaoDescricao").val(r),fDefinirPadraoSelect("txtFiltroProjecaoDescricao"),$("#BtnProjecaoSalvar").removeClass("disabled"),$("#BtnProjecaoExcluir").removeClass("disabled"),$("#BtnProjecaoSalvar").show(),$("#BtnProjecaoExcluir").show()):fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,t):fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_AVISO,t)},error:function(a,r,o){finalizarAnimacaoCriarAnaliseProjecao(),fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}),o(!0))}).then(a=>{}).catch(a=>{$("#PopModalGraficoEvolucaoProjecao").modal("hide"),fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,"Erro ao Montar Tabela da Projeção - "+a+" - "+MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function GetTableButton(a,r){var o="";return o+="<br/>",o+="\x3c!-- Div Row clearfix --\x3e",o+='<div class="row clearfix">',o+='  <div class="col-xl-2 col-lg-1 col-md-6 col-sm-12 form-control-label text-right" style="border: 0px solid blue;">',o+='    <label for="TxtGridEvoluProjVlrInvestIni" style="font-size:14px;" class="font-weight-bold">Vlr. Inicial:</label>',o+="  </div>",o+='  <div class="col-xl-2 col-lg-2 col-md-6 col-sm-12" style="border: 0px solid red;">',o+='      <input required type="text" id="TxtGridEvoluProjVlrInvestIni" value="'+(0!=r?fMascaraValor(r):"")+'" class="form-control text-right" style="font-size:16px; height:30px;" onkeyup="javascript:validaKey(this, FMT_DECIMAL,2); ReCalcularTabelaProjetada();"  XXXonkeypress="ReCalcularTabelaProjetada();" XXXonchange="ReCalcularTabelaProjetada();" onfocus="javascript:desformataCampo(this, FMT_DECIMAL,2)" onblur="javascript:formataCampo(this, FMT_DECIMAL,2)">',o+="  </div>",o+="</div>",o+="\x3c!-- Div Row clearfix --\x3e",o+="<br/>"}function GetTableHead(a){var r="";return r+="\x3c!-- Div table-responsive --\x3e",r+='<div class="table-responsive" id="AreaGrid">',r+='  <table border="0" id="GridAnaliseEvoluProj" style="font-size: 12px; " class="table table-sm table-hover table-condensed nowrap" cellspacing="0" width="100%">',r+='      <col width="'+WidthCampo01+'">',r+='      <col width="'+WidthCampo02+'">',r+='      <col width="'+WidthCampo03+'">',r+='      <col width="'+WidthCampo04+'">',r+='      <col width="'+WidthCampo05+'">',r+='      <col width="'+WidthCampo06+'">',r+='      <col width="'+WidthCampo07+'">',r+='      <col width="'+WidthCampo08+'">',r+='      <col width="'+WidthCampo09+'">',r+='      <col width="'+WidthCampo10+'">',r+='      <col width="'+WidthCampo11+'">',r+='      <col width="'+WidthCampo12+'">',r+='      <col width="'+WidthCampo13+'">',r+='      <col width="'+WidthCampo14+'">',r+='      <col width="'+WidthCampo15+'">',r+='      <col width="'+WidthCampo16+'">',r+="    <thead>",r+='      <tr class="thead-dark font-weight-bold">',r+='        <th width="'+WidthCampo01+'" style="width: '+WidthCampo01+'px; display: none;"> Nro </td>',r+='        <th width="'+WidthCampo02+'" style="width: '+WidthCampo02+'px;"> Ano </td>',r+='        <th width="'+WidthCampo03+'" style="width: '+WidthCampo03+'px;"> Mês </th>',r+='        <th width="'+WidthCampo04+'" style="width: '+WidthCampo04+'px;"> Vlr. Mensal </th>',r+='        <th width="'+WidthCampo05+'" style="width: '+WidthCampo05+'px;"> Tot. Invest. Ano </th>',r+='        <th width="'+WidthCampo06+'" style="width: '+WidthCampo06+'px;"> Tot. Invest. </th>',r+='        <th width="'+WidthCampo07+'" style="width: '+WidthCampo07+'px; display: none;"> Mês Ini </th>',r+='        <th width="'+WidthCampo08+'" style="width: '+WidthCampo08+'px;"> Tot. Atual </th>',r+='        <th width="'+WidthCampo09+'" style="width: '+WidthCampo09+'px;"> Lucro Mensal </th>',r+='        <th width="'+WidthCampo10+'" style="width: '+WidthCampo10+'px;"> % </th>',r+='        <th width="'+WidthCampo11+'" style="width: '+WidthCampo11+'px;"> Lucro Anual </th>',r+='        <th width="'+WidthCampo12+'" style="width: '+WidthCampo12+'px;"> % </th>',r+='        <th width="'+WidthCampo13+'" style="width: '+WidthCampo13+'px;"> Lucro Geral </th>',r+='        <th width="'+WidthCampo14+'" style="width: '+WidthCampo14+'px;"> % </th>',r+='        <th width="'+WidthCampo15+'" style="width: '+WidthCampo15+'px; display: none;"> Tipo </th>',r+='        <th width="'+WidthCampo16+'" style="width: '+WidthCampo16+'px;"> Ação </th>',r+="      </tr>",r+="    </thead>",r+="    <tbody>"}function GetTableFoot(a,r){return"    </tbody>","  </table>","</div>","\x3c!-- Div table-responsive --\x3e","    </tbody>  </table></div>\x3c!-- Div table-responsive --\x3e"}function GetTableLinha(a,r,o,e,t,l,i,n,d){var s="";s+='<a class="btn btn-sm btn-warning btn-icon btn-icon-mini btn-round btn-simple" style="height: 1.6rem; min-width: 1.6rem; width: 1.6rem; margin: 1px 1px; font-size:0.3rem; " title="Ajustar Valor Atual do Mês '+arNomeMeses[t]+"/"+o+'" href="javascript:void(0);" role="button" aria-pressed="true" onclick="AbrirModalValorAtualProjecao(\''+a+"', '"+r+"');\">",s+='  <i class="fa fa-pencil fa-lg" aria-hidden="true"></i>',s+="</a>";var c=1==t?"disabled":"";s+='<a class="btn btn-sm btn-primary btn-icon btn-icon-mini btn-round btn-simple '+c+'" '+c+' style="height: 1.6rem; min-width: 1.6rem; width: 1.6rem; margin: 1px 1px; font-size:0.3rem; " title="Gráfico Anual até o Mês '+arNomeMeses[t]+'" href="javascript:void(0);" role="button" aria-pressed="true" onclick="fAbrirModalGraficoProjecao(\''+a+"', 'A', '"+t+"', '"+o+"');\">",s+='  <i class="fa fa-area-chart fa-lg" aria-hidden="true"></i>',s+="</a>";var A=1==r?"disabled":"";s+='<a class="btn btn-sm btn-primary btn-icon btn-icon-mini btn-round btn-simple '+A+'" '+A+' style="height: 1.6rem; min-width: 1.6rem; width: 1.6rem; margin: 1px 1px; font-size:0.3rem; " title="Gráfico Geral até o Mês '+arNomeMeses[t]+"/"+o+'" href="javascript:void(0);" role="button" aria-pressed="true" onclick="fAbrirModalGraficoProjecao(\''+a+"', 'G', '"+t+"', '"+o+"');\">",s+='  <i class="fa fa-area-chart fa-lg" aria-hidden="true"></i>',s+="</a>";var u="";return u+="      <tr>",u+='        <td width="'+WidthCampo01+'" style="width: '+WidthCampo01+'px; display: none;" class="font-weight-bold">'+colcarFormacataoInteiro(r)+"</td>",u+='        <td width="'+WidthCampo02+'" style="width: '+WidthCampo02+'px;"> '+e+" </td>",u+='        <td width="'+WidthCampo03+'" style="width: '+WidthCampo03+'px;"> '+arNomeMeses[t]+" </td>",u+='        <td width="'+WidthCampo04+'" style="width: '+WidthCampo04+'px;"> <input required class="form-control text-right" style="margin: 0 auto; font-size:12px; width:95px; height:25px; " type="text" id="TxtGridEvoluProjVlrInvestMes'+r+'" value="'+(0!=l?fMascaraValor(l):"")+'" onkeyup="ReCalcularTabelaProjetada();" XXXonkeypress="ReCalcularTabelaProjetada();" XXXonchange="ReCalcularTabelaProjetada();" > </td>',u+='        <td width="'+WidthCampo05+'" style="width: '+WidthCampo05+'px;"> <span id="TxtGridEvoluProjVlrInvestAno'+r+'">R$ 0,00</span> </td>',u+='        <td width="'+WidthCampo06+'" style="width: '+WidthCampo06+'px;"> <span id="TxtGridEvoluProjVlrInvestGeral'+r+'">R$ 0,00</span> </td>',u+='        <td width="'+WidthCampo07+'" style="width: '+WidthCampo07+'px; display: none;"> <span id="TxtGridEvoluProjVlrMesInicio'+r+'">R$ 0,00</span> </td>',u+='        <td width="'+WidthCampo08+'" style="width: '+WidthCampo08+'px;"> <span id="TxtGridEvoluProjVlrMesFinal'+r+'">R$ '+fMascaraValor(i)+"</span> </td>",u+='        <td width="'+WidthCampo09+'" style="width: '+WidthCampo09+'px;"> <span id="TxtGridEvoluProjVlrLucroMes'+r+'">R$ 0,00</span> </td>',u+='        <td width="'+WidthCampo10+'" style="width: '+WidthCampo10+'px; font-size: 11px;"> <span id="TxtGridEvoluProjPercLucroMes'+r+'">'+fMascaraValor(n)+"%</span> </td>",u+='        <td width="'+WidthCampo11+'" style="width: '+WidthCampo11+'px;"> <span id="TxtGridEvoluProjVlrLucroAno'+r+'">R$ 0,00</span> </td>',u+='        <td width="'+WidthCampo12+'" style="width: '+WidthCampo12+'px; font-size: 11px;"> <span id="TxtGridEvoluProjPercLucroAno'+r+'">0,00%</span> </td>',u+='        <td width="'+WidthCampo13+'" style="width: '+WidthCampo13+'px;"> <span id="TxtGridEvoluProjVlrLucroGeral'+r+'">R$ 0,00</span> </td>',u+='        <td width="'+WidthCampo14+'" style="width: '+WidthCampo14+'px; font-size: 11px;"> <span id="TxtGridEvoluProjPercLucroGeral'+r+'">0,00%</span> </td>',u+='        <td width="'+WidthCampo15+'" style="width: '+WidthCampo15+'px; display: none;"> <span id="TxtGridEvoluProjTipo'+r+'">'+d+"</span> </td>",u+='        <td width="'+WidthCampo16+'" style="width: '+WidthCampo16+'px;">  <span id="TxtGridEvoluProjAcaoMes'+r+'">'+s+"</span> </td>",u+="      </tr>"}async function MontarTabelaProjetada(a,r){try{promise=new Promise((o,e)=>{$("#DivEvolucaoProjetada").html("");var t="";if(r.length>0){var l=0,i=0,n=0,d=0,s=0,c=0,A=parseFloat(GetValorDecimal(r[0].VlrInvestIni));t+=GetTableButton(a,A),$.each(r,function(r,o){l=GetValorInteiro(o.NroMes),i=GetValorInteiro(o.AnoAtual),n=GetValorInteiro(o.MesAtual),d=parseFloat(GetValorDecimal(o.VlrInvestMensal)),fVlrInvestFinal=parseFloat(GetValorDecimal(o.VlrInvestFim)),s=parseFloat(GetValorDecimal(o.TaxaMensal)),sTipo=o.Tipo,1==l&&(c=i),1!=n&&1!=l||(l>1&&(t+=GetTableFoot(a,c),c=i),t+=GetTableHead(a)),t+=GetTableLinha(a,l,c,i,n,d,fVlrInvestFinal,s,sTipo)}),t+=GetTableFoot(a,c=i)}$("#DivEvolucaoProjetada").html(t),ReCalcularTabelaProjetada(),o(!0)}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,"Erro ao Montar Tabela da Projeção - "+a+" - "+MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,"Falha geral ao Montar Tabela da Projeção - "+MSG_ALERTA_ERRO)}}async function ReCalcularTabelaProjetada(){try{promise=new Promise((a,r)=>{var o=0,e=0,t=parseFloat(GetValorDecimal($("#TxtGridEvoluProjVlrInvestIni").val())),l=0,i=0,n=0,d=0,s=0,c=0,A=0,u=0,P=0,h=0;$("#GridAnaliseEvoluProj > tbody > tr").each(function(){try{var a=GetValorInteiro($(this).find("td").eq(0).html().trim());o=GetValorInteiro($(this).find("td").eq(1).html().trim());var r=parseFloat(GetValorDecimal($("#TxtGridEvoluProjVlrInvestMes"+a).val().trim())),m=$("#TxtGridEvoluProjTipo"+a).html().trim();1==a&&(e=o,l=t,i=t,n=t,d=t),o!=e&&(l=0,A=0,e=o),l+=r,i+=r,n+=r,$("#TxtGridEvoluProjVlrMesFinal"+a).removeAttr("title"),"C"==m&&(d+=r,c=parseFloat(GetValorDecimal($("#TxtGridEvoluProjPercLucroMes"+a).html().trim().replace("%",""))),s=fTrucarValorFixed(d*c/100),d+=s,$("#TxtGridEvoluProjVlrMesFinal"+a).removeClass("font-weight-bold"),$("#TxtGridEvoluProjVlrMesFinal"+a).attr("title","Valor Atual Calculado")),"M"==m&&(d=parseFloat(GetValorDecimal($("#TxtGridEvoluProjVlrMesFinal"+a).html().trim().replace("R$",""))),c=0,0!=(s=d-n)&&0!=n&&(c=s/n*100),$("#TxtGridEvoluProjVlrMesFinal"+a).addClass("font-weight-bold"),$("#TxtGridEvoluProjVlrMesFinal"+a).attr("title","Valor Atual Modificado")),u=0,0!=(A+=s)&&0!=l&&(u=A/l*100),h=0,0!=(P+=s)&&0!=i&&(h=P/i*100),$("#TxtGridEvoluProjVlrInvestAno"+a).html("R$ "+fMascaraValor(l)),$("#TxtGridEvoluProjVlrInvestGeral"+a).html("R$ "+fMascaraValor(i)),$("#TxtGridEvoluProjVlrMesInicio"+a).html("R$ "+fMascaraValor(n)),$("#TxtGridEvoluProjVlrMesFinal"+a).html("R$ "+fMascaraValor(d)),$("#TxtGridEvoluProjVlrLucroMes"+a).html("R$ "+fMascaraValor(s)),$("#TxtGridEvoluProjPercLucroMes"+a).html(fMascaraValor(c)+"%"),$("#TxtGridEvoluProjVlrLucroAno"+a).html("R$ "+fMascaraValor(A)),$("#TxtGridEvoluProjPercLucroAno"+a).html(fMascaraValor(u)+"%"),$("#TxtGridEvoluProjVlrLucroGeral"+a).html("R$ "+fMascaraValor(P)),$("#TxtGridEvoluProjPercLucroGeral"+a).html(fMascaraValor(h)+"%"),$("#TxtGridEvoluProjVlrLucroMes"+a).removeClass("text-success"),$("#TxtGridEvoluProjVlrLucroMes"+a).removeClass("text-danger"),0!=fTrucarValor(s)&&fTrucarValor(s)>0&&$("#TxtGridEvoluProjVlrLucroMes"+a).addClass("text-success"),0!=fTrucarValor(s)&&fTrucarValor(s)<0&&$("#TxtGridEvoluProjVlrLucroMes"+a).addClass("text-danger"),$("#TxtGridEvoluProjVlrLucroAno"+a).removeClass("text-success"),$("#TxtGridEvoluProjVlrLucroAno"+a).removeClass("text-danger"),0!=fTrucarValor(A)&&fTrucarValor(A)>0&&$("#TxtGridEvoluProjVlrLucroAno"+a).addClass("text-success"),0!=fTrucarValor(A)&&fTrucarValor(A)<0&&$("#TxtGridEvoluProjVlrLucroAno"+a).addClass("text-danger"),$("#TxtGridEvoluProjVlrLucroGeral"+a).removeClass("text-success"),$("#TxtGridEvoluProjVlrLucroGeral"+a).removeClass("text-danger"),0!=fTrucarValor(P)&&fTrucarValor(P)>0&&$("#TxtGridEvoluProjVlrLucroGeral"+a).addClass("text-success"),0!=fTrucarValor(P)&&fTrucarValor(P)<0&&$("#TxtGridEvoluProjVlrLucroGeral"+a).addClass("text-danger"),n=d}catch(a){}}),a(!0)}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,"Erro ao ReCalcular Tabela da Projeção - "+MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,"Faha Geral ao ReCalcular Tabela da Projeção - "+MSG_ALERTA_ERRO)}}function AbrirModalExcluirProjecao(a){try{if(""==$("#txtFiltroProjecaoDescricao").val())return void fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_AVISO,"Id. Projeção não informado!");$("#PopModalExcluirEvolucaoProjecao").modal({backdrop:"static"})}catch(a){$("#PopModalExcluirEvolucaoProjecao").modal("hide"),finalizarAnimacaoExcluir(),fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function iniciarAnimacaoExcluirAnaliseProjecao(){$("#iSalvarProjecao").addClass("fa-spin"),$("#BtnModalDetalheProjecaoSalvar").addClass("disabled")}function finalizarAnimacaoExcluirAnaliseProjecao(){$("#iSalvarProjecao").removeClass("fa-spin"),$("#BtnModalDetalheProjecaoSalvar").removeClass("disabled")}async function fExcluirDadosProjecao(a){try{promise=new Promise((r,o)=>{fLimparAreaAlerta("AreaAlertaPrincAnaliseEvoluProjetada"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetada"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetadaExc");var e=$("#txtFiltroProjecaoDescricao").val();""!=e?(finalizarAnimacaoExcluirAnaliseProjecao(),iniciarAnimacaoExcluirAnaliseProjecao(),$.ajax({dataType:"json",type:"post",url:a+"Analise/excluirProjecao",data:{IdProjecao:e},success:function(r){finalizarAnimacaoExcluirAnaliseProjecao();var o=r.data.Resultado,e=r.data.Mensagem;return"NSESSAO"==o?($(location).attr("href",a+"/login"),!1):"NOK"==o?(fCriarAlerta("AreaAlertaModalAnaliseEvoluProjetadaExc",TP_ALERTA_AVISO,e),!1):"FALHA"==o?void fCriarAlerta("AreaAlertaModalAnaliseEvoluProjetadaExc",TP_ALERTA_ERRO,e):"OK"==o?(fCriarAlertaPrinc(TP_ALERTA_SUCESSO,e),$("#PopModalExcluirEvolucaoProjecao").modal("hide"),$("#DivEvolucaoProjetada").html(""),buscar_todos_nomes_projecoes(a,"txtFiltroProjecaoDescricao",!1,!1,!0),$("#BtnProjecaoSalvar").addClass("disabled"),$("#BtnProjecaoExcluir").addClass("disabled"),$("#BtnProjecaoSalvar").hide(),$("#BtnProjecaoExcluir").hide(),!0):(ffCriarAlerta("AreaAlertaModalAnaliseEvoluProjetadaExc",TP_ALERTA_ERRO,e),!1)},error:function(a,r,o){$("#PopModalExcluirEvolucaoProjecao").modal("hide"),finalizarAnimacaoExcluirAnaliseProjecao(),fCriarAlerta("AreaAlertaModalAnaliseEvoluProjetadaExc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}),r(!0)):fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_AVISO,"Id. Projeção não informado!")}).then(a=>{}).catch(a=>{$("#PopModalGraficoEvolucaoProjecao").modal("hide"),fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,"Erro ao Montar Tabela da Projeção - "+a+" - "+MSG_ALERTA_ERRO)})}catch(a){$("#PopModalExcluirEvolucaoProjecao").modal("hide"),finalizarAnimacaoExcluirAnaliseProjecao(),fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,MSG_ALERTA_ERRO),fCriarAlerta("AreaAlertaModalAnaliseEvoluProjetadaExc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function iniciarAnimacaoAlterarAnaliseProjecao(){$("#iAlterarProjecao").removeClass("fa-check-square-o"),$("#iAlterarProjecao").addClass("fa-spinner"),$("#iAlterarProjecao").addClass("fa-pulse"),$("#BtnProjecaoSalvar").addClass("disabled")}function finalizarAnimacaoAlterarAnaliseProjecao(){$("#iAlterarProjecao").addClass("fa-check-square-o"),$("#iAlterarProjecao").removeClass("fa-spinner"),$("#iAlterarProjecao").removeClass("fa-pulse"),$("#BtnProjecaoSalvar").removeClass("disabled")}async function fAlterarDadosProjecao(a){try{promise=new Promise((r,o)=>{fLimparAreaAlerta("AreaAlertaPrincAnaliseEvoluProjetada"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetada"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetadaExc");var e=$("#txtFiltroProjecaoDescricao").val();if(""!=e){finalizarAnimacaoAlterarAnaliseProjecao(),iniciarAnimacaoAlterarAnaliseProjecao();var t=parseFloat(GetValorDecimal($("#TxtGridEvoluProjVlrInvestIni").val())),l=[];$("#GridAnaliseEvoluProj > tbody > tr").each(function(){try{var a=GetValorInteiro($(this).find("td").eq(0).html().trim()),r=GetValorInteiro($(this).find("td").eq(1).html().trim()),o=arNomeMeses.indexOf($(this).find("td").eq(2).html().trim()),e=parseFloat(GetValorDecimal($("#TxtGridEvoluProjVlrInvestMes"+a).val().trim())),i=parseFloat(GetValorDecimal($("#TxtGridEvoluProjVlrMesFinal"+a).html().trim().replace("R$",""))),n=parseFloat(GetValorDecimal($("#TxtGridEvoluProjPercLucroMes"+a).html().trim().replace("%",""))),d=$("#TxtGridEvoluProjTipo"+a).html().trim();l.push({NroMes:a,AnoAtual:r,MesAtual:o,VlrInvestIni:t,VlrInvestMensal:e,VlrInvestFim:i,TaxaMensal:n,Tipo:d})}catch(a){}}),l.length<=0?fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_AVISO,"Lista de Projeção não informada!"):($.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"Analise/alterarProjecao",data:{IdProjecao:e,DadosProjecao:l},success:function(r){finalizarAnimacaoAlterarAnaliseProjecao();var o=r.data.Resultado,e=r.data.Mensagem;if("NSESSAO"==o)return $(location).attr("href",a+"/login"),!1;"NOK"!=o?"FALHA"!=o&&"OK"==o?fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_SUCESSO,"Dados salvo com sucesso!"):fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,e):fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_AVISO,e)},error:function(a,r,o){finalizarAnimacaoAlterarAnaliseProjecao(),fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}),r(!0))}else fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_AVISO,"Id. Projeção não informado!")}).then(a=>{}).catch(a=>{$("#PopModalGraficoEvolucaoProjecao").modal("hide"),fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,"Erro ao Montar Tabela da Projeção - "+a+" - "+MSG_ALERTA_ERRO)})}catch(a){return finalizarAnimacaoAlterarAnaliseProjecao(),void fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fAbrirModalGraficoProjecao(a,r="",o=0,e=0){try{fLimparAreaAlerta("AreaAlertaPrincAnaliseEvoluProjetada"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetada"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetadaExc"),$("#DivGraficoEvolucaoProjecao").html('<i class="fa fa-spinner fa-spin fa-5x fa-pulse fa-fw" aria-hidden="true"></i>');var t="Projeção até "+arNomeMeses[o]+"/"+e;0==o&&(t="Projeção de "+e),$("#TitModalGraficoEvolucaoProjecao").html(t),$("#PopModalGraficoEvolucaoProjecao").modal({backdrop:"static"}),promise=new Promise((a,t)=>{var l=[],i=[],n=0;$("#GridAnaliseEvoluProj > tbody > tr").each(function(){try{var a=GetValorInteiro($(this).find("td").eq(0).html().trim()),t=GetValorInteiro($(this).find("td").eq(1).html().trim()),d=arNomeMeses.indexOf($(this).find("td").eq(2).html().trim());if("A"==r&&t<e)return!0;if("A"==r&&t>e)return!1;if("A"==r&&t==e&&d>o)return!1;if("G"==r&&t>e)return!1;if("G"==r&&t==e&&d>o)return!1;var s=new Date(t,d,0).toLocaleDateString("pt-BR"),c=parseFloat(GetValorDecimal($("#TxtGridEvoluProjVlrMesFinal"+a).html().trim().replace("R$",""))),A=parseFloat(GetValorDecimal($("#TxtGridEvoluProjVlrInvestGeral"+a).html().trim().replace("R$","")));l[++n-1]=[moment(colcarFormacataoDataXMLPadrao(s)).valueOf(),A],i[n-1]=[moment(colcarFormacataoDataXMLPadrao(s)).valueOf(),c]}catch(a){}}),$("#DivGraficoEvolucaoProjecao").html(""),Highcharts.setOptions({global:{useUTC:!1},lang:{decimalPoint:",",thousandsSep:"."}}),Highcharts.setOptions({lang:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],weekdays:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],loading:["Atualizando o gráfico...aguarde"],contextButtonTitle:"Exportar gráfico",decimalPoint:",",thousandsSep:".",downloadJPEG:"Baixar imagem JPEG",downloadPDF:"Baixar arquivo PDF",downloadPNG:"Baixar imagem PNG",downloadSVG:"Baixar vetor SVG",printChart:"Imprimir gráfico",rangeSelectorFrom:"De",rangeSelectorTo:"Para",rangeSelectorZoom:"Zoom",resetZoom:"Limpar Zoom",resetZoomTitle:"Voltar Zoom para nível 1:1"}}),Highcharts.stockChart("DivGraficoEvolucaoProjecao",{title:{text:null},chart:{zoomType:null},legend:{enabled:!1},global:{useUTC:!1},colors:["#7798BF","#55BF3B"],lang:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],weekdays:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],loading:["Atualizando o gráfico...aguarde"],contextButtonTitle:"Exportar gráfico",decimalPoint:",",thousandsSep:".",downloadJPEG:"Baixar imagem JPEG",downloadPDF:"Baixar arquivo PDF",downloadPNG:"Baixar imagem PNG",downloadSVG:"Baixar vetor SVG",printChart:"Imprimir gráfico",rangeSelectorFrom:"De",rangeSelectorTo:"Para",rangeSelectorZoom:"Zoom",resetZoom:"Limpar Zoom",resetZoomTitle:"Voltar Zoom para nível 1:1"},rangeSelector:{enabled:!1,selected:5,allButtonsEnabled:!1,inputEnabled:!1,buttonTheme:{visibility:"hidden"},labelStyle:{visibility:"hidden"}},plotOptions:{series:{showInNavigator:!1}},navigator:{enabled:!1},tooltip:{valueDecimals:2},xAxis:{type:"datetime",minTickInterval:864e5,dateTimeLabelFormats:{month:"%b '%y",year:"%Y"}},yAxis:{labels:{formatter:function(){return"R$ "+fMascaraValor(this.value)}},plotLines:[{value:0,width:2,color:"silver"}]},tooltip:{split:!0,valueDecimals:2,pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>R$ {point.y}</b><br/>'},series:[{name:"Valor Investido",data:l,dataGrouping:{groupPixelWidth:5},marker:{lineWidth:2,lineColor:Highcharts.getOptions().colors[1],fillColor:"white"}},{name:"Valor Atual",data:i,dataGrouping:{groupPixelWidth:5},marker:{lineWidth:2,lineColor:Highcharts.getOptions().colors[3],fillColor:"white"}}]}),a(!0)}).then(a=>{}).catch(a=>{$("#PopModalGraficoEvolucaoProjecao").modal("hide"),fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,"Erro ao Montar Tabela da Projeção - "+a+" - "+MSG_ALERTA_ERRO)})}catch(a){return $("#PopModalGraficoEvolucaoProjecao").modal("hide"),void fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function AbrirModalValorAtualProjecao(a,r){try{fLimparAreaAlerta("AreaAlertaPrincAnaliseEvoluProjetada"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetada"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetadaExc"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetadaAjusteVlrAtual"),$("#txtAnaliseEvoluProjetAjusteVlrAtualNroMes").val(""),$("#txtAnaliseEvoluProjetAjusteVlrAtualVlrMesFinal").val("");var o=parseFloat(GetValorDecimal($("#TxtGridEvoluProjVlrMesFinal"+r).html().trim().replace("R$","")));$("#txtAnaliseEvoluProjetAjusteVlrAtualNroMes").val(r),$("#txtAnaliseEvoluProjetAjusteVlrAtualVlrMesFinal").val(fMascaraValor(o)),$("#PopModalAjustarVlrAtualEvolucaoProjecao").modal({backdrop:"static"}),$(document).on("shown.bs.modal",function(a){$("#txtAnaliseEvoluProjetAjusteVlrAtualVlrMesFinal").focus()})}catch(a){return $("#PopModalAjustarVlrAtualEvolucaoProjecao").modal("hide"),void fCriarAlerta("AreaAlertaPrincAnaliseEvoluProjetada",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function AjustarValorAtualProjecao(a){try{fLimparAreaAlerta("AreaAlertaPrincAnaliseEvoluProjetada"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetada"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetadaExc"),fLimparAreaAlerta("AreaAlertaModalAnaliseEvoluProjetadaAjusteVlrAtual");var r=$("#txtAnaliseEvoluProjetAjusteVlrAtualNroMes").val(),o=parseFloat(GetValorDecimal($("#txtAnaliseEvoluProjetAjusteVlrAtualVlrMesFinal").val()));if(""==r||0==r)return void fCriarAlerta("AreaAlertaModalAnaliseEvoluProjetadaAjusteVlrAtual",TP_ALERTA_AVISO,"Nro Mês da Projeção não informado!");$("#TxtGridEvoluProjTipo"+r).html("M"),$("#TxtGridEvoluProjVlrMesFinal"+r).html("R$ "+fMascaraValor(o)),$("#PopModalAjustarVlrAtualEvolucaoProjecao").modal("hide"),ReCalcularTabelaProjetada()}catch(a){return $("#PopModalAjustarVlrAtualEvolucaoProjecao").modal("hide"),void fCriarAlerta("AreaAlertaModalAnaliseEvoluProjetadaAjusteVlrAtual",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fAbrirModalAddMaisProjecao(a){}