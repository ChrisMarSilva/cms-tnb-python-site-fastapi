async function fCarregarAnoApuracao(a){try{promise=new Promise((e,t)=>{$("#selApuracAno").empty(),$("#selApuracAno").append('<option value="" selected>Todos</option>'),$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"apuracao/listaAno",success:function(a){var e=a.data.Resultado,t=a.data.Mensagem,r=a.data.Lista;return"NOK"==e?(fCriarAlertaPrinc(TP_ALERTA_AVISO,t),!1):"OK"==e?($.each(r,function(a,e){$("#selApuracAno").append('<option value="'+e+'" selected>'+e+"</option>")}),fDefinirPadraoSelect("selApuracAno"),!0):(fCriarAlertaPrinc(TP_ALERTA_ERRO,t),!1)},error:function(a){return fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}),e(!0)}).then(a=>{}).catch(a=>{})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fCarregarConfigApuracao(a){try{promise=new Promise((e,t)=>{$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"apuracao/config",success:function(a){var e=a.data.Resultado,t=a.data.Mensagem,r=a.data.Dados;return"NOK"==e?(fCriarAlertaPrinc(TP_ALERTA_AVISO,t),!1):"OK"==e?("S"==r.Valor?$("#chkApuracVlrSuperior20Mil").attr("checked",!0):$("#chkApuracVlrSuperior20Mil").attr("checked",!1),!0):(fCriarAlertaPrinc(TP_ALERTA_ERRO,t),!1)},error:function(a){return fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}),e(!0)}).then(a=>{}).catch(a=>{})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function iniciarAnimacaoPesquisar(){promise=new Promise((a,e)=>{$("#iRefresh").addClass("fa-spin"),$("#btnApuracPesquisar").addClass("disabled"),$("#btnApuracLimpar").addClass("disabled"),a(!0)}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}async function finalizarAnimacaoPesquisa(){promise=new Promise((a,e)=>{$("#iRefresh").removeClass("fa-spin"),$("#btnApuracPesquisar").removeClass("disabled"),$("#btnApuracLimpar").removeClass("disabled"),a(!0)}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}async function fLimparGrid(a){promise=new Promise((e,t)=>{$("#selApuracAno").val(""),$("#chkApuracVlrSuperior20Mil").attr("checked",!1),fLimparSomenteGrid(a),e(!0)}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}async function fLimparSomenteGrid(a){try{promise=new Promise((e,t)=>{$("th").addClass("text-center"),fLimparSomenteGridComum(a),fLimparSomenteGridDayTrade(a),fLimparSomenteGridFII(a),fLimparSomenteGridETFComum(a),fLimparSomenteGridETFDayTrade(a),fLimparSomenteGridBDRComum(a),fLimparSomenteGridBDRDayTrade(a),e(!0)}).then(a=>{}).catch(a=>{})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fLimparSomenteGridComum(a){try{promise=new Promise((a,e)=>{$("#GridComum").dataTable().fnClearTable(),$("#GridComum").dataTable({bDestroy:!0}).fnDestroy(),$("#GridComum").DataTable({oLanguage:fTraduzirGrid(),aoColumns:[{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:0},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:1},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:2},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:3},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:4},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:5},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:6},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:7},{bSortable:!1,sWidth:"5px",targets:8}],order:[],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!1,bSortable:!1,bAutoWidth:!1,bPaginate:!1,bOrdering:!1}),a(!0)}).then(a=>{}).catch(a=>{})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fLimparSomenteGridDayTrade(a){try{promise=new Promise((a,e)=>{$("#GridDayTrade").dataTable().fnClearTable(),$("#GridDayTrade").dataTable({bDestroy:!0}).fnDestroy(),$("#GridDayTrade").DataTable({oLanguage:fTraduzirGrid(),aoColumns:[{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:0},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:1},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:2},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:3},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:4},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:5},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:6},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:7},{bSortable:!1,sWidth:"5px",targets:8}],order:[],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!1,bSortable:!1,bAutoWidth:!1,bPaginate:!1,bOrdering:!1}),a(!0)}).then(a=>{}).catch(a=>{})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fLimparSomenteGridFII(a){try{promise=new Promise((a,e)=>{$("#GridFII").dataTable().fnClearTable(),$("#GridFII").dataTable({bDestroy:!0}).fnDestroy(),$("#GridFII").DataTable({oLanguage:fTraduzirGrid(),aoColumns:[{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:0},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:1},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:2},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:3},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:4},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:5},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:6},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:7},{bSortable:!1,sWidth:"5px",targets:8}],order:[],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!1,bSortable:!1,bAutoWidth:!1,bPaginate:!1,bOrdering:!1}),a(!0)}).then(a=>{}).catch(a=>{})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fLimparSomenteGridETFComum(a){try{promise=new Promise((a,e)=>{$("#GridETFComum").dataTable().fnClearTable(),$("#GridETFComum").dataTable({bDestroy:!0}).fnDestroy(),$("#GridETFComum").DataTable({oLanguage:fTraduzirGrid(),aoColumns:[{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:0},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:1},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:2},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:3},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:4},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:5},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:6},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:7},{bSortable:!1,sWidth:"5px",targets:8}],order:[],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!1,bSortable:!1,bAutoWidth:!1,bPaginate:!1,bOrdering:!1}),a(!0)}).then(a=>{}).catch(a=>{})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fLimparSomenteGridETFDayTrade(a){try{promise=new Promise((a,e)=>{$("#GridETFDayTrade").dataTable().fnClearTable(),$("#GridETFDayTrade").dataTable({bDestroy:!0}).fnDestroy(),$("#GridETFDayTrade").DataTable({oLanguage:fTraduzirGrid(),aoColumns:[{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:0},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:1},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:2},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:3},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:4},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:5},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:6},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:7},{bSortable:!1,sWidth:"5px",targets:8}],order:[],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!1,bSortable:!1,bAutoWidth:!1,bPaginate:!1,bOrdering:!1}),a(!0)}).then(a=>{}).catch(a=>{})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fLimparSomenteGridBDRComum(a){try{promise=new Promise((a,e)=>{$("#GridBDRComum").dataTable().fnClearTable(),$("#GridBDRComum").dataTable({bDestroy:!0}).fnDestroy(),$("#GridBDRComum").DataTable({oLanguage:fTraduzirGrid(),aoColumns:[{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:0},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:1},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:2},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:3},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:4},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:5},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:6},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:7},{bSortable:!1,sWidth:"5px",targets:8}],order:[],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!1,bSortable:!1,bAutoWidth:!1,bPaginate:!1,bOrdering:!1}),a(!0)}).then(a=>{}).catch(a=>{})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fLimparSomenteGridBDRDayTrade(a){try{promise=new Promise((a,e)=>{$("#GridBDRDayTrade").dataTable().fnClearTable(),$("#GridBDRDayTrade").dataTable({bDestroy:!0}).fnDestroy(),$("#GridBDRDayTrade").DataTable({oLanguage:fTraduzirGrid(),aoColumns:[{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:0},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:1},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:2},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:3},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:4},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:5},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:6},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:7},{bSortable:!1,sWidth:"5px",targets:8}],order:[],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!1,bSortable:!1,bAutoWidth:!1,bPaginate:!1,bOrdering:!1}),a(!0)}).then(a=>{}).catch(a=>{})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGridComum(a,e){try{promise=new Promise((t,r)=>{$("#GridComum").DataTable({processing:!0,serverSide:!1,oLanguage:fTraduzirGrid(),data:e,aoColumns:[{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:0},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:1,render:function(a,e,t){return"display"==e?"R$ "+t[1]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:2,render:function(a,e,t){return"display"==e?"R$ "+t[2]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:3,render:function(a,e,t){return"display"==e?"R$ "+t[3]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:4,render:function(a,e,t){return"display"==e?"R$ "+t[4]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:5,render:function(a,e,t){return"display"==e?"R$ "+t[5]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:6,render:function(a,e,t){return"display"==e?"R$ "+t[6]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:7,render:function(a,e,t){return"display"==e?"R$ "+t[7]:a}},{bSortable:!1,sWidth:"10px",targets:8,render:function(e,t,r){var i="",s="",l="primary";if("display"==t){var d=r[0];"0,00"==r[2]&&(s=" disabled",l="secondary"),i+='<a class="btn btn-sm btn-icon btn-icon-mini btn-round btn-simple btn-'+l+s+'"'+s+' style="font-size:9px;" title="Visualizar Vendas do Mês '+d+'" href="javascript:void(0);" onclick="fAbrirModalDetalheVendas( \''+a+"', 'C', '"+d+"' );\">",i+='   <i class="fa fa-eye fa-lg" aria-hidden="true"></i> ',i+="</a>"}return i}}],createdRow:function(a,e,t){$("td",a).addClass("text-center");var r=parseFloat(GetValorDecimal(e[2])),i=parseFloat(GetValorDecimal(e[3])),s=parseFloat(GetValorDecimal(e[4])),l=parseFloat(GetValorDecimal(e[7])),d=$("td",a).eq(0),n=$("td",a).eq(2),o=$("td",a).eq(3),b=$("td",a).eq(4),c=$("td",a).eq(7);r>0&&(d.addClass("text-success font-weight-bold"),n.addClass("text-success font-weight-bold")),r<0&&(d.addClass("text-danger font-weight-bold"),n.addClass("text-danger font-weight-bold")),0==r&&(d.addClass("text-muted"),n.addClass("text-muted")),i>0&&o.addClass("text-success font-weight-bold"),i<0&&o.addClass("text-danger font-weight-bold"),0==i&&o.addClass("text-muted"),s>0&&b.addClass("text-success font-weight-bold"),s<0&&b.addClass("text-danger font-weight-bold"),0==s&&b.addClass("text-muted"),l>0&&c.addClass("text-success font-weight-bold"),l<0&&c.addClass("text-danger font-weight-bold"),0==l&&c.addClass("text-muted")},initComplete:function(a,e){$("#iRefresh").removeClass("fa-spin"),$("#btnApuracPesquisar").removeClass("disabled"),$("#btnApuracLimpar").removeClass("disabled")},order:[],dom:"frtBpi",buttons:[{extend:"excelHtml5",text:'<i class="fa fa-file-excel-o"></i> Excel',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Apuração das Operações Comuns com Ações",titleAttr:"Excel",exportOptions:{columns:[0,1,2,3,4,5,6,7]}},{extend:"csvHtml5",charset:"UTF-8",fieldSeparator:";",titleAttr:"CSV",text:'<i class="fa fa-file-o"></i> CSV',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Apuração das Operações Comuns com Ações",bom:!0,exportOptions:{columns:[0,1,2,3,4,5,6,7]}},{extend:"pdfHtml5",text:'<i class="fa fa-file-pdf-o"></i> PDF',className:"btn btn-default btn-sm",titleAttr:"PDF",title:NOME_PROJETO+" - Apuração das Operações Comuns com Ações",pageSize:"A3",alignment:"center",exportOptions:{columns:[0,1,2,3,4,5,6,7]},footer:!0,customize:function(a){a.defaultStyle.fontSize=12,a.styles.tableHeader.fontSize=14}},{extend:"print",text:'<i class="fa fa-print"></i> Imprimir',title:NOME_PROJETO+" - Apuração das Operações Comuns com Ações",titleAttr:"Imprimir",className:"btn btn-default btn-sm",exportOptions:{columns:[0,1,2,3,4,5,6,7]}}],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!1,bSortable:!1,bAutoWidth:!1,bPaginate:!1,bOrdering:!1}).on("error.dt",function(a,e,t,r){return finalizarAnimacaoPesquisa(),!0}),$(document).ajaxError(function(a,e,t,r){finalizarAnimacaoPesquisa()}),t(!0)}).then(a=>{}).catch(a=>{})}catch(e){fLimparSomenteGrid(a),finalizarAnimacaoPesquisa(),null!=e.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGridDayTrade(a,e){try{promise=new Promise((t,r)=>{$("#GridDayTrade").DataTable({processing:!0,serverSide:!1,oLanguage:fTraduzirGrid(),data:e,aoColumns:[{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:0},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:1,render:function(a,e,t){return"display"==e?"R$ "+t[1]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:2,render:function(a,e,t){return"display"==e?"R$ "+t[2]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:3,render:function(a,e,t){return"display"==e?"R$ "+t[3]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:4,render:function(a,e,t){return"display"==e?"R$ "+t[4]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:5,render:function(a,e,t){return"display"==e?"R$ "+t[5]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:6,render:function(a,e,t){return"display"==e?"R$ "+t[6]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:7,render:function(a,e,t){return"display"==e?"R$ "+t[7]:a}},{bSortable:!1,sWidth:"10px",targets:8,render:function(e,t,r){var i="",s="",l="primary";if("display"==t){var d=r[0];"0,00"==r[2]&&(s=" disabled",l="secondary"),i+='<a class="btn btn-sm btn-icon btn-icon-mini btn-round btn-simple btn-'+l+s+'"'+s+' style="font-size:9px;" title="Visualizar Vendas do Mês '+d+'" href="javascript:void(0);" onclick="fAbrirModalDetalheVendas( \''+a+"', 'D', '"+d+"' );\">",i+='   <i class="fa fa-eye fa-lg" aria-hidden="true"></i> ',i+="</a>"}return i}}],createdRow:function(a,e,t){$("td",a).addClass("text-center");parseFloat(GetValorDecimal(e[1]));var r=parseFloat(GetValorDecimal(e[2])),i=parseFloat(GetValorDecimal(e[3])),s=parseFloat(GetValorDecimal(e[4])),l=parseFloat(GetValorDecimal(e[7])),d=$("td",a).eq(0),n=$("td",a).eq(2),o=$("td",a).eq(3),b=$("td",a).eq(4),c=$("td",a).eq(7);r>0&&(d.addClass("text-success font-weight-bold"),n.addClass("text-success font-weight-bold")),r<0&&(d.addClass("text-danger font-weight-bold"),n.addClass("text-danger font-weight-bold")),0==r&&(d.addClass("text-muted"),n.addClass("text-muted")),i>0&&o.addClass("text-success font-weight-bold"),i<0&&o.addClass("text-danger font-weight-bold"),0==i&&o.addClass("text-muted"),s>0&&b.addClass("text-success font-weight-bold"),s<0&&b.addClass("text-danger font-weight-bold"),0==s&&b.addClass("text-muted"),l>0&&c.addClass("text-success font-weight-bold"),l<0&&c.addClass("text-danger font-weight-bold"),0==l&&c.addClass("text-muted")},initComplete:function(a,e){$("#iRefresh").removeClass("fa-spin"),$("#btnApuracPesquisar").removeClass("disabled"),$("#btnApuracLimpar").removeClass("disabled")},order:[],dom:"frtBpi",buttons:[{extend:"excelHtml5",text:'<i class="fa fa-file-excel-o"></i> Excel',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Apuração das Operações Day Trade com Ações",titleAttr:"Excel",exportOptions:{columns:[0,1,2,3,4,5,6,7]}},{extend:"csvHtml5",charset:"UTF-8",fieldSeparator:";",titleAttr:"CSV",text:'<i class="fa fa-file-o"></i> CSV',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Apuração das Operações Day Trade com Ações",bom:!0,exportOptions:{columns:[0,1,2,3,4,5,6,7]}},{extend:"pdfHtml5",text:'<i class="fa fa-file-pdf-o"></i> PDF',className:"btn btn-default btn-sm",titleAttr:"PDF",title:NOME_PROJETO+" - Apuração das Operações Day Trade com Ações",pageSize:"A3",alignment:"center",exportOptions:{columns:[0,1,2,3,4,5,6,7]},footer:!0,customize:function(a){a.defaultStyle.fontSize=12,a.styles.tableHeader.fontSize=14}},{extend:"print",text:'<i class="fa fa-print"></i> Imprimir',title:NOME_PROJETO+" - Apuração das Operações Day Trade com Ações",titleAttr:"Imprimir",className:"btn btn-default btn-sm",exportOptions:{columns:[0,1,2,3,4,5,6,7]}}],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!1,bSortable:!1,bAutoWidth:!1,bPaginate:!1,bOrdering:!1}).on("error.dt",function(a,e,t,r){return finalizarAnimacaoPesquisa(),!0}),$(document).ajaxError(function(a,e,t,r){finalizarAnimacaoPesquisa()}),t(!0)}).then(a=>{}).catch(a=>{})}catch(e){fLimparSomenteGrid(a),finalizarAnimacaoPesquisa(),null!=e.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGridFII(a,e){try{promise=new Promise((t,r)=>{$("#GridFII").DataTable({processing:!0,serverSide:!1,oLanguage:fTraduzirGrid(),data:e,aoColumns:[{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:0},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:1,render:function(a,e,t){return"display"==e?"R$ "+t[1]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:2,render:function(a,e,t){return"display"==e?"R$ "+t[2]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:3,render:function(a,e,t){return"display"==e?"R$ "+t[3]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:4,render:function(a,e,t){return"display"==e?"R$ "+t[4]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:5,render:function(a,e,t){return"display"==e?"R$ "+t[5]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:6,render:function(a,e,t){return"display"==e?"R$ "+t[6]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:7,render:function(a,e,t){return"display"==e?"R$ "+t[7]:a}},{bSortable:!1,sWidth:"10px",targets:8,render:function(e,t,r){var i="",s="",l="primary";if("display"==t){var d=r[0];"0,00"==r[2]&&(s=" disabled",l="secondary"),i+='<a class="btn btn-sm btn-icon btn-icon-mini btn-round btn-simple btn-'+l+s+'"'+s+' style="font-size:9px;" title="Visualizar Vendas do Mês '+d+'" href="javascript:void(0);" onclick="fAbrirModalDetalheVendas( \''+a+"', 'F', '"+d+"' );\">",i+='   <i class="fa fa-eye fa-lg" aria-hidden="true"></i> ',i+="</a>"}return i}}],createdRow:function(a,e,t){$("td",a).addClass("text-center");parseFloat(GetValorDecimal(e[1]));var r=parseFloat(GetValorDecimal(e[2])),i=parseFloat(GetValorDecimal(e[3])),s=parseFloat(GetValorDecimal(e[4])),l=parseFloat(GetValorDecimal(e[7])),d=$("td",a).eq(0),n=$("td",a).eq(2),o=$("td",a).eq(3),b=$("td",a).eq(4),c=$("td",a).eq(7);r>0&&(d.addClass("text-success font-weight-bold"),n.addClass("text-success font-weight-bold")),r<0&&(d.addClass("text-danger font-weight-bold"),n.addClass("text-danger font-weight-bold")),0==r&&(d.addClass("text-muted"),n.addClass("text-muted")),i>0&&o.addClass("text-success font-weight-bold"),i<0&&o.addClass("text-danger font-weight-bold"),0==i&&o.addClass("text-muted"),s>0&&b.addClass("text-success font-weight-bold"),s<0&&b.addClass("text-danger font-weight-bold"),0==s&&b.addClass("text-muted"),l>0&&c.addClass("text-success font-weight-bold"),l<0&&c.addClass("text-danger font-weight-bold"),0==l&&c.addClass("text-muted")},initComplete:function(a,e){$("#iRefresh").removeClass("fa-spin"),$("#btnApuracPesquisar").removeClass("disabled"),$("#btnApuracLimpar").removeClass("disabled")},order:[],dom:"frtBpi",buttons:[{extend:"excelHtml5",text:'<i class="fa fa-file-excel-o"></i> Excel',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Apuração das Operações com FIIs",titleAttr:"Excel",exportOptions:{columns:[0,1,2,3,4,5,6,7]}},{extend:"csvHtml5",charset:"UTF-8",fieldSeparator:";",titleAttr:"CSV",text:'<i class="fa fa-file-o"></i> CSV',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Apuração das Operações com FIIs",bom:!0,exportOptions:{columns:[0,1,2,3,4,5,6,7]}},{extend:"pdfHtml5",text:'<i class="fa fa-file-pdf-o"></i> PDF',className:"btn btn-default btn-sm",titleAttr:"PDF",title:NOME_PROJETO+" - Apuração das Operações com FIIs",pageSize:"A3",alignment:"center",exportOptions:{columns:[0,1,2,3,4,5,6,7]},footer:!0,customize:function(a){a.defaultStyle.fontSize=12,a.styles.tableHeader.fontSize=14}},{extend:"print",text:'<i class="fa fa-print"></i> Imprimir',title:NOME_PROJETO+" - Apuração das Operações com FIIs",titleAttr:"Imprimir",className:"btn btn-default btn-sm",exportOptions:{columns:[0,1,2,3,4,5,6,7]}}],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!1,bSortable:!1,bAutoWidth:!1,bPaginate:!1,bOrdering:!1}).on("error.dt",function(a,e,t,r){return finalizarAnimacaoPesquisa(),!0}),$(document).ajaxError(function(a,e,t,r){finalizarAnimacaoPesquisa()}),t(!0)}).then(a=>{}).catch(a=>{})}catch(e){fLimparSomenteGrid(a),finalizarAnimacaoPesquisa(),null!=e.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGridETFComum(a,e){try{promise=new Promise((t,r)=>{$("#GridETFComum").DataTable({processing:!0,serverSide:!1,oLanguage:fTraduzirGrid(),data:e,aoColumns:[{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:0},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:1,render:function(a,e,t){return"display"==e?"R$ "+t[1]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:2,render:function(a,e,t){return"display"==e?"R$ "+t[2]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:3,render:function(a,e,t){return"display"==e?"R$ "+t[3]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:4,render:function(a,e,t){return"display"==e?"R$ "+t[4]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:5,render:function(a,e,t){return"display"==e?"R$ "+t[5]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:6,render:function(a,e,t){return"display"==e?"R$ "+t[6]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:7,render:function(a,e,t){return"display"==e?"R$ "+t[7]:a}},{bSortable:!1,sWidth:"10px",targets:8,render:function(e,t,r){var i="",s="",l="primary";if("display"==t){var d=r[0];"0,00"==r[2]&&(s=" disabled",l="secondary"),i+='<a class="btn btn-sm btn-icon btn-icon-mini btn-round btn-simple btn-'+l+s+'"'+s+' style="font-size:9px;" title="Visualizar Vendas do Mês '+d+'" href="javascript:void(0);" onclick="fAbrirModalDetalheVendas( \''+a+"', 'E', '"+d+"' );\">",i+='   <i class="fa fa-eye fa-lg" aria-hidden="true"></i> ',i+="</a>"}return i}}],createdRow:function(a,e,t){$("td",a).addClass("text-center");parseFloat(GetValorDecimal(e[1]));var r=parseFloat(GetValorDecimal(e[2])),i=parseFloat(GetValorDecimal(e[3])),s=parseFloat(GetValorDecimal(e[4])),l=parseFloat(GetValorDecimal(e[7])),d=$("td",a).eq(0),n=$("td",a).eq(2),o=$("td",a).eq(3),b=$("td",a).eq(4),c=$("td",a).eq(7);r>0&&(d.addClass("text-success font-weight-bold"),n.addClass("text-success font-weight-bold")),r<0&&(d.addClass("text-danger font-weight-bold"),n.addClass("text-danger font-weight-bold")),0==r&&(d.addClass("text-muted"),n.addClass("text-muted")),i>0&&o.addClass("text-success font-weight-bold"),i<0&&o.addClass("text-danger font-weight-bold"),0==i&&o.addClass("text-muted"),s>0&&b.addClass("text-success font-weight-bold"),s<0&&b.addClass("text-danger font-weight-bold"),0==s&&b.addClass("text-muted"),l>0&&c.addClass("text-success font-weight-bold"),l<0&&c.addClass("text-danger font-weight-bold"),0==l&&c.addClass("text-muted")},initComplete:function(a,e){$("#iRefresh").removeClass("fa-spin"),$("#btnApuracPesquisar").removeClass("disabled"),$("#btnApuracLimpar").removeClass("disabled")},order:[],dom:"frtBpi",buttons:[{extend:"excelHtml5",text:'<i class="fa fa-file-excel-o"></i> Excel',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Apuração das Operações Comum com ETFs",titleAttr:"Excel",exportOptions:{columns:[0,1,2,3,4,5,6,7]}},{extend:"csvHtml5",charset:"UTF-8",fieldSeparator:";",titleAttr:"CSV",text:'<i class="fa fa-file-o"></i> CSV',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Apuração das Operações Comum com ETFs",bom:!0,exportOptions:{columns:[0,1,2,3,4,5,6,7]}},{extend:"pdfHtml5",text:'<i class="fa fa-file-pdf-o"></i> PDF',className:"btn btn-default btn-sm",titleAttr:"PDF",title:NOME_PROJETO+" - Apuração das Operações Comum com ETFs",pageSize:"A3",alignment:"center",exportOptions:{columns:[0,1,2,3,4,5,6,7]},footer:!0,customize:function(a){a.defaultStyle.fontSize=12,a.styles.tableHeader.fontSize=14}},{extend:"print",text:'<i class="fa fa-print"></i> Imprimir',title:NOME_PROJETO+" - Apuração das Operações Comum com ETFs",titleAttr:"Imprimir",className:"btn btn-default btn-sm",exportOptions:{columns:[0,1,2,3,4,5,6,7]}}],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!1,bSortable:!1,bAutoWidth:!1,bPaginate:!1,bOrdering:!1}).on("error.dt",function(a,e,t,r){return finalizarAnimacaoPesquisa(),!0}),$(document).ajaxError(function(a,e,t,r){finalizarAnimacaoPesquisa()}),t(!0)}).then(a=>{}).catch(a=>{})}catch(e){fLimparSomenteGrid(a),finalizarAnimacaoPesquisa(),null!=e.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGridETFDayTrade(a,e){try{promise=new Promise((t,r)=>{$("#GridETFDayTrade").DataTable({processing:!0,serverSide:!1,oLanguage:fTraduzirGrid(),data:e,aoColumns:[{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:0},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:1,render:function(a,e,t){return"display"==e?"R$ "+t[1]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:2,render:function(a,e,t){return"display"==e?"R$ "+t[2]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:3,render:function(a,e,t){return"display"==e?"R$ "+t[3]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:4,render:function(a,e,t){return"display"==e?"R$ "+t[4]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:5,render:function(a,e,t){return"display"==e?"R$ "+t[5]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:6,render:function(a,e,t){return"display"==e?"R$ "+t[6]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:7,render:function(a,e,t){return"display"==e?"R$ "+t[7]:a}},{bSortable:!1,sWidth:"10px",targets:8,render:function(e,t,r){var i="",s="",l="primary";if("display"==t){var d=r[0];"0,00"==r[2]&&(s=" disabled",l="secondary"),i+='<a class="btn btn-sm btn-icon btn-icon-mini btn-round btn-simple btn-'+l+s+'"'+s+' style="font-size:9px;" title="Visualizar Vendas do Mês '+d+'" href="javascript:void(0);" onclick="fAbrirModalDetalheVendas( \''+a+"', 'G', '"+d+"' );\">",i+='   <i class="fa fa-eye fa-lg" aria-hidden="true"></i> ',i+="</a>"}return i}}],createdRow:function(a,e,t){$("td",a).addClass("text-center");parseFloat(GetValorDecimal(e[1]));var r=parseFloat(GetValorDecimal(e[2])),i=parseFloat(GetValorDecimal(e[3])),s=parseFloat(GetValorDecimal(e[4])),l=parseFloat(GetValorDecimal(e[7])),d=$("td",a).eq(0),n=$("td",a).eq(2),o=$("td",a).eq(3),b=$("td",a).eq(4),c=$("td",a).eq(7);r>0&&(d.addClass("text-success font-weight-bold"),n.addClass("text-success font-weight-bold")),r<0&&(d.addClass("text-danger font-weight-bold"),n.addClass("text-danger font-weight-bold")),0==r&&(d.addClass("text-muted"),n.addClass("text-muted")),i>0&&o.addClass("text-success font-weight-bold"),i<0&&o.addClass("text-danger font-weight-bold"),0==i&&o.addClass("text-muted"),s>0&&b.addClass("text-success font-weight-bold"),s<0&&b.addClass("text-danger font-weight-bold"),0==s&&b.addClass("text-muted"),l>0&&c.addClass("text-success font-weight-bold"),l<0&&c.addClass("text-danger font-weight-bold"),0==l&&c.addClass("text-muted")},initComplete:function(a,e){$("#iRefresh").removeClass("fa-spin"),$("#btnApuracPesquisar").removeClass("disabled"),$("#btnApuracLimpar").removeClass("disabled")},order:[],dom:"frtBpi",buttons:[{extend:"excelHtml5",text:'<i class="fa fa-file-excel-o"></i> Excel',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Apuração das Operações Day Trade com ETFs",titleAttr:"Excel",exportOptions:{columns:[0,1,2,3,4,5,6,7]}},{extend:"csvHtml5",charset:"UTF-8",fieldSeparator:";",titleAttr:"CSV",text:'<i class="fa fa-file-o"></i> CSV',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Apuração das Operações Day Trade com ETFs",bom:!0,exportOptions:{columns:[0,1,2,3,4,5,6,7]}},{extend:"pdfHtml5",text:'<i class="fa fa-file-pdf-o"></i> PDF',className:"btn btn-default btn-sm",titleAttr:"PDF",title:NOME_PROJETO+" - Apuração das Operações Day Trade com ETFs",pageSize:"A3",alignment:"center",exportOptions:{columns:[0,1,2,3,4,5,6,7]},footer:!0,customize:function(a){a.defaultStyle.fontSize=12,a.styles.tableHeader.fontSize=14}},{extend:"print",text:'<i class="fa fa-print"></i> Imprimir',title:NOME_PROJETO+" - Apuração das Operações Day Trade com ETFs",titleAttr:"Imprimir",className:"btn btn-default btn-sm",exportOptions:{columns:[0,1,2,3,4,5,6,7]}}],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!1,bSortable:!1,bAutoWidth:!1,bPaginate:!1,bOrdering:!1}).on("error.dt",function(a,e,t,r){return finalizarAnimacaoPesquisa(),!0}),$(document).ajaxError(function(a,e,t,r){finalizarAnimacaoPesquisa()}),t(!0)}).then(a=>{}).catch(a=>{})}catch(e){fLimparSomenteGrid(a),finalizarAnimacaoPesquisa(),null!=e.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGridBDRComum(a,e){try{promise=new Promise((t,r)=>{$("#GridBDRComum").DataTable({processing:!0,serverSide:!1,oLanguage:fTraduzirGrid(),data:e,aoColumns:[{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:0},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:1,render:function(a,e,t){return"display"==e?"R$ "+t[1]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:2,render:function(a,e,t){return"display"==e?"R$ "+t[2]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:3,render:function(a,e,t){return"display"==e?"R$ "+t[3]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:4,render:function(a,e,t){return"display"==e?"R$ "+t[4]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:5,render:function(a,e,t){return"display"==e?"R$ "+t[5]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:6,render:function(a,e,t){return"display"==e?"R$ "+t[6]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:7,render:function(a,e,t){return"display"==e?"R$ "+t[7]:a}},{bSortable:!1,sWidth:"10px",targets:8,render:function(e,t,r){var i="",s="",l="primary";if("display"==t){var d=r[0];"0,00"==r[2]&&(s=" disabled",l="secondary"),i+='<a class="btn btn-sm btn-icon btn-icon-mini btn-round btn-simple btn-'+l+s+'"'+s+' style="font-size:9px;" title="Visualizar Vendas do Mês '+d+'" href="javascript:void(0);" onclick="fAbrirModalDetalheVendas( \''+a+"', 'E', '"+d+"' );\">",i+='   <i class="fa fa-eye fa-lg" aria-hidden="true"></i> ',i+="</a>"}return i}}],createdRow:function(a,e,t){$("td",a).addClass("text-center");parseFloat(GetValorDecimal(e[1]));var r=parseFloat(GetValorDecimal(e[2])),i=parseFloat(GetValorDecimal(e[3])),s=parseFloat(GetValorDecimal(e[4])),l=parseFloat(GetValorDecimal(e[7])),d=$("td",a).eq(0),n=$("td",a).eq(2),o=$("td",a).eq(3),b=$("td",a).eq(4),c=$("td",a).eq(7);r>0&&(d.addClass("text-success font-weight-bold"),n.addClass("text-success font-weight-bold")),r<0&&(d.addClass("text-danger font-weight-bold"),n.addClass("text-danger font-weight-bold")),0==r&&(d.addClass("text-muted"),n.addClass("text-muted")),i>0&&o.addClass("text-success font-weight-bold"),i<0&&o.addClass("text-danger font-weight-bold"),0==i&&o.addClass("text-muted"),s>0&&b.addClass("text-success font-weight-bold"),s<0&&b.addClass("text-danger font-weight-bold"),0==s&&b.addClass("text-muted"),l>0&&c.addClass("text-success font-weight-bold"),l<0&&c.addClass("text-danger font-weight-bold"),0==l&&c.addClass("text-muted")},initComplete:function(a,e){$("#iRefresh").removeClass("fa-spin"),$("#btnApuracPesquisar").removeClass("disabled"),$("#btnApuracLimpar").removeClass("disabled")},order:[],dom:"frtBpi",buttons:[{extend:"excelHtml5",text:'<i class="fa fa-file-excel-o"></i> Excel',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Apuração das Operações Comum com BDRs",titleAttr:"Excel",exportOptions:{columns:[0,1,2,3,4,5,6,7]}},{extend:"csvHtml5",charset:"UTF-8",fieldSeparator:";",titleAttr:"CSV",text:'<i class="fa fa-file-o"></i> CSV',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Apuração das Operações Comum com BDRs",bom:!0,exportOptions:{columns:[0,1,2,3,4,5,6,7]}},{extend:"pdfHtml5",text:'<i class="fa fa-file-pdf-o"></i> PDF',className:"btn btn-default btn-sm",titleAttr:"PDF",title:NOME_PROJETO+" - Apuração das Operações Comum com BDRs",pageSize:"A3",alignment:"center",exportOptions:{columns:[0,1,2,3,4,5,6,7]},footer:!0,customize:function(a){a.defaultStyle.fontSize=12,a.styles.tableHeader.fontSize=14}},{extend:"print",text:'<i class="fa fa-print"></i> Imprimir',title:NOME_PROJETO+" - Apuração das Operações Comum com BDRs",titleAttr:"Imprimir",className:"btn btn-default btn-sm",exportOptions:{columns:[0,1,2,3,4,5,6,7]}}],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!1,bSortable:!1,bAutoWidth:!1,bPaginate:!1,bOrdering:!1}).on("error.dt",function(a,e,t,r){return finalizarAnimacaoPesquisa(),!0}),$(document).ajaxError(function(a,e,t,r){finalizarAnimacaoPesquisa()}),t(!0)}).then(a=>{}).catch(a=>{})}catch(e){fLimparSomenteGrid(a),finalizarAnimacaoPesquisa(),null!=e.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGridBDRDayTrade(a,e){try{promise=new Promise((t,r)=>{$("#GridBDRDayTrade").DataTable({processing:!0,serverSide:!1,oLanguage:fTraduzirGrid(),data:e,aoColumns:[{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:0},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:1,render:function(a,e,t){return"display"==e?"R$ "+t[1]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:2,render:function(a,e,t){return"display"==e?"R$ "+t[2]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:3,render:function(a,e,t){return"display"==e?"R$ "+t[3]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:4,render:function(a,e,t){return"display"==e?"R$ "+t[4]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:5,render:function(a,e,t){return"display"==e?"R$ "+t[5]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:6,render:function(a,e,t){return"display"==e?"R$ "+t[6]:a}},{bSortable:!1,bOrderable:!1,sWidth:"50px",targets:7,render:function(a,e,t){return"display"==e?"R$ "+t[7]:a}},{bSortable:!1,sWidth:"10px",targets:8,render:function(e,t,r){var i="",s="",l="primary";if("display"==t){var d=r[0];"0,00"==r[2]&&(s=" disabled",l="secondary"),i+='<a class="btn btn-sm btn-icon btn-icon-mini btn-round btn-simple btn-'+l+s+'"'+s+' style="font-size:9px;" title="Visualizar Vendas do Mês '+d+'" href="javascript:void(0);" onclick="fAbrirModalDetalheVendas( \''+a+"', 'G', '"+d+"' );\">",i+='   <i class="fa fa-eye fa-lg" aria-hidden="true"></i> ',i+="</a>"}return i}}],createdRow:function(a,e,t){$("td",a).addClass("text-center");parseFloat(GetValorDecimal(e[1]));var r=parseFloat(GetValorDecimal(e[2])),i=parseFloat(GetValorDecimal(e[3])),s=parseFloat(GetValorDecimal(e[4])),l=parseFloat(GetValorDecimal(e[7])),d=$("td",a).eq(0),n=$("td",a).eq(2),o=$("td",a).eq(3),b=$("td",a).eq(4),c=$("td",a).eq(7);r>0&&(d.addClass("text-success font-weight-bold"),n.addClass("text-success font-weight-bold")),r<0&&(d.addClass("text-danger font-weight-bold"),n.addClass("text-danger font-weight-bold")),0==r&&(d.addClass("text-muted"),n.addClass("text-muted")),i>0&&o.addClass("text-success font-weight-bold"),i<0&&o.addClass("text-danger font-weight-bold"),0==i&&o.addClass("text-muted"),s>0&&b.addClass("text-success font-weight-bold"),s<0&&b.addClass("text-danger font-weight-bold"),0==s&&b.addClass("text-muted"),l>0&&c.addClass("text-success font-weight-bold"),l<0&&c.addClass("text-danger font-weight-bold"),0==l&&c.addClass("text-muted")},initComplete:function(a,e){$("#iRefresh").removeClass("fa-spin"),$("#btnApuracPesquisar").removeClass("disabled"),$("#btnApuracLimpar").removeClass("disabled")},order:[],dom:"frtBpi",buttons:[{extend:"excelHtml5",text:'<i class="fa fa-file-excel-o"></i> Excel',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Apuração das Operações Day Trade com BDRs",titleAttr:"Excel",exportOptions:{columns:[0,1,2,3,4,5,6,7]}},{extend:"csvHtml5",charset:"UTF-8",fieldSeparator:";",titleAttr:"CSV",text:'<i class="fa fa-file-o"></i> CSV',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Apuração das Operações Day Trade com BDRs",bom:!0,exportOptions:{columns:[0,1,2,3,4,5,6,7]}},{extend:"pdfHtml5",text:'<i class="fa fa-file-pdf-o"></i> PDF',className:"btn btn-default btn-sm",titleAttr:"PDF",title:NOME_PROJETO+" - Apuração das Operações Day Trade com BDRs",pageSize:"A3",alignment:"center",exportOptions:{columns:[0,1,2,3,4,5,6,7]},footer:!0,customize:function(a){a.defaultStyle.fontSize=12,a.styles.tableHeader.fontSize=14}},{extend:"print",text:'<i class="fa fa-print"></i> Imprimir',title:NOME_PROJETO+" - Apuração das Operações Day Trade com BDRs",titleAttr:"Imprimir",className:"btn btn-default btn-sm",exportOptions:{columns:[0,1,2,3,4,5,6,7]}}],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!1,bSortable:!1,bAutoWidth:!1,bPaginate:!1,bOrdering:!1}).on("error.dt",function(a,e,t,r){return finalizarAnimacaoPesquisa(),!0}),$(document).ajaxError(function(a,e,t,r){finalizarAnimacaoPesquisa()}),t(!0)}).then(a=>{}).catch(a=>{})}catch(e){fLimparSomenteGrid(a),finalizarAnimacaoPesquisa(),null!=e.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fCarregarGrid(a){try{$("#GridComum").dataTable().fnClearTable(),$("#GridDayTrade").dataTable().fnClearTable(),$("#GridFII").dataTable().fnClearTable(),$("#GridETFComum").dataTable().fnClearTable(),$("#GridETFDayTrade").dataTable().fnClearTable(),$("#GridBDRComum").dataTable().fnClearTable(),$("#GridBDRDayTrade").dataTable().fnClearTable(),$("#GridComum").dataTable({bDestroy:!0}).fnDestroy(),$("#GridDayTrade").dataTable({bDestroy:!0}).fnDestroy(),$("#GridFII").dataTable({bDestroy:!0}).fnDestroy(),$("#GridETFComum").dataTable({bDestroy:!0}).fnDestroy(),$("#GridETFDayTrade").dataTable({bDestroy:!0}).fnDestroy(),$("#GridBDRComum").dataTable({bDestroy:!0}).fnDestroy(),$("#GridBDRDayTrade").dataTable({bDestroy:!0}).fnDestroy(),finalizarAnimacaoPesquisa(),iniciarAnimacaoPesquisar();var e=$("#selApuracAno").val();"T"==e&&(e="");var t="N";$("#chkApuracVlrSuperior20Mil").is(":checked")&&(t="S"),promiseComum=new Promise((r,i)=>{$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"apuracao/grid",data:{AnoApuracao:e,CalcVlrSuperior:t,TpApuracao:"C"},success:function(e){var t=e.data.Resultado,r=e.data.Mensagem,i=e.data.Lista;return"NSESSAO"==t?($(location).attr("href",a+"/login"),!1):"NOK"==t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_AVISO,r)):"FALHA"==t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,r)):"OK"!=t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,r)):void fMontarGridComum(a,i)},error:function(e){return finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}),r(!0)}).then(a=>{}).catch(a=>{}),promiseDayTrade=new Promise((t,r)=>{$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"apuracao/grid",data:{AnoApuracao:e,CalcVlrSuperior:"N",TpApuracao:"D"},success:function(e){var t=e.data.Resultado,r=e.data.Mensagem,i=e.data.Lista;return"NSESSAO"==t?($(location).attr("href",a+"/login"),!1):"NOK"==t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_AVISO,r)):"FALHA"==t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,r)):"OK"!=t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,r)):void fMontarGridDayTrade(a,i)},error:function(e){return finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}),t(!0)}).then(a=>{}).catch(a=>{}),promiseFII=new Promise((t,r)=>{$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"apuracao/grid",data:{AnoApuracao:e,CalcVlrSuperior:"N",TpApuracao:"F"},success:function(e){var t=e.data.Resultado,r=e.data.Mensagem,i=e.data.Lista;return"NSESSAO"==t?($(location).attr("href",a+"/login"),!1):"NOK"==t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_AVISO,r)):"FALHA"==t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,r)):"OK"!=t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,r)):void fMontarGridFII(a,i)},error:function(e){return finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}),t(!0)}).then(a=>{}).catch(a=>{}),promiseETFComum=new Promise((t,r)=>{$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"apuracao/grid",data:{AnoApuracao:e,CalcVlrSuperior:"N",TpApuracao:"E"},success:function(e){var t=e.data.Resultado,r=e.data.Mensagem,i=e.data.Lista;return"NSESSAO"==t?($(location).attr("href",a+"/login"),!1):"NOK"==t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_AVISO,r)):"FALHA"==t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,r)):"OK"!=t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,r)):void fMontarGridETFComum(a,i)},error:function(e){return finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}),t(!0)}).then(a=>{}).catch(a=>{}),promiseETFDayTrade=new Promise((t,r)=>{$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"apuracao/grid",data:{AnoApuracao:e,CalcVlrSuperior:"N",TpApuracao:"G"},success:function(e){var t=e.data.Resultado,r=e.data.Mensagem,i=e.data.Lista;return"NSESSAO"==t?($(location).attr("href",a+"/login"),!1):"NOK"==t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_AVISO,r)):"FALHA"==t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,r)):"OK"!=t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,r)):void fMontarGridETFDayTrade(a,i)},error:function(e){return finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}),t(!0)}).then(a=>{}).catch(a=>{}),promiseBDRComum=new Promise((t,r)=>{$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"apuracao/grid",data:{AnoApuracao:e,CalcVlrSuperior:"N",TpApuracao:"I"},success:function(e){var t=e.data.Resultado,r=e.data.Mensagem,i=e.data.Lista;return"NSESSAO"==t?($(location).attr("href",a+"/login"),!1):"NOK"==t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_AVISO,r)):"FALHA"==t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,r)):"OK"!=t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,r)):void fMontarGridBDRComum(a,i)},error:function(e){return finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}),t(!0)}).then(a=>{}).catch(a=>{}),promiseBDRDayTrade=new Promise((t,r)=>{$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"apuracao/grid",data:{AnoApuracao:e,CalcVlrSuperior:"N",TpApuracao:"J"},success:function(e){var t=e.data.Resultado,r=e.data.Mensagem,i=e.data.Lista;return"NSESSAO"==t?($(location).attr("href",a+"/login"),!1):"NOK"==t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_AVISO,r)):"FALHA"==t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,r)):"OK"!=t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,r)):void fMontarGridBDRDayTrade(a,i)},error:function(e){return finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}),t(!0)}).then(a=>{}).catch(a=>{})}catch(e){finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),null!=e.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fAbrirModalAjusteApuracao(a){try{fLimparAreaAlertaModalCad();var e=new Date;$("#txtCadApurAno").val(e.getFullYear()),$("#txtCadApurTipo").val("C"),$("#PopModalDetalheAjusteApur").modal({backdrop:"static"}),fCarregarGridAjusteApuracao(a)}catch(a){$("#PopModalDetalheAjusteApur").modal("hide"),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fCarregarGridAjusteApuracao(a){try{fLimparAreaAlertaModalCad(),$("#iRefreshBuscar").removeClass("fa-spin"),$("#btnApuracBuscar").removeClass("disabled"),$("#txtCadApurVlrJAN").val("0,00"),$("#txtCadApurVlrFEV").val("0,00"),$("#txtCadApurVlrMAR").val("0,00"),$("#txtCadApurVlrABR").val("0,00"),$("#txtCadApurVlrMAI").val("0,00"),$("#txtCadApurVlrJUN").val("0,00"),$("#txtCadApurVlrJUL").val("0,00"),$("#txtCadApurVlrAGO").val("0,00"),$("#txtCadApurVlrSET").val("0,00"),$("#txtCadApurVlrOUT").val("0,00"),$("#txtCadApurVlrNOV").val("0,00"),$("#txtCadApurVlrDEZ").val("0,00");var e=$("#txtCadApurAno").val().trim(),t=$("#txtCadApurTipo").val().trim();if(""==t)return fCriarAlertaModalCad(TP_ALERTA_AVISO,"Por favor, preencha o campo Tipo!"),!1;if(""==e)return fCriarAlertaModalCad(TP_ALERTA_AVISO,"Por favor, preencha o campo Ano!"),!1;if(4!=e.length)return fCriarAlertaModalCad(TP_ALERTA_AVISO,"Ano inválido!"),!1;var r=new Date;if(e>r.getFullYear())return fCriarAlertaModalCad(TP_ALERTA_AVISO,"Ano maior que Ano Atual!"),!1;$("#iRefreshBuscar").addClass("fa-spin"),$("#btnApuracBuscar").addClass("disabled"),promise=new Promise((r,i)=>{$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"apuracao/carregar",data:{Ano:e,Categoria:t},success:function(e){$("#iRefreshBuscar").removeClass("fa-spin"),$("#btnApuracBuscar").removeClass("disabled");var t=e.data.Resultado,r=e.data.Mensagem,i=e.data.Dados;if("NSESSAO"==t)return $(location).attr("href",a+"/login"),!1;"NOK"==t?fCriarAlertaPrinc(TP_ALERTA_AVISO,r):"FALHA"==t?fCriarAlertaPrinc(TP_ALERTA_ERRO,r):"OK"==t&&i.JAN?($("#txtCadApurVlrJAN").val(i.JAN),$("#txtCadApurVlrFEV").val(i.FEV),$("#txtCadApurVlrMAR").val(i.MAR),$("#txtCadApurVlrABR").val(i.ABR),$("#txtCadApurVlrMAI").val(i.MAI),$("#txtCadApurVlrJUN").val(i.JUN),$("#txtCadApurVlrJUL").val(i.JUL),$("#txtCadApurVlrAGO").val(i.AGO),$("#txtCadApurVlrSET").val(i.SET),$("#txtCadApurVlrOUT").val(i.OUT),$("#txtCadApurVlrNOV").val(i.NOV),$("#txtCadApurVlrDEZ").val(i.DEZ)):fCriarAlertaModalCad(TP_ALERTA_ERRO,r)},error:function(a){$("#iRefreshBuscar").removeClass("fa-spin"),$("#btnApuracBuscar").removeClass("disabled"),fCriarAlertaModalCad(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}),r(!0)}).then(a=>{}).catch(a=>{})}catch(a){$("#iRefreshBuscar").removeClass("fa-spin"),$("#btnApuracBuscar").removeClass("disabled"),fCriarAlertaModalCad(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fSalvarDadosAjusteApur(a){try{promise=new Promise((e,t)=>{iniciarAnimacaoSalvar();var r=$("#txtCadApurAno").val().trim(),i=$("#txtCadApurTipo").val().trim(),s=$("#txtCadApurVlrJAN").val().trim(),l=$("#txtCadApurVlrFEV").val().trim(),d=$("#txtCadApurVlrMAR").val().trim(),n=$("#txtCadApurVlrABR").val().trim(),o=$("#txtCadApurVlrMAI").val().trim(),b=$("#txtCadApurVlrJUN").val().trim(),c=$("#txtCadApurVlrJUL").val().trim(),u=$("#txtCadApurVlrAGO").val().trim(),p=$("#txtCadApurVlrSET").val().trim(),f=$("#txtCadApurVlrOUT").val().trim(),m=$("#txtCadApurVlrNOV").val().trim(),A=$("#txtCadApurVlrDEZ").val().trim();s=parseFloat(GetValorDecimal(s)),l=parseFloat(GetValorDecimal(l)),d=parseFloat(GetValorDecimal(d)),n=parseFloat(GetValorDecimal(n)),o=parseFloat(GetValorDecimal(o)),b=parseFloat(GetValorDecimal(b)),c=parseFloat(GetValorDecimal(c)),u=parseFloat(GetValorDecimal(u)),p=parseFloat(GetValorDecimal(p)),f=parseFloat(GetValorDecimal(f)),m=parseFloat(GetValorDecimal(m)),A=parseFloat(GetValorDecimal(A)),$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"apuracao/salvar",data:{Ano:r,Categoria:i,VlrJAN:s,VlrFEV:l,VlrMAR:d,VlrABR:n,VlrMAI:o,VlrJUN:b,VlrJUL:c,VlrAGO:u,VlrSET:p,VlrOUT:f,VlrNOV:m,VlrDEZ:A},success:function(e){finalizarAnimacaoSalvar();var t=e.data.Resultado,r=e.data.Mensagem;if("NSESSAO"==t)return $(location).attr("href",a+"/login"),!1;"NOK"!=t?"FALHA"!=t&&"OK"==t?($("#PopModalDetalheAjusteApur").modal("hide"),fCriarAlertaPrinc(TP_ALERTA_SUCESSO,"Dados salvo com sucesso!"),fCarregarAnoApuracao(a),fCarregarGrid(a)):fCriarAlertaModalCad(TP_ALERTA_ERRO,r):fCriarAlertaModalCad(TP_ALERTA_AVISO,r)},error:function(a){finalizarAnimacaoSalvar(),fCriarAlertaModalCad(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}),e(!0)}).then(a=>{}).catch(a=>{})}catch(a){return finalizarAnimacaoSalvar(),void CriarAlertaModal(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fAbrirModalDetalheVendas(a,e,t){try{promise=new Promise((r,i)=>{fLimparAreaAlertaPrinc();var s=$("#DivGridApuracVendas");s.html("");var l=t;if(l=(l=l.replace("/","")).substring(2,6)+l.substring(0,2),""==e||""==t||""==l)return fCriarAlertaPrinc(TP_ALERTA_AVISO,"Dados da pesquisa inválido!"),!1;$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"apuracao/gridVendas",data:{TpApuracao:e,AnoMesApuracao:l},success:function(e){var t=e.data.Resultado,r=e.data.Mensagem,i=e.data.Lista;if("NSESSAO"==t)return $(location).attr("href",a+"/login"),!1;if("NOK"==t)return $("#PopModalDetalheApuracVendas").modal("hide"),void fCriarAlertaPrinc(TP_ALERTA_AVISO,r);if("FALHA"==t)return $("#PopModalDetalheApuracVendas").modal("hide"),void fCriarAlertaPrinc(TP_ALERTA_ERRO,r);if("OK"==t){if(i.length>0){var l=0,d=0,n="";return n+='<table class="table table-sm table-hover" style="font-size: 12px;" border="0" cellspacing="0" width="100%" style="margin: 0px;">',n+="  <thead>",n+='    <tr style="font-size: 12px;" class="thead-dark font-weight-bold"> ',n+="      <th>Data</th>",n+="      <th>Ativo</th>",n+="      <th>Quant.</th>",n+="      <th>Preço Médio</th>",n+="      <th>Custo/Ação</th>",n+="      <th>Total</th>",n+="      <th>Valorização</th>",n+="      <th>%</th>",n+="    </tr>",n+="  </thead>",n+="  <tbody>",$.each(i,function(a,e){var t=e[0],r=e[1],i=e[2],s=parseFloat(GetValorDecimal(e[3])),o=parseFloat(GetValorDecimal(e[4])),b=parseFloat(GetValorDecimal(e[5])),c=parseFloat(GetValorDecimal(e[6])),u=parseFloat(GetValorDecimal(e[7])),p="text-muted";c>0&&(p="text-success"),c<0&&(p="text-danger"),l+=b,d+=c,n+='    <tr class="text-center '+p+'" > ',n+='      <td style="width:5px;">'+t+"</td>",n+='      <td style="width:5px;">'+r+"</td>",n+='      <td style="width:10px;">'+i+"</td>",n+='      <td style="width:15px;">R$ '+fMascaraValor(o)+"</td>",n+='      <td style="width:15px;">R$ '+fMascaraValor(s)+"</td>",n+='      <td style="width:20px;">R$ '+fMascaraValor(b)+"</td>",n+='      <td style="width:20px;">R$ '+fMascaraValor(c)+"</td>",n+='      <td style="width:5px;">'+fMascaraValor(u)+"%</td>",n+="    </tr>"}),n+='    <tr style="font-size: 12px;" class="text-dark font-weight-bold" > ',n+="      <td> </td>",n+="      <td> </td>",n+="      <td> </td>",n+="      <td> </td>",n+="      <td> </td>",n+="      <td>R$ "+fMascaraValor(l)+"</td>",n+="      <td>R$ "+fMascaraValor(d)+"</td>",n+="      <td> </td>",n+="    </tr>",n+="  </tbody>",n+="</table>",s.html(""),s.append(n),$("#PopModalDetalheApuracVendas").modal({backdrop:"static"}),!0}return fCriarAlertaPrinc(TP_ALERTA_AVISO,"Sem Dados para Exibir!"),!0}return $("#PopModalDetalheApuracVendas").modal("hide"),void fCriarAlertaPrinc(TP_ALERTA_ERRO,r)},error:function(a){$("#PopModalDetalheApuracVendas").modal("hide"),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}),r(!0)}).then(a=>{}).catch(a=>{})}catch(a){return $("#PopModalDetalheApuracVendas").modal("hide"),void fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}$(document).ready(function(){$("#MnPrincApuracao").addClass("active open"),fLimparAreaAlertaPrinc(),fLimparAreaAlertaModalCad(),fLimparAreaAlertaModalExc()});