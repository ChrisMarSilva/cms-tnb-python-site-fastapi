function fMostrarEsconderValores(){$(".DivTextValor").toggle(),$(".DivIconeValor").toggle()}async function iniciarAnimacaoPesquisar(){promise=new Promise((a,t)=>{a(!0),$("#iRefresh").addClass("fa-spin"),$("#btnPortAtualizarPag").addClass("disabled")}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}async function finalizarAnimacaoPesquisa(){promise=new Promise((a,t)=>{a(!0),$("#iRefresh").removeClass("fa-spin"),$("#btnPortAtualizarPag").removeClass("disabled")}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}function fGetAbaIdPortfolio(){var a="";return $("#TabPortfolios li a").each(function(){1==$(this).hasClass("active")&&(a=$(this).attr("id"))}),a=(a=(a=(a=(a=(a=a.replace("AbaPortfolioAcoes","")).replace("AbaPortfolioFundos","")).replace("AbaPortfolioIndices","")).replace("AbaPortfolioBdrs","")).replace("AbaPortfolio","")).replace("Aba","")}function fGetAbaTipoPortfolio(){var a="";return $("#TabPortfolios li a").each(function(){1==$(this).hasClass("active")&&(a=$(this).attr("id"))}),"AbaPortfolioAcoes"==a?"ACAO":"AbaPortfolioFundos"==a?"FII":"AbaPortfolioIndices"==a?"ETF":"AbaPortfolioBdrs"==a?"BDR":""}async function fAbrirModalGraficoPortfolio(a,t){try{promise=new Promise((a,e)=>{new TradingView.widget({container_id:"DivGraficoProtfTradingView",customer:"bovespa",width:"100%",height:"500px",symbol:t,interval:"D",timezone:"America/Sao_Paulo",locale:"br",theme:"Light",style:"1",toolbar_bg:"#f1f3f6",enable_publishing:!1,allow_symbol_change:!0,gridLineColor:"#E9E9EA",fontColor:"#83888D",underLineColor:"#dbeffb",trendLineColor:"#4bafe9",activeTickerBackgroundColor:"#EDF0F3",details:!1,withdateranges:!0,hide_side_toolbar:!0,withdateranges:!0}),$("#PopModalGraficoPortfolio").modal({backdrop:"static"}),a(!0)}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fLimparSomenteGrid(a){try{promise=new Promise((a,t)=>{a(!0),$("th").addClass("text-center"),$("#Grid").dataTable().fnClearTable(),$("#Grid").dataTable({bDestroy:!0}).fnDestroy(),$("#Grid").DataTable({oLanguage:fTraduzirGrid(),aoColumns:[{bSortable:!0,bOrderable:!0,sWidth:"40px",targets:0},{bSortable:!0,bOrderable:!0,sWidth:"100px",targets:1},{bSortable:!0,bOrderable:!0,sWidth:"100px",targets:2},{bSortable:!0,bOrderable:!0,sWidth:"100px",targets:3},{bSortable:!0,bOrderable:!0,sWidth:"100px",targets:4},{bSortable:!0,bOrderable:!0,sWidth:"120px",targets:5},{bSortable:!0,bOrderable:!0,sWidth:"120px",targets:6},{bSortable:!0,bOrderable:!0,sWidth:"120px",targets:7},{bSortable:!0,bOrderable:!0,sWidth:"50px",targets:8},{bSortable:!0,bOrderable:!0,sWidth:"120px",targets:9},{bSortable:!0,bOrderable:!0,sWidth:"20px",targets:10},{visible:!1,targets:11},{visible:!1,targets:12},{visible:!1,targets:13},{bSortable:!1,bOrderable:!1,sWidth:"10px",targets:14}],order:[],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!0,bSortable:!0,bAutoWidth:!1,bPaginate:!1,bOrdering:!0})}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fLimparPagina(a){promise=new Promise((t,e)=>{t(!0),fLimparAreaAlerta("AreaAlertaPrinc"),fLimparAreaAlerta("AreaAlertaModalCad"),fLimparAreaAlerta("AreaAlertaModalExc"),$("#btnPortAddAtivo").hide(),$("#btnPortAltPortfolio").hide(),$("#btnPortExcPortfolio").hide(),$("#btnPortAddPortfolio").show(),$("#DivPortTotInvest").html("R$ 0,00"),$("#DivPortTotAtual").html("R$ 0,00"),$("#DivPortValorizacao").html("R$ 0,00 <small><em>( 0,00% )</em></small>"),$("#DivPortRendimento").html("R$ 0,00"),$("#DivPortAluguel").html("R$ 0,00"),$("#DivPortGanhoPerda").html("R$ 0,00 <small><em>( 0,00% )</em></small>"),$("#DivPortIbovPreco").html("0,00 pts"),$("#DivPortIbovValoriz").html("0,00 <em>( 0,00% )</em></small>"),$("#DivPortValorizacao").addClass("text-muted"),$("#DivPortValorizacao").removeClass("text-success"),$("#DivPortValorizacao").removeClass("text-danger"),$("#DivPortGanhoPerda").addClass("text-muted"),$("#DivPortGanhoPerda").removeClass("text-success"),$("#DivPortGanhoPerda").removeClass("text-danger"),$("#DivPortIbovValoriz").addClass("text-muted"),$("#DivPortIbovValoriz").removeClass("text-success"),$("#DivPortIbovValoriz").removeClass("text-danger"),$("#DivGraficoPortGeral").html(""),$("#DivGridPortfPercent").html(""),$("#ListaValDia").html(""),$("#ListaValDiaTotal").html(""),$("#DivGraficoPortCarteira").html(""),$("#DivGraficoPortValorLucroPrejuizo").html(""),$("#DivGraficoPortPercLucroPrejuizo").html(""),$("#DivGraficoPortProventos").html(""),$("#DivGraficoAtivos").html(""),$("#DivGraficoSetores").html(""),$("#DivGraficoSubSetores").html(""),$("#DivGraficoSegmentos").html(""),$("#DivGridAtivoSetor").html(""),fLimparSomenteGrid(a)}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}async function fMontarTotalizadores(a,t,e,r,o,i,l,s,n){try{promise=new Promise((a,d)=>{a(!0),$("#DivPortTotInvest").html("R$ "+fMascaraValor(t)),$("#DivPortTotAtual").html("R$ "+fMascaraValor(e)),$("#DivPortValorizacao").html("R$ "+fMascaraValor(r)+" <small><em>( "+fMascaraValor(o)+"% )</em></small>"),$("#DivPortRendimento").html("R$ "+fMascaraValor(i)),$("#DivPortAluguel").html("R$ "+fMascaraValor(l)),$("#DivPortGanhoPerda").html("R$ "+fMascaraValor(s)+" <small><em>( "+fMascaraValor(n)+"% )</em></small>"),$("#DivPortValorizacao").removeClass("text-muted"),r>0&&$("#DivPortValorizacao").addClass("text-success"),r<0&&$("#DivPortValorizacao").addClass("text-danger"),0==r&&$("#DivPortValorizacao").addClass("text-muted"),$("#DivPortGanhoPerda").removeClass("text-muted"),s>0&&$("#DivPortGanhoPerda").addClass("text-success"),s<0&&$("#DivPortGanhoPerda").addClass("text-danger"),0==s&&$("#DivPortGanhoPerda").addClass("text-muted")}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGridPercentualAtivos(a,t,e,r){try{promise=new Promise((a,o)=>{a(!0);var l=$("#DivGridPortfPercent");l.html("");var s=t.length,n=[],d=0,c=0;for(i=0;i<s;i++)d+=parseFloat(e[i]),c+=parseFloat(r[i]),n.push({Codigo:t[i],ValorInvest:e[i],PercentInvest:0,ValorAtual:r[i],PercentAtual:0});for(i=0;i<s;i++){var p=parseFloat(n[i].ValorInvest),f=parseFloat(n[i].PercentInvest),b=parseFloat(n[i].ValorAtual),h=parseFloat(n[i].PercentAtual);p>0&&d>0&&(f=p/d*100),b>0&&c>0&&(h=b/c*100),n[i].PercentInvest=f,n[i].PercentAtual=h}n.sort(function(a,t){var e=parseFloat(a.PercentAtual),r=parseFloat(t.PercentAtual);return e==r?0:e>r?1:-1}),n.reverse();var m="";for(m+='<table style="font-size: 12px;" class="table table-sm table-hover table-bord ered table-condensed nowrap" cellspacing="0" width="100%">',m+="  <thead>",m+='    <tr class="thead-dark font-weight-bold text-center"> ',m+='      <th title="Código do Ativo">Ativo</th> ',m+='      <th title="Percentual Atual do Ativo no Portfólio">% Carteira</th> ',m+="    </tr>",m+="   </thead>",m+="  <tbody>",i=0;i<s;i++){var A=n[i].Codigo;f=parseFloat(n[i].PercentInvest),h=parseFloat(n[i].PercentAtual);m+='    <tr class="text-center"> ',m+='      <td> <a href="https://www.google.com.br/search?q='+A+'" target="_blank"> <span class="text-dark font-weight-bold">'+A+"</span></a> </td>",m+='      <td> <span class="text-dark font-weight-bold"> '+fMascaraValor(h)+"% </span> </td>",m+="    </tr>"}m+="  </tbody>",m+="  <tfoot> </tfoot>",m+="</table>",l.html(""),l.append(m)}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGraficoCarteiraGeral(a,t,e,r,o){try{promise=new Promise((a,i)=>{a(!0),Highcharts.setOptions({global:{useUTC:!1},lang:{decimalPoint:",",thousandsSep:"."}}),Highcharts.chart("DivGraficoPortGeral",{lang:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],weekdays:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],loading:["Atualizando o gráfico...aguarde"],contextButtonTitle:"Exportar gráfico",decimalPoint:",",thousandsSep:".",viewFullscreen:"Exibir em tela cheia",openInCloud:"Abri em Highcharts Cloud",downloadJPEG:"Baixar imagem JPEG",downloadPDF:"Baixar arquivo PDF",downloadPNG:"Baixar imagem PNG",downloadSVG:"Baixar vetor SVG",printChart:"Imprimir gráfico",rangeSelectorFrom:"De",rangeSelectorTo:"Para",rangeSelectorZoom:"Zoom",resetZoom:"Limpar Zoom",resetZoomTitle:"Voltar Zoom para nível 1:1"},exporting:{enabled:!1},data:{table:"datatable"},chart:{type:"column"},title:{text:null},legend:{enabled:!1},xAxis:{categories:[""],title:{text:null},labels:{enabled:!0,y:20,rotation:-45,align:"right"}},yAxis:{allowDecimals:!1,title:{text:null}},colors:["#2f7ed8","#8bbc21","#492970","#f28f43"],credits:{enabled:!1},tooltip:{pointFormatter:function(){var a=Number(this.y).toFixed(2).replace(/./g,function(a,t,e){return t>0&&"."!==a&&(e.length-t)%3==0?"X"+a:a}).replace(".",",").replace(/X/g,".");return'<span style="color:'+this.series.color+'">'+this.series.name+"</span>: <b>R$ "+a+"</b><br />"},shared:!0},series:[{name:"Tot. Investido",data:[t]},{name:"Tot. Atual",data:[e]},{name:"Total Valorização",data:[e-t]},{name:"Tot. Proventos",data:[r+o]}]})}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGraficoCarteiraAtivos(a,t,e,r,o,l){try{promise=new Promise((a,s)=>{a(!0);var n=t.length,d=[];for(i=0;i<n;i++)d.push({Codigo:t[i],ValInvest:e[i],ValAtual:r[i],ValValoriz:o[i],ValRenb:l[i]});d.sort(function(a,t){var e=a.Codigo,r=t.Codigo;return e==r?0:e>r?1:-1});var c=[],p=[],f=[],b=[],h=[];for(i=0;i<n;i++)c[i]=d[i].Codigo,p[i]=d[i].ValInvest,f[i]=d[i].ValAtual,b[i]=d[i].ValValoriz,h[i]=d[i].ValRenb;Highcharts.chart("DivGraficoPortCarteira",{lang:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],weekdays:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],loading:["Atualizando o gráfico...aguarde"],contextButtonTitle:"Exportar gráfico",decimalPoint:",",thousandsSep:".",viewFullscreen:"Exibir em tela cheia",openInCloud:"Abri em Highcharts Cloud",downloadJPEG:"Baixar imagem JPEG",downloadPDF:"Baixar arquivo PDF",downloadPNG:"Baixar imagem PNG",downloadSVG:"Baixar vetor SVG",printChart:"Imprimir gráfico",rangeSelectorFrom:"De",rangeSelectorTo:"Para",rangeSelectorZoom:"Zoom",resetZoom:"Limpar Zoom",resetZoomTitle:"Voltar Zoom para nível 1:1"},data:{table:"datatable"},chart:{type:"column"},title:{text:null},legend:{enabled:!0,align:"center",verticalAlign:"top",floating:!0,backgroundColor:Highcharts.defaultOptions.legend.backgroundColor||"white",borderColor:"#CCC",borderWidth:1,shadow:!1},xAxis:{categories:c},colors:["#2f7ed8","#8bbc21","#492970","#f28f43"],yAxis:{allowDecimals:!1,title:{text:null}},credits:{enabled:!1},tooltip:{pointFormatter:function(){var a=Number(this.y).toFixed(2).replace(/./g,function(a,t,e){return t>0&&"."!==a&&(e.length-t)%3==0?"X"+a:a}).replace(".",",").replace(/X/g,".");return'<span style="color:'+this.series.color+'">'+this.series.name+"</span>: <b>R$ "+a+"</b><br />"},shared:!0},series:[{name:"Total Investido",data:p},{name:"Total Atual",data:f},{name:"Total Valorização",data:b},{name:"Total Proventos",data:h}]})}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGraficoTotalValorizacao(a,t,e){try{promise=new Promise((a,r)=>{a(!0);var o=t.length,l=[];for(i=0;i<o;i++)l.push({Codigo:t[i],ValValoriz:e[i]});l.sort(function(a,t){var e=parseFloat(a.ValValoriz),r=parseFloat(t.ValValoriz);return e==r?0:e>r?1:-1}),l.reverse();var s=[],n=[],d=[];for(i=0;i<o;i++)s[i]=l[i].Codigo,n[i]=l[i].ValValoriz>0?l[i].ValValoriz:0,d[i]=l[i].ValValoriz<0?l[i].ValValoriz:0;Highcharts.chart("DivGraficoPortValorLucroPrejuizo",{lang:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],weekdays:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],loading:["Atualizando o gráfico...aguarde"],contextButtonTitle:"Exportar gráfico",decimalPoint:",",thousandsSep:".",viewFullscreen:"Exibir em tela cheia",openInCloud:"Abri em Highcharts Cloud",downloadJPEG:"Baixar imagem JPEG",downloadPDF:"Baixar arquivo PDF",downloadPNG:"Baixar imagem PNG",downloadSVG:"Baixar vetor SVG",printChart:"Imprimir gráfico",rangeSelectorFrom:"De",rangeSelectorTo:"Para",rangeSelectorZoom:"Zoom",resetZoom:"Limpar Zoom",resetZoomTitle:"Voltar Zoom para nível 1:1"},data:{table:"datatable"},chart:{type:"column"},title:{text:null},legend:{enabled:!0,align:"center",verticalAlign:"top",floating:!0,backgroundColor:Highcharts.defaultOptions.legend.backgroundColor||"white",borderColor:"#CCC",borderWidth:1,shadow:!1},xAxis:{categories:s},yAxis:{allowDecimals:!1,title:{text:null}},credits:{enabled:!1},tooltip:{pointFormatter:function(){var a=Number(this.y).toFixed(2).replace(/./g,function(a,t,e){return t>0&&"."!==a&&(e.length-t)%3==0?"X"+a:a}).replace(".",",").replace(/X/g,".");return'<span style="color:'+this.series.color+'">'+this.series.name+"</span>: <b>R$ "+a+"</b><br />"},shared:!1},series:[{name:"Total Valorização",data:n,color:"#8bbc21"},{name:"Total Desvalorização",data:d,color:"#c42525"}]})}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGraficoPercentualValorizacao(a,t,e){try{promise=new Promise((a,r)=>{a(!0);var o=t.length,l=[];for(i=0;i<o;i++)l.push({Codigo:t[i],PercValoriz:e[i]});l.sort(function(a,t){var e=parseFloat(a.PercValoriz),r=parseFloat(t.PercValoriz);return e==r?0:e>r?1:-1}),l.reverse();var s=[],n=[],d=[];for(i=0;i<o;i++)s[i]=l[i].Codigo,n[i]=l[i].PercValoriz>0?l[i].PercValoriz:0,d[i]=l[i].PercValoriz<0?l[i].PercValoriz:0;Highcharts.chart("DivGraficoPortPercLucroPrejuizo",{lang:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],weekdays:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],loading:["Atualizando o gráfico...aguarde"],contextButtonTitle:"Exportar gráfico",decimalPoint:",",thousandsSep:".",viewFullscreen:"Exibir em tela cheia",openInCloud:"Abri em Highcharts Cloud",downloadJPEG:"Baixar imagem JPEG",downloadPDF:"Baixar arquivo PDF",downloadPNG:"Baixar imagem PNG",downloadSVG:"Baixar vetor SVG",printChart:"Imprimir gráfico",rangeSelectorFrom:"De",rangeSelectorTo:"Para",rangeSelectorZoom:"Zoom",resetZoom:"Limpar Zoom",resetZoomTitle:"Voltar Zoom para nível 1:1"},data:{table:"datatable"},chart:{type:"column"},title:{text:null},legend:{enabled:!0,align:"center",verticalAlign:"top",floating:!0,backgroundColor:Highcharts.defaultOptions.legend.backgroundColor||"white",borderColor:"#CCC",borderWidth:1,shadow:!1},xAxis:{categories:s},yAxis:{allowDecimals:!1,title:{text:null}},credits:{enabled:!1},tooltip:{headerFormat:"<b>{point.x}</b><br/>",pointFormat:"{series.name}: {point.y:.2f}%"},series:[{name:"% Valorização",data:n,color:"#8bbc21"},{name:"% Desvalorização",data:d,color:"#c42525"}]})}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGraficoTotalProventos(a,t,e){try{promise=new Promise((a,r)=>{a(!0);var o=t.length,l=[];for(i=0;i<o;i++)l.push({Codigo:t[i],ValProvento:e[i]});l.sort(function(a,t){var e=parseFloat(a.ValProvento),r=parseFloat(t.ValProvento);return e==r?0:e>r?1:-1}),l.reverse();var s=[],n=[];for(i=0;i<o;i++)s[i]=l[i].Codigo,n[i]=l[i].ValProvento;Highcharts.chart("DivGraficoPortProventos",{lang:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],weekdays:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],loading:["Atualizando o gráfico...aguarde"],contextButtonTitle:"Exportar gráfico",decimalPoint:",",thousandsSep:".",viewFullscreen:"Exibir em tela cheia",openInCloud:"Abri em Highcharts Cloud",downloadJPEG:"Baixar imagem JPEG",downloadPDF:"Baixar arquivo PDF",downloadPNG:"Baixar imagem PNG",downloadSVG:"Baixar vetor SVG",printChart:"Imprimir gráfico",rangeSelectorFrom:"De",rangeSelectorTo:"Para",rangeSelectorZoom:"Zoom",resetZoom:"Limpar Zoom",resetZoomTitle:"Voltar Zoom para nível 1:1"},data:{table:"datatable"},chart:{type:"column"},title:{text:null},legend:{enabled:!0,align:"center",verticalAlign:"top",floating:!0,backgroundColor:Highcharts.defaultOptions.legend.backgroundColor||"white",borderColor:"#CCC",borderWidth:1,shadow:!1},xAxis:{categories:s},yAxis:{allowDecimals:!1,title:{text:null}},credits:{enabled:!1},tooltip:{pointFormatter:function(){var a=Number(this.y).toFixed(2).replace(/./g,function(a,t,e){return t>0&&"."!==a&&(e.length-t)%3==0?"X"+a:a}).replace(".",",").replace(/X/g,".");return'<span style="color:'+this.series.color+'">'+this.series.name+"</span>: <b>R$ "+a+"</b><br />"},shared:!0},series:[{name:"Total Proventos",data:n}]})}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGraficoPesoAtivos(a,t,e){try{promise=new Promise((a,r)=>{a(!0);var o=t.length,l=[];for(i=0;i<o;i++)parseFloat(e[i]),l.push({Codigo:t[i],ValorAtual:e[i]});l.sort(function(a,t){var e=parseFloat(a.ValorAtual),r=parseFloat(t.ValorAtual);return e==r?0:e>r?1:-1}),l.reverse();var s=[];for(i=0;i<o;i++)s[i]={name:l[i].Codigo,y:parseFloat(l[i].ValorAtual),sliced:0==i,selected:0==i};Highcharts.chart("DivGraficoAtivos",{lang:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],weekdays:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],loading:["Atualizando o gráfico...aguarde"],contextButtonTitle:"Exportar gráfico",decimalPoint:",",thousandsSep:".",viewFullscreen:"Exibir em tela cheia",openInCloud:"Abri em Highcharts Cloud",downloadJPEG:"Baixar imagem JPEG",downloadPDF:"Baixar arquivo PDF",downloadPNG:"Baixar imagem PNG",downloadSVG:"Baixar vetor SVG",printChart:"Imprimir gráfico",rangeSelectorFrom:"De",rangeSelectorTo:"Para",rangeSelectorZoom:"Zoom",resetZoom:"Limpar Zoom",resetZoomTitle:"Voltar Zoom para nível 1:1"},chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},title:{text:"Ativos"},tooltip:{pointFormatter:function(){return"Total: <b>R$ "+Number(this.y).toFixed(2).replace(/./g,function(a,t,e){return t>0&&"."!==a&&(e.length-t)%3==0?"X"+a:a}).replace(".",",").replace(/X/g,".")+"</b> <br> Percent.: <b>"+Number(this.percentage).toFixed(2)+"%</b> "},shared:!0},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.2f} %"}}},series:[{name:"Ativos",colorByPoint:!0,data:s}]})}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGraficoPesoSetores(a,t,e){try{promise=new Promise((a,r)=>{a(!0);var o=[];for(var l in e)parseFloat(e[l]),o.push({Codigo:t[l],ValorAtual:e[l]});o.sort(function(a,t){var e=parseFloat(a.ValorAtual),r=parseFloat(t.ValorAtual);return e==r?0:e>r?1:-1}),o.reverse();var s=o.length,n=[];for(i=0;i<s;i++)n[i]={name:o[i].Codigo,y:parseFloat(o[i].ValorAtual),sliced:0==i,selected:0==i};Highcharts.chart("DivGraficoSetores",{lang:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],weekdays:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],loading:["Atualizando o gráfico...aguarde"],contextButtonTitle:"Exportar gráfico",decimalPoint:",",thousandsSep:".",viewFullscreen:"Exibir em tela cheia",openInCloud:"Abri em Highcharts Cloud",downloadJPEG:"Baixar imagem JPEG",downloadPDF:"Baixar arquivo PDF",downloadPNG:"Baixar imagem PNG",downloadSVG:"Baixar vetor SVG",printChart:"Imprimir gráfico",rangeSelectorFrom:"De",rangeSelectorTo:"Para",rangeSelectorZoom:"Zoom",resetZoom:"Limpar Zoom",resetZoomTitle:"Voltar Zoom para nível 1:1"},chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},title:{text:"Setores"},tooltip:{pointFormatter:function(){return"Total: <b>R$ "+Number(this.y).toFixed(2).replace(/./g,function(a,t,e){return t>0&&"."!==a&&(e.length-t)%3==0?"X"+a:a}).replace(".",",").replace(/X/g,".")+"</b> <br> Percent.: <b>"+Number(this.percentage).toFixed(2)+"%</b> "},shared:!0},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.2f} %"}}},series:[{name:"Setores",colorByPoint:!0,data:n}]})}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGraficoPesoSubSetores(a,t,e){try{promise=new Promise((a,r)=>{a(!0);var o=[];for(var l in e)parseFloat(e[l]),o.push({Codigo:t[l],ValorAtual:e[l]});o.sort(function(a,t){var e=parseFloat(a.ValorAtual),r=parseFloat(t.ValorAtual);return e==r?0:e>r?1:-1}),o.reverse();var s=o.length,n=[];for(i=0;i<s;i++)n[i]={name:o[i].Codigo,y:parseFloat(o[i].ValorAtual),sliced:0==i,selected:0==i};Highcharts.chart("DivGraficoSubSetores",{lang:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],weekdays:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],loading:["Atualizando o gráfico...aguarde"],contextButtonTitle:"Exportar gráfico",decimalPoint:",",thousandsSep:".",viewFullscreen:"Exibir em tela cheia",openInCloud:"Abri em Highcharts Cloud",downloadJPEG:"Baixar imagem JPEG",downloadPDF:"Baixar arquivo PDF",downloadPNG:"Baixar imagem PNG",downloadSVG:"Baixar vetor SVG",printChart:"Imprimir gráfico",rangeSelectorFrom:"De",rangeSelectorTo:"Para",rangeSelectorZoom:"Zoom",resetZoom:"Limpar Zoom",resetZoomTitle:"Voltar Zoom para nível 1:1"},chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},title:{text:"Sub-Setores"},tooltip:{pointFormatter:function(){return"Total: <b>R$ "+Number(this.y).toFixed(2).replace(/./g,function(a,t,e){return t>0&&"."!==a&&(e.length-t)%3==0?"X"+a:a}).replace(".",",").replace(/X/g,".")+"</b> <br> Percent.: <b>"+Number(this.percentage).toFixed(2)+"%</b> "},shared:!0},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.2f} %"}}},series:[{name:"SubSetores",colorByPoint:!0,data:n}]})}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGraficoPesoSegmentos(a,t,e){try{promise=new Promise((a,r)=>{a(!0);var o=[];for(var l in e)parseFloat(e[l]),o.push({Codigo:t[l],ValorAtual:e[l]});o.sort(function(a,t){var e=parseFloat(a.ValorAtual),r=parseFloat(t.ValorAtual);return e==r?0:e>r?1:-1}),o.reverse();var s=o.length,n=[];for(i=0;i<s;i++)n[i]={name:o[i].Codigo,y:parseFloat(o[i].ValorAtual),sliced:0==i,selected:0==i};Highcharts.chart("DivGraficoSegmentos",{lang:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],weekdays:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],loading:["Atualizando o gráfico...aguarde"],contextButtonTitle:"Exportar gráfico",decimalPoint:",",thousandsSep:".",viewFullscreen:"Exibir em tela cheia",openInCloud:"Abri em Highcharts Cloud",downloadJPEG:"Baixar imagem JPEG",downloadPDF:"Baixar arquivo PDF",downloadPNG:"Baixar imagem PNG",downloadSVG:"Baixar vetor SVG",printChart:"Imprimir gráfico",rangeSelectorFrom:"De",rangeSelectorTo:"Para",rangeSelectorZoom:"Zoom",resetZoom:"Limpar Zoom",resetZoomTitle:"Voltar Zoom para nível 1:1"},chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},title:{text:"Segmentos"},tooltip:{pointFormatter:function(){return"Total: <b>R$ "+Number(this.y).toFixed(2).replace(/./g,function(a,t,e){return t>0&&"."!==a&&(e.length-t)%3==0?"X"+a:a}).replace(".",",").replace(/X/g,".")+"</b> <br> Percent.: <b>"+Number(this.percentage).toFixed(2)+"%</b> "},shared:!0},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.2f} %"}}},series:[{name:"Segmentos",colorByPoint:!0,data:n}]})}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGridSetores(a,t,e,r,o,i,l,s){try{promise=new Promise((a,n)=>{a(!0);var d=$("#DivGridAtivoSetor");d.html("");var c="";c+='<table border="0" class="table table-sm table-b ordered table-h over table-s triped " style="font-size: 13px;">',c+='<thead class="thead-dark"> ',c+='<tr style="width: 5px;" class="text-center"> ',c+='<th style="width: 5px;">Setor</th>',c+='<th style="width: 5px;">Total</th>',c+='<th style="width: 5px;">%</th> ',c+='<th style="width: 5px;">Sub-Setor</th>',c+='<th style="width: 5px;">Total</th>',c+='<th style="width: 5px;">%</th> ',c+='<th style="width: 5px;">Segmento</th>',c+='<th style="width: 5px;">Total</th>',c+='<th style="width: 5px;">%</th> ',c+='<th style="width: 5px;">Ativo</th> ',c+='<th style="width: 5px;">Total</th>',c+='<th style="width: 5px;">%</th> ',c+="</tr> ",c+="</thead>",c+='<tbody class="text-center">';var p="";if(DataSetPagina&&DataSetPagina.data&&DataSetPagina.data.Lista){var f=DataSetPagina.data.Lista;if(f.length>0){var b=fGetAbaIdPortfolio(),h=fGetAbaTipoPortfolio(),m="",A="",u="";$.each(f,function(a,n){var d=n.CartId,c=n.AtvTipoInvest;if(!(""!=b&&b!=d||""!=h&&"ACAO"!=h||"ACAO"!=c)){var f=n.SetorId,g=n.SubSetorId,x=n.SegmentoId,P=n.AtvCodigo,v=parseFloat(GetValorDecimal(n.AtvTotAtual));if(m!=f&&(p+='<tr class="bg-light"> ',p+='<td style="border-top: 1px solid black;" colspan="12"> </td> ',p+="</tr>"),p+='<tr style="border: 1px solid black; font-size: 11px;"> ',""==m||m!=f){var w=e[f],R=r[f],y=t>0&&R>0?R/t*100:0;p+='<td style="border-top: 1px solid black; border-left: 1px solid black;" rowspan="'+w+'" class="font-weight-bold">'+n.SetorNome+"</td>  ",p+='<td style="border-bottom: 1px solid black;" rowspan="'+w+'">R$ '+fMascaraValor(parseFloat(R))+"</td> ",p+='<td style="border-bottom: 1px solid black;" rowspan="'+w+'" class="font-weight-bold">'+fMascaraValor(parseFloat(y))+"%</td>",m=f}if(""==A||A!=g){var T=o[f+"-"+g],S=i[f+"-"+g],E=t>0&&S>0?S/t*100:0;p+='<td rowspan="'+T+'" class="font-weight-bold">'+n.SubSetorNome+"</td>",p+='<td rowspan="'+T+'">R$ '+fMascaraValor(parseFloat(S))+"</td> ",p+='<td rowspan="'+T+'" class="font-weight-bold">'+fMascaraValor(parseFloat(E))+"%</td>",A=g}if(""==u||u!=x){var V=l[f+"-"+g+"-"+x],G=s[f+"-"+g+"-"+x],_=t>0&&G>0?G/t*100:0;p+='<td rowspan="'+V+'" class="font-weight-bold">'+n.SegmentoNome+"</td>",p+='<td rowspan="'+V+'">R$ '+fMascaraValor(parseFloat(G))+"</td> ",p+='<td rowspan="'+V+'" class="font-weight-bold">'+fMascaraValor(parseFloat(_))+"%</td>",u=x}var C=t>0&&v>0?v/t*100:0;p+='<td rowspan="1" class="font-weight-bold">'+P+"</td>  ",p+='<td rowspan="1">R$ '+fMascaraValor(parseFloat(v))+"</td> ",p+='<td rowspan="1" class="font-weight-bold">'+fMascaraValor(parseFloat(C))+"%</td>",p+="</tr>"}})}}""!=p?(c+=p,c+='<tr class="bg-light"> ',c+='<td style="border-top: 1px solid black;" colspan="12"> </td> ',c+="</tr>",c+="</tbody>",c+='<tfoot class="thead-dark" style="font-size: 13px;"> ',c+='<tr class="text-center"> ',c+="<th>Setor</th>",c+='<th colspan="2">R$ '+fMascaraValor(parseFloat(t))+"</th>",c+="<th>Sub-Setor</th>",c+='<th colspan="2">R$ '+fMascaraValor(parseFloat(t))+"</th>",c+="<th>Segmento</th>",c+='<th colspan="2">R$ '+fMascaraValor(parseFloat(t))+"</th>",c+="<th>Ativo</th> ",c+='<th colspan="2">R$ '+fMascaraValor(parseFloat(t))+"</th>",c+="</tr> ",c+="</tfoot>",c+="</table>"):c="",d.html(""),d.append(c)}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGridValorizacaoDia(a,t){try{promise=new Promise((e,r)=>{e(!0);var o=$("#ListaValDia"),i=$("#ListaValDiaTotal");o.html(""),i.html("");var l=0,s="";s+='<table id="GridValDia" border="0" class="table table-sm table-hover table-condensed nowrap" cellspacing="0" width="100%">',s+="  <tbody>",t.length>0&&(t.sort(function(a,t){var e=parseFloat(GetValorDecimal(a.VlrValorizDia)),r=parseFloat(GetValorDecimal(a.PercValorizDia)),o=parseFloat(GetValorDecimal(t.VlrValorizDia)),i=parseFloat(GetValorDecimal(t.PercValorizDia));return e<0&&r>0&&(r*=-1),o<0&&i>0&&(i*=-1),r==i?0:r>i?1:-1}),t.reverse(),$.each(t,function(t,e){var r=e.Codigo,o=parseFloat(GetValorInteiro(e.Quant)),i=parseFloat(GetValorDecimal(e.PrecoAtual)),n=parseFloat(GetValorDecimal(e.VlrValorizDia)),d=parseFloat(GetValorDecimal(e.PercValorizDia)),c=0;0!=n&&(c=o*n),l+=c,s+='    <tr class="text-center"> ',c>0&&(s+='      <td style="width:40px"> <i class="fa fa-arrow-up faa-bounce ani mated text-success">  </i> <a href="https://www.google.com.br/search?q='+r+'" target="_blank"> <span class="text-success font-weight-bold" style="font-size: 12px;" >'+r+"</span></a> </td>"),0==c&&(s+='      <td style="width:40px"> <i class="fa fa-arrow-right faa-flash ani mated text-primary"></i> <a href="https://www.google.com.br/search?q='+r+'" target="_blank"> <span class="text-primary font-weight-bold" style="font-size: 12px;" >'+r+"</span></a> </td>"),c<0&&(s+='      <td style="width:40px"> <i class="fa fa-arrow-down faa-bounce ani mated text-danger" ></i> <a href="https://www.google.com.br/search?q='+r+'" target="_blank"> <span class="text-danger  font-weight-bold" style="font-size: 12px;" >'+r+"</span></a> </td>"),s+='      <td style="width:50px"> <span class="text-dark  font-weigh t-bold" style="font-size: 12px;">  R$ '+fMascaraValor(i)+"</span></td>",c>0&&(s+='      <td style="width:80px"> <span class="text-success" style="font-size: 12px;"> +'+fMascaraValor(n)+'</span> <span class="text-success font-weight-bold" style="font-size: 12px;"> ('+fMascaraValor(d)+"%)</span> </td>",s+='      <td style="width:80px"> <span class="badge badge-success badge-pill font-weight-bold" style="font-size: 12px;"> +'+fMascaraValor(c)+" </span> </td>"),0==c&&(s+='      <td style="width:80px"> <span class="text-primary" style="font-size: 12px;"> '+fMascaraValor(n)+'</span> <span class="text-primary font-weight-bold" style="font-size: 12px;"> ('+fMascaraValor(d)+"%)</span> </td>",s+='      <td style="width:80px"> <span class="badge badge-primary badge-pill font-weight-bold" style="font-size: 12px;"> '+fMascaraValor(c)+" </span> </td>"),c<0&&(s+='      <td style="width:80px"> <span class="text-danger" style="font-size: 12px;"> '+fMascaraValor(n)+'</span> <span class="text-danger font-weight-bold" style="font-size: 12px;"> ('+fMascaraValor(d)+"%)</span> </td>",s+='      <td style="width:80px"> <span class="badge badge-danger  badge-pill font-weight-bold" style="font-size: 12px;"> '+fMascaraValor(c)+" </span> </td>"),s+='      <td style="width:10px">',s+='         <a class="btn btn-sm btn-success btn-icon btn-icon-mini btn-round btn-simple" style="height: 1.6rem; min-width: 1.6rem; width: 1.6rem; margin: 1px 1px; font-size:0.3rem; " title="Comprar Ativo '+r+'" href="javascript:void(0);" role="button" aria-pressed="true" ',s+="            onclick=\"fAbrirModalDetalheOper( '"+a+"', '', 'Novo', 'C', '"+r+"', '100', '"+fMascaraValor(i)+'\' );"> <i class="fa fa-plus-square" aria-hidden="true"></i> ',s+="         </a>",s+='         <a class="btn btn-sm btn-danger btn-icon btn-icon-mini btn-round btn-simple" style="height: 1.6rem; min-width: 1.6rem; width: 1.6rem; margin: 1px 1px; font-size:0.3rem; " title="Vender Ativo '+r+'" href="javascript:void(0);" role="button" aria-pressed="true" ',s+="            onclick=\"fAbrirModalDetalheOper( '"+a+"', '', 'Novo', 'V', '"+r+"', '"+o+"', '"+fMascaraValor(i)+'\' );"> <i class="fa fa-minus-square" aria-hidden="true"></i> ',s+="         </a>",s+='         <a class="btn btn-sm btn-dark btn-icon btn-icon-mini btn-round btn-simple" style="height: 1.6rem; min-width: 1.6rem; width: 1.6rem; margin: 1px 1px; font-size:0.3rem; " title="Gráfico do Ativo '+r+'" href="javascript:void(0);" role="button" aria-pressed="true" ',s+="            onclick=\"fAbrirModalGraficoPortfolio( '"+a+"','"+r+'\' );"> <i class="fa fa-area-chart" aria-hidden="true"></i> ',s+="         </a>",s+="      </td>",s+="    </tr>"})),s+="  </tbody>",s+="</table>",o.html(""),o.append(s),s="",s+='<table border="0" style="border: 0px solid black;  font-size: 14px" class="table table-sm table-condensed nowrap" cellspacing="0" width="100%">',s+='  <tbody style="border: 0px solid black; ">',s+='    <tr bgcolor="#e9ecef" style="border: 0px solid black; " class="text-white text-center"> ',s+='      <td style="border: 0px solid black; width:20px">&nbsp;<span class="text-dark font-weight-bold" style="font-size: 14px;" >TOTAL</span> </td>',s+='      <td style="border: 0px solid black; width:50px">&nbsp;</td>',s+='      <td style="border: 0px solid black; width:50px">&nbsp;</td>',l>0&&(s+='      <td style="border: 0px solid black; width:70px"> <span class="badge badge-success badge-pill font-weight-bold" style="font-size: 14px;"> +'+fMascaraValor(l)+"</span> </td>"),0==l&&(s+='      <td style="border: 0px solid black; width:70px"> <span class="badge badge-primary badge-pill font-weight-bold" style="font-size: 14px;">  '+fMascaraValor(l)+"</span> </td>"),l<0&&(s+='      <td style="border: 0px solid black; width:70px"> <span class="badge badge-danger  badge-pill font-weight-bold" style="font-size: 14px;">  '+fMascaraValor(l)+"</span> </td>"),s+='      <td style="border: 0px solid black; width:80px">&nbsp;</td>',s+="    </tr>",s+="  </tbody>",s+="</table>",i.html(""),i.append(s)}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGridIndices(a){try{promise=new Promise((t,e)=>{t(!0);var r=$("#ListaIndice");r.html("");var o="";o+='<table class="table table-sm table-hover table-condensed nowrap" border="0" cellspacing="0" width="100%" style="margin: 0px;">',o+="  <tbody>";var i="",l="",s="",n="";if(DataSetRadar&&DataSetRadar.data&&DataSetRadar.data.Lista){var d=DataSetRadar.data.Lista;d.length>0&&$.each(d,function(t,e){var r=e[0],o=parseFloat(GetValorDecimal(e[1])),d=parseFloat(GetValorDecimal(e[2])),c=parseFloat(GetValorDecimal(e[3]));"IBOV"==r?(i+='    <tr class="text-center"> ',d>0&&(i+='      <td style="width:80px;"> \x3c!-- <i class="fa fa-arrow-up faa-bounce ani mated text-success">  </i> --\x3e <a href="https://www.google.com.br/search?q='+r+'" title="Índice Bovespa" target="_blank"> <span class="text-success font-weight-bold" style="font-size: 11px;" >'+r+"</span></a> </td>"),0==d&&(i+='      <td style="width:80px;"> \x3c!-- <i class="fa fa-arrow-right faa-flash ani mated text-primary"></i> --\x3e <a href="https://www.google.com.br/search?q='+r+'" title="Índice Bovespa" target="_blank"> <span class="text-primary font-weight-bold" style="font-size: 11px;" >'+r+"</span></a> </td>"),d<0&&(i+='      <td style="width:80px;"> \x3c!-- <i class="fa fa-arrow-down faa-bounce ani mated text-danger" ></i> --\x3e <a href="https://www.google.com.br/search?q='+r+'" title="Índice Bovespa" target="_blank"> <span class="text-danger  font-weight-bold" style="font-size: 11px;" >'+r+"</span></a> </td>"),i+='      <td> <span class="text-dark  font-weight-bold" style="width:10px; font-size: 11px;">  '+fMascaraValor(o)+" pts</span></td>",d>0&&(i+='      <td> <span class="font-weight-normal text-success" style="width:10px; font-size: 11px;"> +'+fMascaraValor(d)+'</span> <span class="font-weight-normal text-success font-weight-bold" style="font-size: 11px;"> ('+fMascaraValor(c)+"%)</span></td>"),0==d&&(i+='      <td> <span class="font-weight-normal text-primary" style="width:10px; font-size: 11px;"> '+fMascaraValor(d)+' </span> <span class="font-weight-normal text-primary font-weight-bold" style="font-size: 11px;"> ('+fMascaraValor(c)+"%)</span> </td>"),d<0&&(i+='      <td> <span class="font-weight-normal text-danger"  style="width:10px; font-size: 11px;"> '+fMascaraValor(d)+' </span> <span class="font-weight-normal text-danger font-weight-bold"  style="font-size: 11px;"> ('+fMascaraValor(c)+"%)</span> </td>"),i+='      <td style="width:10px">',i+='         <a class="btn btn-sm btn-dark btn-icon btn-icon-mini btn-round btn-simple" style="height: 1.2rem; min-width: 1.2rem; width: 1.2rem; margin: 1px 1px; font-size:0.3rem; " title="Gráfico do Ativo '+r+'" href="javascript:void(0);" role="button" aria-pressed="true" ',i+="            onclick=\"fAbrirModalGraficoPortfolio( '"+a+"','"+r+'\' );"> <i class="fa fa-area-chart" aria-hidden="true"></i> ',i+="         </a>",i+="      </td>",i+="    </tr>"):"IBXX"==r?(l+='    <tr class="text-center"> ',d>0&&(l+='      <td style="width:80px;"> \x3c!-- <i class="fa fa-arrow-up faa-bounce ani mated text-success">  </i> --\x3e <a href="https://www.google.com.br/search?q='+r+'" title="Índice Brasil 100" target="_blank"> <span class="text-success font-weight-bold" style="font-size: 11px;" >'+r+"</span></a> </td>"),0==d&&(l+='      <td style="width:80px;"> \x3c!-- <i class="fa fa-arrow-right faa-flash ani mated text-primary"></i> --\x3e <a href="https://www.google.com.br/search?q='+r+'" title="Índice Brasil 100" target="_blank"> <span class="text-primary font-weight-bold" style="font-size: 11px;" >'+r+"</span></a> </td>"),d<0&&(l+='      <td style="width:80px;"> \x3c!-- <i class="fa fa-arrow-down faa-bounce ani mated text-danger" ></i> --\x3e <a href="https://www.google.com.br/search?q='+r+'" title="Índice Brasil 100" target="_blank"> <span class="text-danger  font-weight-bold" style="font-size: 11px;" >'+r+"</span></a> </td>"),l+='      <td> <span class="text-dark  font-weight-bold" style="width:10px; font-size: 11px;">  '+fMascaraValor(o)+" pts</span></td>",d>0&&(l+='      <td> <span class="font-weight-normal text-success" style="width:10px; font-size: 11px;"> +'+fMascaraValor(d)+'</span> <span class="font-weight-normal text-success font-weight-bold" style="font-size: 11px;"> ('+fMascaraValor(c)+"%)</span></td>"),0==d&&(l+='      <td> <span class="font-weight-normal text-primary" style="width:10px; font-size: 11px;"> '+fMascaraValor(d)+' </span> <span class="font-weight-normal text-primary font-weight-bold" style="font-size: 11px;"> ('+fMascaraValor(c)+"%)</span> </td>"),d<0&&(l+='      <td> <span class="font-weight-normal text-danger"  style="width:10px; font-size: 11px;"> '+fMascaraValor(d)+' </span> <span class="font-weight-normal text-danger font-weight-bold"  style="font-size: 11px;"> ('+fMascaraValor(c)+"%)</span> </td>"),l+='      <td style="width:10px">',l+='         <a class="btn btn-sm btn-dark btn-icon btn-icon-mini btn-round btn-simple" style="height: 1.2rem; min-width: 1.2rem; width: 1.2rem; margin: 1px 1px; font-size:0.3rem; " title="Gráfico do Ativo '+r+'" href="javascript:void(0);" role="button" aria-pressed="true" ',l+="            onclick=\"fAbrirModalGraficoPortfolio( '"+a+"','"+r+'\' );"> <i class="fa fa-area-chart" aria-hidden="true"></i> ',l+="         </a>",l+="      </td>",l+="    </tr>"):"IDIV"==r?(s+='    <tr class="text-center"> ',d>0&&(s+='      <td style="width:80px;"> \x3c!-- <i class="fa fa-arrow-up faa-bounce ani mated text-success">  </i> --\x3e <a href="https://www.google.com.br/search?q='+r+'" title="Índice Dividendos" target="_blank"> <span class="text-success font-weight-bold" style="font-size: 11px;" >'+r+"</span></a> </td>"),0==d&&(s+='      <td style="width:80px;"> \x3c!-- <i class="fa fa-arrow-right faa-flash ani mated text-primary"></i> --\x3e <a href="https://www.google.com.br/search?q='+r+'" title="Índice Dividendos" target="_blank"> <span class="text-primary font-weight-bold" style="font-size: 11px;" >'+r+"</span></a> </td>"),d<0&&(s+='      <td style="width:80px;"> \x3c!-- <i class="fa fa-arrow-down faa-bounce ani mated text-danger" ></i> --\x3e <a href="https://www.google.com.br/search?q='+r+'" title="Índice Dividendos" target="_blank"> <span class="text-danger  font-weight-bold" style="font-size: 11px;" >'+r+"</span></a> </td>"),s+='      <td> <span class="text-dark  font-weight-bold" style="width:10px; font-size: 11px;">  '+fMascaraValor(o)+" pts</span></td>",d>0&&(s+='      <td> <span class="font-weight-normal text-success" style="width:10px; font-size: 11px;"> +'+fMascaraValor(d)+'</span> <span class="font-weight-normal text-success font-weight-bold" style="font-size: 11px;"> ('+fMascaraValor(c)+"%)</span></td>"),0==d&&(s+='      <td> <span class="font-weight-normal text-primary" style="width:10px; font-size: 11px;"> '+fMascaraValor(d)+' </span> <span class="font-weight-normal text-primary font-weight-bold" style="font-size: 11px;"> ('+fMascaraValor(c)+"%)</span> </td>"),d<0&&(s+='      <td> <span class="font-weight-normal text-danger"  style="width:10px; font-size: 11px;"> '+fMascaraValor(d)+' </span> <span class="font-weight-normal text-danger font-weight-bold"  style="font-size: 11px;"> ('+fMascaraValor(c)+"%)</span> </td>"),s+='      <td style="width:10px">',s+='         <a class="btn btn-sm btn-dark btn-icon btn-icon-mini btn-round btn-simple" style="height: 1.2rem; min-width: 1.2rem; width: 1.2rem; margin: 1px 1px; font-size:0.3rem; " title="Gráfico do Ativo '+r+'" href="javascript:void(0);" role="button" aria-pressed="true" ',s+="            onclick=\"fAbrirModalGraficoPortfolio( '"+a+"','"+r+'\' );"> <i class="fa fa-area-chart" aria-hidden="true"></i> ',s+="         </a>",s+="      </td>",s+="    </tr>"):"SMLL"==r&&(n+='    <tr class="text-center"> ',d>0&&(n+='      <td style="width:80px;"> \x3c!-- <i class="fa fa-arrow-up faa-bounce ani mated text-success">  </i> --\x3e <a href="https://www.google.com.br/search?q='+r+'" title="Índice Small Cap" target="_blank"> <span class="text-success font-weight-bold" style="font-size: 11px;" >'+r+"</span></a> </td>"),0==d&&(n+='      <td style="width:80px;"> \x3c!-- <i class="fa fa-arrow-right faa-flash ani mated text-primary"></i> --\x3e <a href="https://www.google.com.br/search?q='+r+'" title="Índice Small Cap" target="_blank"> <span class="text-primary font-weight-bold" style="font-size: 11px;" >'+r+"</span></a> </td>"),d<0&&(n+='      <td style="width:80px;"> \x3c!-- <i class="fa fa-arrow-down faa-bounce ani mated text-danger" ></i> --\x3e <a href="https://www.google.com.br/search?q='+r+'" title="Índice Small Cap" target="_blank"> <span class="text-danger  font-weight-bold" style="font-size: 11px;" >'+r+"</span></a> </td>"),n+='      <td> <span class="text-dark  font-weight-bold" style="width:10px; font-size: 11px;">  '+fMascaraValor(o)+" pts</span></td>",d>0&&(n+='      <td> <span class="font-weight-normal text-success" style="width:10px; font-size: 11px;"> +'+fMascaraValor(d)+'</span> <span class="font-weight-normal text-success font-weight-bold" style="font-size: 11px;"> ('+fMascaraValor(c)+"%)</span></td>"),0==d&&(n+='      <td> <span class="font-weight-normal text-primary" style="width:10px; font-size: 11px;"> '+fMascaraValor(d)+' </span> <span class="font-weight-normal text-primary font-weight-bold" style="font-size: 11px;"> ('+fMascaraValor(c)+"%)</span> </td>"),d<0&&(n+='      <td> <span class="font-weight-normal text-danger"  style="width:10px; font-size: 11px;"> '+fMascaraValor(d)+' </span> <span class="font-weight-normal text-danger font-weight-bold"  style="font-size: 11px;"> ('+fMascaraValor(c)+"%)</span> </td>"),n+='      <td style="width:10px">',n+='         <a class="btn btn-sm btn-dark btn-icon btn-icon-mini btn-round btn-simple" style="height: 1.2rem; min-width: 1.2rem; width: 1.2rem; margin: 1px 1px; font-size:0.3rem; " title="Gráfico do Ativo '+r+'" href="javascript:void(0);" role="button" aria-pressed="true" ',n+="            onclick=\"fAbrirModalGraficoPortfolio( '"+a+"','"+r+'\' );"> <i class="fa fa-area-chart" aria-hidden="true"></i> ',n+="         </a>",n+="      </td>",n+="    </tr>")})}o+=i,o+=l,o+=s,o+=n,o+="  </tbody>",o+="</table>",r.html(""),r.append(o)}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGridRadar(a){try{promise=new Promise((t,e)=>{t(!0);var r=$("#ListaRadar");r.html("");var o="";if(o+='<table class="table table-sm table-hover table-condensed nowrap" border="0" cellspacing="0" width="100%" style="margin: 0px;">',o+="  <tbody>",DataSetRadar&&DataSetRadar.data&&DataSetRadar.data.Lista){var i=DataSetRadar.data.Lista;i.length>0&&(i.sort(function(a,t){a[0];var e=parseFloat(GetValorDecimal(a[2])),r=parseFloat(GetValorDecimal(a[3])),o=(t[0],parseFloat(GetValorDecimal(t[2]))),i=parseFloat(GetValorDecimal(t[3]));return e<0&&r>0&&(r*=-1),o<0&&i>0&&(i*=-1),r==i?0:r>i?1:-1}),i.reverse(),$.each(i,function(t,e){var r=e[0],i=parseFloat(GetValorDecimal(e[1])),l=parseFloat(GetValorDecimal(e[2])),s=parseFloat(GetValorDecimal(e[3]));"IBOV"!=r&&"IDIV"!=r&&"SMLL"!=r&&"IBXX"!=r&&(o+='    <tr class="text-center"> ',l>0&&(o+='      <td style="width:10px;"> \x3c!-- <i class="fa fa-arrow-up faa-bounce ani mated text-success">  </i> --\x3e <a href="https://www.google.com.br/search?q='+r+'" target="_blank"> <span class="text-success font-weight-bold" style="font-size: 11px;" >'+r+"</span></a> </td>"),0==l&&(o+='      <td style="width:10px;"> \x3c!-- <i class="fa fa-arrow-right faa-flash ani mated text-primary"></i> --\x3e <a href="https://www.google.com.br/search?q='+r+'" target="_blank"> <span class="text-primary font-weight-bold" style="font-size: 11px;" >'+r+"</span></a> </td>"),l<0&&(o+='      <td style="width:10px;"> \x3c!-- <i class="fa fa-arrow-down faa-bounce ani mated text-danger" ></i> --\x3e <a href="https://www.google.com.br/search?q='+r+'" target="_blank"> <span class="text-danger  font-weight-bold" style="font-size: 11px;" >'+r+"</span></a> </td>"),o+='      <td style="width:40px;"> <span class="text-dark  font-weight-bold" style="font-size: 11px;">  R$ '+fMascaraValor(i)+"</span></td>",l>0&&(o+='      <td style="width:50px;"> <span class="font-weight-normal text-success" style="font-size: 11px;"> +'+fMascaraValor(l)+'</span> <span class="font-weight-normal text-success font-weight-bold" style="font-size: 11px;"> ('+fMascaraValor(s)+"%)</span></td>"),0==l&&(o+='      <td style="width:50px;"> <span class="font-weight-normal text-primary" style="font-size: 11px;"> '+fMascaraValor(l)+' </span> <span class="font-weight-normal text-primary font-weight-bold" style="font-size: 11px;"> ('+fMascaraValor(s)+"%)</span> </td>"),l<0&&(o+='      <td style="width:50px;"> <span class="font-weight-normal text-danger"  style="font-size: 11px;"> '+fMascaraValor(l)+' </span> <span class="font-weight-normal text-danger font-weight-bold"  style="font-size: 11px;"> ('+fMascaraValor(s)+"%)</span> </td>"),o+='      <td style="width:30px">',o+='         <a class="btn btn-sm btn-success btn-icon btn-icon-mini btn-round btn-simple" style="height: 1.4rem; min-width: 1.4rem; width: 1.4rem; margin: 1px 1px; font-size:0.3rem; " title="Comprar Ativo '+r+'" href="javascript:void(0);" ',o+="            onclick=\"fAbrirModalDetalheOper( '"+a+"', '', 'Novo', 'C', '"+r+"', '100', '"+fMascaraValor(i)+'\' );"> <i class="fa fa-plus-square" aria-hidden="true"></i> ',o+="         </a>",o+='         <a class="btn btn-sm btn-dark btn-icon btn-icon-mini btn-round btn-simple" style="height: 1.4rem; min-width: 1.4rem; width: 1.4rem; margin: 1px 1px; font-size:0.3rem; " title="Gráfico do Ativo '+r+'" href="javascript:void(0);" role="button" aria-pressed="true" ',o+="            onclick=\"fAbrirModalGraficoPortfolio( '"+a+"','"+r+'\' );"> <i class="fa fa-area-chart" aria-hidden="true"></i> ',o+="         </a>",o+="      </td>",o+="    </tr>")}))}o+="  </tbody>",o+="</table>",r.html(""),r.append(o)}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarGridCarteira(a,t,e,r){try{promise=new Promise((r,o)=>{r(!0),$("#Grid").dataTable().fnClearTable(),$("#Grid").dataTable({bDestroy:!0}).fnDestroy(),$("#Grid").DataTable({processing:!0,serverSide:!1,oLanguage:fTraduzirGrid(),data:t,aoColumns:[{bSortable:!0,bOrderable:!0,sWidth:"10px",targets:0,render:function(a,t,e){if("display"==t){var r=parseFloat(GetValorDecimal(e[7]));if(r>0)return'<a style="text-deco ration:none;" href="https://www.google.com.br/search?q='+e[0]+'" target="_blank"> <span class="text-success font-weight-bold" style="font-size: 14px;" >'+e[0]+"</span></a>";if(0==r)return'<a style="text-deco ration:none;" href="https://www.google.com.br/search?q='+e[0]+'" target="_blank"> <span class="text-primary font-weight-bold" style="font-size: 14px;" >'+e[0]+"</span></a>";if(r<0)return'<a style="text-deco ration:none;" href="https://www.google.com.br/search?q='+e[0]+'" target="_blank"> <span class="text-danger  font-weight-bold" style="font-size: 14px;" >'+e[0]+"</span></a>"}return a}},{bSortable:!0,bOrderable:!0,sWidth:"10px",targets:1,render:function(a,t,e){return"display"==t?e[1]:tirarFormacataoCPFCNPJ(a)}},{bSortable:!0,bOrderable:!0,sWidth:"10px",targets:2,render:function(a,t,e){return"display"==t?"R$ "+e[2]:parseFloat(GetValorDecimal(a))}},{bSortable:!0,bOrderable:!0,sWidth:"10px",targets:3,render:function(a,t,e){return"display"==t?"R$ "+e[3]:parseFloat(GetValorDecimal(a))}},{bSortable:!0,bOrderable:!0,sWidth:"10px",targets:4,render:function(t,e,r){if("display"==e){var o=r[0],i="DEFINIR",l="0,00",s="text-muted",n=parseFloat(GetValorDecimal(r[3])),d=parseFloat(GetValorDecimal(r[4]));return d>0&&(i="R$ "+r[4],l=r[4],d<n&&(s="text-danger"),d>=n&&(s="text-success")),'  <a class="font-weight-bold '+s+'" style="text-deco ration:none;" title="Clique Aqui para Definir o Preço Teto do Ativo '+o+'" href="javascript:void(0);"      onclick="fAbrirModalPrecoTetoAtivo( \''+a+"', '"+o+"', '"+l+"' );\"> "+i+" </i>   </a>"}return parseFloat(GetValorDecimal(t))}},{bSortable:!0,bOrderable:!0,sWidth:"10px",targets:5,render:function(a,t,e){return"display"==t?"R$ "+e[5]:parseFloat(GetValorDecimal(a))}},{bSortable:!0,bOrderable:!0,sWidth:"10px",targets:6,render:function(a,t,e){return"display"==t?"R$ "+e[6]:parseFloat(GetValorDecimal(a))}},{bSortable:!0,bOrderable:!0,sWidth:"10px",targets:7,render:function(a,t,e){return"display"==t?"R$ "+e[7]:parseFloat(GetValorDecimal(a))}},{bSortable:!0,bOrderable:!0,sWidth:"10px",targets:8,render:function(a,t,e){return"display"==t?e[8]+"%":parseFloat(GetValorDecimal(a))}},{bSortable:!0,bOrderable:!0,sWidth:"10px",targets:9,render:function(a,t,e){return"display"==t?"R$ "+e[9]:parseFloat(GetValorDecimal(a))}},{bSortable:!0,bOrderable:!0,sWidth:"10px",targets:10,render:function(a,t,e){return"display"==t?e[10]+"%":parseFloat(GetValorDecimal(a))}},{visible:!1,targets:11},{visible:!1,targets:12},{visible:!1,targets:13},{bSortable:!1,bOrderable:!1,sWidth:"5px",targets:14,render:function(t,r,o){var i="";if("display"==r){var l=o[0],s=o[1],n=o[3],d=o[12];i+='  <a class="btn btn-sm btn-success btn-icon btn-icon-mini btn-round btn-simple" style="font-size:0.5rem; " title="Comprar Ativo '+l+'" href="javascript:void(0);" ',i+="     onclick=\"fAbrirModalDetalheOper( '"+a+"', '', 'Novo', 'C', '"+l+"', '100', '"+n+'\' );"> <i class="fa fa-plus-square" aria-hidden="true"></i> ',i+="  </a>",i+="  &nbsp;",i+='  <a class="btn btn-sm btn-danger btn-icon btn-icon-mini btn-round btn-simple" style="font-size:0.5rem;" title="Vender Ativo '+l+'" href="javascript:void(0);" role="button" aria-pressed="true" ',i+="     onclick=\"fAbrirModalDetalheOper( '"+a+"', '', 'Novo', 'V', '"+l+"', '"+s+"', '"+n+'\' );"> <i class="fa fa-minus-square" aria-hidden="true"></i> ',i+="  </a>",i+="  &nbsp;",i+='  <a class="btn btn-sm btn-dark btn-icon btn-icon-mini btn-round btn-simple" style="font-size:0.5rem; " title="Gráfico do Ativo '+l+'" href="javascript:void(0);" role="button" aria-pressed="true" ',i+="     onclick=\"fAbrirModalGraficoPortfolio( '"+a+"','"+l+'\' );"> <i class="fa fa-area-chart" aria-hidden="true"></i> ',i+="  </a>",""!=e&&(i+="  &nbsp;",i+='<a class="btn btn-sm btn-dark btn-icon btn-icon-mini btn-round btn-simple" style="font-size:0.5rem; " title="Remover Ativo '+l+' do Portfólio Personalizado" href="javascript:void(0);" role="button" aria-pressed="true" ',i+="   onclick=\"fAbrirModalRemoverAtivo( '"+a+"', '"+e+"', '"+d+"', '"+l+'\' );"> <i class="fa fa-trash-o fa-lg" aria-hidden="true"></i> ',i+="</a>")}return i}}],createdRow:function(a,t,e){var r=parseFloat(GetValorDecimal(t[7]));$("td",a).addClass("text-center"),$("td",a).eq(0).addClass("font-weight-bold"),$("td",a).eq(7).addClass("font-weight-bold"),$("td",a).eq(8).addClass("font-weight-bold"),$("td",a).eq(9).addClass("font-weight-bold"),0==r?$("td",a).eq(0).addClass("table-muted"):r>0?$("td",a).eq(0).addClass("text-success"):r<0&&$("td",a).eq(0).addClass("text-danger"),0==r?$("td",a).eq(7).addClass("table-muted"):r>0?$("td",a).eq(7).addClass("text-success"):r<0&&$("td",a).eq(7).addClass("text-danger"),0==r?$("td",a).eq(8).addClass("table-muted"):r>0?$("td",a).eq(8).addClass("text-success"):r<0&&$("td",a).eq(8).addClass("text-danger")},initComplete:function(a,t){finalizarAnimacaoPesquisa()},order:[[8,"desc"]],dom:"frtBpi",buttons:[{extend:"excelHtml5",text:'<i class="fa fa-file-excel-o"></i> Excel',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Portfólio",titleAttr:"Excel",exportOptions:{columns:[0,1,2,3,4,5,6,7,8,9,10]},customizeData:function(a){for(var t=0;t<a.body.length;t++)for(var e=0;e<a.body[t].length;e++)1==e&&(a.body[t][e]="‌"+a.body[t][e])}},{extend:"csvHtml5",charset:"UTF-8",fieldSeparator:";",titleAttr:"CSV",text:'<i class="fa fa-file-o"></i> CSV',className:"btn btn-outline-default btn-sm",title:NOME_PROJETO+" - Portfólio",bom:!0,exportOptions:{columns:[0,1,2,3,4,5,6,7,8,9,10]}},{extend:"pdfHtml5",text:'<i class="fa fa-file-pdf-o"></i> PDF',className:"btn btn-default btn-sm",titleAttr:"PDF",title:NOME_PROJETO+" - Portfólio",orientation:"landscape",pageSize:"A3",alignment:"center",exportOptions:{columns:[0,1,2,3,4,5,6,7,8,9,10]},footer:!0,customize:function(a){a.defaultStyle.fontSize=12,a.styles.tableHeader.fontSize=14,a.styles.tableHeader.alignment="center",a.styles.title.bold=!0,a.styles.tableHeader.bold=!0,a.styles.tableHeader.noWrap=!0}},{extend:"print",text:'<i class="fa fa-print"></i> Imprimir',title:NOME_PROJETO+" - Portfólio",titleAttr:"Imprimir",className:"btn btn-default btn-sm",exportOptions:{columns:[0,1,2,3,4,5,6,7,8,9,10]}}],bFilter:!1,bInfo:!1,bLengthChange:!1,bSearchable:!1,bOrderable:!0,bSortable:!0,bAutoWidth:!1,sAutoWidth:!1,bPaginate:!1,bOrdering:!0})}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(t){finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),null!=t.description&&fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fMontarPagina(a){promise=new Promise((t,e)=>{t(!0),fLimparPagina(a),finalizarAnimacaoPesquisa(),iniciarAnimacaoPesquisar();var r=fGetAbaIdPortfolio(),o=fGetAbaTipoPortfolio();""==r?($("#btnPortAddAtivo").hide(),$("#btnPortAltPortfolio").hide(),$("#btnPortExcPortfolio").hide(),$("#btnPortAddPortfolio").show()):($("#btnPortAddAtivo").show(),$("#btnPortAltPortfolio").show(),$("#btnPortExcPortfolio").show(),$("#btnPortAddPortfolio").hide()),"ACAO"!=o&&"FII"!=o&&"ETF"!=o&&"BDR"!=o||$("#btnPortEmailInfo").hide(),"ACAO"!=o&&"FII"!=o&&"ETF"!=o&&"BDR"!=o&&$("#btnPortEmailInfo").show();var i=0,l=0,s=0,n=0,d=0,c=0,p=0,f=0,b=0,h=[],m=[],A=[],u=[],g=[],x=[],P=[],v=[],w=[],R=[],y=[],T=[],S=[],E=[],V=[],G=[],_=[];$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"portfolio/DataSetPagina",data:{},success:function(t){var e=t.data.Resultado,C=t.data.Mensagem,M=t.data.Lista;if("NSESSAO"==e)return $(location).attr("href",a+"/login"),!1;if("NOK"==e)return fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_AVISO,C),!1;if("FALHA"==e)return fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,C),!1;if("OK"==e){if(DataSetPagina=t,DataSetPagina&&DataSetPagina.data&&DataSetPagina.data.Lista)if((M=DataSetPagina.data.Lista).length>0){var D=-1;$.each(M,function(a,t){var e=t.CartId,d=t.AtvTipoInvest;if(!(""!=r&&r!=e||""!=o&&o!=d)){var f=t.SetorId,b=t.SetorNome,C=t.SubSetorId,M=t.SubSetorNome,O=t.SegmentoId,F=t.SegmentoNome,z=t.AtvId,$=(d=t.AtvTipoInvest,t.AtvCodigo),L=t.AtvQtde,k=t.AtvPrecoMedio,I=t.AtvPrecoAtual,B=t.AtvPrecoTeto,J=t.AtvVlrValorizDia,N=t.AtvPercValorizDia,q=t.AtvTotInvest,Z=t.AtvTotAtual,W=t.AtvTotValoriz,H=t.AtvPercValoriz,j=t.AtvTotProv,Q=t.AtvTotAlug,X=t.AtvYieldOnCost;i+=parseFloat(GetValorDecimal(q)),l+=parseFloat(GetValorDecimal(Z)),n+=parseFloat(GetValorDecimal(W)),c+=parseFloat(GetValorDecimal(j)),p+=parseFloat(GetValorDecimal(Q)),G.push({Codigo:$,Quant:L,PrecoAtual:I,VlrValorizDia:J,PercValorizDia:N}),_.push([$,L,k,I,B,q,Z,W,H,j,X,Q,z,d]),q=parseFloat(GetValorDecimal(q)),W=parseFloat(GetValorDecimal(W)),Z=parseFloat(GetValorDecimal(Z)),j=parseFloat(GetValorDecimal(j)),Q=parseFloat(GetValorDecimal(Q)),h[D+=1]=$,m[D]=q,A[D]=Z,u[D]=j+Q,g[D]=W,x[D]=0!=W&&q>0?W/q*100:0,"ACAO"==d&&(s+=Z,v[f]||(v[f]=0),w[f]||(w[f]=0),y[f+"-"+C]||(y[f+"-"+C]=0),T[f+"-"+C]||(T[f+"-"+C]=0),E[f+"-"+C+"-"+O]||(E[f+"-"+C+"-"+O]=0),V[f+"-"+C+"-"+O]||(V[f+"-"+C+"-"+O]=0),P[f]=b,v[f]+=1,w[f]+=Z,R[f+"-"+C]=M,y[f+"-"+C]+=1,T[f+"-"+C]+=Z,S[f+"-"+C+"-"+O]=F,E[f+"-"+C+"-"+O]+=1,V[f+"-"+C+"-"+O]+=Z)}}),0!=n&&i>0&&(d=n/i*100),0!=(f=n+c+p)&&i>0&&(b=f/i*100)}return setTimeout(()=>{fMontarTotalizadores(a,i,l,n,d,c,p,f,b)},1),setTimeout(()=>{fMontarGraficoCarteiraGeral(a,i,l,c,p)},1),setTimeout(()=>{fMontarGridValorizacaoDia(a,G)},100),setTimeout(()=>{fMontarGridPercentualAtivos(a,h,m,A)},100),setTimeout(()=>{fMontarGraficoCarteiraAtivos(a,h,m,A,g,u)},200),setTimeout(()=>{fMontarGridCarteira(a,_,r,o)},200),setTimeout(()=>{fMontarGraficoTotalValorizacao(a,h,g)},200),setTimeout(()=>{fMontarGraficoPercentualValorizacao(a,h,x)},200),setTimeout(()=>{fMontarGraficoTotalProventos(a,h,u)},200),setTimeout(()=>{fMontarGraficoPesoAtivos(a,h,A)},500),setTimeout(()=>{fMontarGraficoPesoSetores(a,P,w)},500),setTimeout(()=>{fMontarGraficoPesoSubSetores(a,R,T)},500),setTimeout(()=>{fMontarGraficoPesoSegmentos(a,S,V)},500),setTimeout(()=>{fMontarGridSetores(a,s,v,w,y,T,E,V)},500),finalizarAnimacaoPesquisa(),!0}return fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,C),!1},error:function(a){return fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}),fCarregarPaginaIndiceRadar(a)}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}async function fCarregarPaginaIndiceRadar(a){try{promise=new Promise((t,e)=>{$("#ListaIndice").html(""),$("#ListaRadar").html(""),$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"portfolio/ativosNoRadar",data:{},success:function(t){var e=t.data.Resultado,r=t.data.Mensagem;t.data.Lista;return"NSESSAO"==e?($(location).attr("href",a+"/login"),!1):"NOK"==e?(fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_AVISO,r),!1):"FALHA"==e?(fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,r),!1):"OK"==e?(DataSetRadar=t,fMontarGridIndices(a),fMontarGridRadar(a),!0):(fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,r),!1)},error:function(a){return fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}),t(!0)}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}async function fRecarregarPagina(a,t){try{promise=new Promise((t,e)=>{t(!0),fLimparPagina(a),finalizarAnimacaoPesquisa(),iniciarAnimacaoPesquisar();var r=fGetAbaIdPortfolio(),o=fGetAbaTipoPortfolio(),i=""==r&&"BDR"==o?" active":"",l=""==r&&"ETF"==o?" active":"",s=""==r&&"FII"==o?" active":"",n=""==r&&"ACAO"==o?" active":"",d=""==r&&""==o?" active":"",c=""==r&&"BDR"==o?"true":"false",p=""==r&&"ETF"==o?"true":"false",f=""==r&&"FII"==o?"true":"false",b=""==r&&"ACAO"==o?"true":"false",h=""==r&&""==o?"true":"false";$("#TabPortfolios").empty(),$("#TabPortfolios").append('<li class="nav-item"> <a style="font-size: 10px; " class="border border-secondary nav-link'+i+'"    id="AbaPortfolioBdrs"    data-toggle="tab" href="#PortfolioBdrs"    role="tab" aria-controls="PortfolioBdrs"    aria-selected="'+c+'"    title="Portfólio BDRs - Todos os Bdrs da Carteira">  <i class="fa fa-bar-chart"></i>&nbsp; BDRs   </a> </li>'),$("#TabPortfolios").append('<li class="nav-item"> <a style="font-size: 10px; " class="border border-secondary nav-link'+l+'" id="AbaPortfolioIndices" data-toggle="tab" href="#PortfolioIndices" role="tab" aria-controls="PortfolioIndices" aria-selected="'+p+'" title="Portfólio ETFs - Todos os Etfs da Carteira">  <i class="fa fa-bar-chart"></i>&nbsp; ETFs  </a> </li>'),$("#TabPortfolios").append('<li class="nav-item"> <a style="font-size: 10px; " class="border border-secondary nav-link'+s+'"  id="AbaPortfolioFundos"  data-toggle="tab" href="#PortfolioFundos"  role="tab" aria-controls="PortfolioFundos"  aria-selected="'+f+'"  title="Portfólio FIIs - Todos os Fiis da Carteira">  <i class="fa fa-bar-chart"></i>&nbsp; FIIs    </a> </li>'),$("#TabPortfolios").append('<li class="nav-item"> <a style="font-size: 10px; " class="border border-secondary nav-link'+n+'"   id="AbaPortfolioAcoes"   data-toggle="tab" href="#PortfolioAcoes"   role="tab" aria-controls="PortfolioAcoes"   aria-selected="'+b+'"   title="Portfólio Ações - Todos as Ações da Carteira">    <i class="fa fa-bar-chart"></i>&nbsp; AÇÕES  </a> </li>'),$("#TabPortfolios").append('<li class="nav-item"> <a style="font-size: 10px; " class="border border-secondary nav-link'+d+'"   id="AbaPortfolio"        data-toggle="tab" href="#Portfolio"        role="tab" aria-controls="Portfolio"        aria-selected="'+h+'"   title="Portfólio Completo - Todos os Ativos da Carteira"><i class="fa fa-bar-chart"></i>&nbsp; Portfólio </a> </li>'),$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"listas/lista_nomes_carteira_user",success:function(t){var e=t.data.Resultado,m=t.data.Mensagem,A=t.data.Lista;return"NSESSAO"==e?($(location).attr("href",a+"/login"),!1):"NOK"==e?(fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_AVISO,m),!1):"FALHA"==e?(fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,m),!1):"OK"==e?($("#TabPortfolios").empty(),A.length>0&&(A.reverse(),$.each(A,function(a,t){var e=""!=r&&r==t[0]&&""==o?" active":"",i=""!=r&&r==t[0]&&""==o?"true":"false";$('<li class="nav-item"> <a style="font-size: 10px; " class="border border-secondary nav-link'+e+'" id="Aba'+t[0]+'" data-toggle="tab" href="#'+t[0]+'" role="tab" aria-controls="'+t[0]+'" aria-selected="'+i+'" title="Portfólio Personalizado - Ativos Selecionados da Carteira"><i class="fa fa-sliders"></i>&nbsp; '+t[1]+"</a> </li>").appendTo("#TabPortfolios")})),$("#TabPortfolios").append('<li class="nav-item"> <a style="font-size: 10px; " class="border border-secondary nav-link'+i+'"    id="AbaPortfolioBdrs"    data-toggle="tab" href="#PortfolioIndices" role="tab" aria-controls="PortfolioIndices" aria-selected="'+c+'"    title="Portfólio BDRs - Todos os Bdrs da Carteira">  <i class="fa fa-bar-chart"></i>&nbsp; BDRs     </a> </li>'),$("#TabPortfolios").append('<li class="nav-item"> <a style="font-size: 10px; " class="border border-secondary nav-link'+l+'" id="AbaPortfolioIndices" data-toggle="tab" href="#PortfolioIndices" role="tab" aria-controls="PortfolioIndices" aria-selected="'+p+'" title="Portfólio ETFs - Todos os Etfs da Carteira">  <i class="fa fa-bar-chart"></i>&nbsp; ETFs     </a> </li>'),$("#TabPortfolios").append('<li class="nav-item"> <a style="font-size: 10px; " class="border border-secondary nav-link'+s+'"  id="AbaPortfolioFundos"  data-toggle="tab" href="#PortfolioFundos"  role="tab" aria-controls="PortfolioFundos"  aria-selected="'+f+'"  title="Portfólio FIIs - Todos os Fiis da Carteira">    <i class="fa fa-bar-chart"></i>&nbsp; FIIs     </a> </li>'),$("#TabPortfolios").append('<li class="nav-item"> <a style="font-size: 10px; " class="border border-secondary nav-link'+n+'"   id="AbaPortfolioAcoes"   data-toggle="tab" href="#PortfolioAcoes"   role="tab" aria-controls="PortfolioAcoes"   aria-selected="'+b+'"   title="Portfólio Ações - Todos as Ações da Carteira">      <i class="fa fa-bar-chart"></i>&nbsp; AÇÕES  </a> </li>'),$("#TabPortfolios").append('<li class="nav-item"> <a style="font-size: 10px; " class="border border-secondary nav-link'+d+'"   id="AbaPortfolio"        data-toggle="tab" href="#Portfolio"        role="tab" aria-controls="Portfolio"        aria-selected="'+h+'"   title="Portfólio Completo - Todos os Ativos da Carteira">  <i class="fa fa-bar-chart"></i>&nbsp; Portfólio </a> </li>'),$('#TabPortfolios a[data-toggle="tab"]').on("shown.bs.tab",function(t){fMontarPagina(a)}),!0):(fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,m),!1)},error:function(a){return fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}),fMontarPagina(a)}).then(a=>{}).catch(a=>{fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}$(document).ready(function(){$("#MnPrincPortfolio").addClass("active open"),$("#FormOper input[type=text]").bind("keyup change",function(){fCalcularPrecoTotal(),fCalcularOperacao()})});