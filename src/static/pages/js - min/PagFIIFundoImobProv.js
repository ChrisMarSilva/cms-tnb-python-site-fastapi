function iniciarAnimacaoPesquisar(){$("#iRefresh").addClass("fa-spin"),$("#btnFundoProvPesquisar").addClass("disabled")}function finalizarAnimacaoPesquisa(){$("#iRefresh").removeClass("fa-spin"),$("#btnFundoProvPesquisar").removeClass("disabled")}function fLimparGrid(a){$("#txtFiltroFundoProvDataIni").val(fDataPrimeira()),$("#txtFiltroFundoProvDataFim").val(""),$("#txtFiltroFundoProvFundo").val(""),$("#txtFiltroFundoProvTipo").val(""),fLimparSomenteGrid(a)}function fLimparSomenteGrid(a){try{finalizarAnimacaoPesquisa(),$("th").addClass("text-center"),$("#Grid").dataTable().fnClearTable(),$("#Grid").dataTable({bDestroy:!0}).fnDestroy(),$("#Grid").DataTable({oLanguage:fTraduzirGrid(),aoColumns:[{bSortable:!0,sWidth:"50px",targets:0},{bSortable:!0,sWidth:"50px",targets:1},{bSortable:!0,sWidth:"50px",targets:2},{bSortable:!0,sWidth:"50px",targets:3},{bSortable:!0,sWidth:"50px",targets:4},{visible:!1,targets:5},{bSortable:!0,sWidth:"50px",targets:6}],bFilter:!0,searchable:!0,orderable:!0,bAutoWidth:!1})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fMontarGrid(a,r){try{$("#Grid").DataTable({processing:!0,serverSide:!1,oLanguage:fTraduzirGrid(),data:r,aoColumns:[{bSortable:!0,sWidth:"50px",targets:0,render:function(a,r,o){return"display"==r?colcarFormacataoData(o[0]):a}},{bSortable:!0,sWidth:"50px",targets:1,render:function(a,r,o){return"display"==r?colcarFormacataoData(o[1]):a}},{bSortable:!0,sWidth:"20px",targets:2},{bSortable:!0,sWidth:"20px",targets:3},{bSortable:!0,sWidth:"50px",targets:4,render:function(a,r,o){return"display"==r?"R$ "+o[4].replace(".",","):a}},{visible:!1,targets:5},{bSortable:!0,sWidth:"20px",targets:6,render:function(r,o,t){var i="",d="";return"display"==o&&(IdFundoProv=t[5],i+='<div class="btn-group btn-group-sm" role="group" aria-label="Basic example">',i+='<a class="btn btn-sm btn-warning btn-icon btn-icon-mini btn-round btn-simple" style="font-size:0.5rem;" title="Alterar" href="javascript:void(0);" onclick="fAbrirModalDetalheFundoProv( \''+a+"', '"+IdFundoProv+"', 'Alterar' );\">",i+='   <i class="fa fa-pencil fa-lg" aria-hidden="true"></i> ',i+="</a>",d+='<a class="btn btn-sm btn-danger btn-icon btn-icon-mini btn-round btn-simple" style="font-size:0.5rem;" title="Excluir" href="javascript:void(0);" role="button" aria-pressed="true" onclick="fChamarPagExclusaoFundoProv( \''+IdFundoProv+"' );\">",d+='   <i class="fa fa-trash-o fa-lg" aria-hidden="true"></i> ',d+="</a>",d+="</div>"),i+"&nbsp;"+d}}],createdRow:function(a,r,o){$("td",a).addClass("text-center")},initComplete:function(a,r){finalizarAnimacaoPesquisa()},pageLength:100,bLengthChange:!1,bFilter:!0,searchable:!0,orderable:!0,bAutoWidth:!1}),$(document).ajaxError(function(r,o,t,i){fLimparSomenteGrid(a),finalizarAnimacaoPesquisa()})}catch(r){fLimparSomenteGrid(a),finalizarAnimacaoPesquisa(),null!=r.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fCarregarGrid(a){try{finalizarAnimacaoPesquisa(),fLimparAreaAlertaPrinc(),$("#Grid").dataTable().fnClearTable(),$("#Grid").dataTable({bDestroy:!0}).fnDestroy(),iniciarAnimacaoPesquisar();var r=$("#txtFiltroFundoProvDataIni").val(),o=$("#txtFiltroFundoProvDataFim").val(),t=$("#txtFiltroFundoProvFundo").val(),i=$("#txtFiltroFundoProvTipo").val();$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"FiiFundoImobProv/grid",data:{ProvDtExIni:tirarFormacataoData(r),ProvDtExFim:tirarFormacataoData(o),CodFundo:t,Tipo:i},success:function(r){var o=r.data.Resultado,t=r.data.Mensagem,i=r.data.Lista;return"NSESSAO"==o?($(location).attr("href",a+"/login"),!1):"NOK"==o?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_AVISO,t)):"FALHA"==o?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,t)):"OK"!=o?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,t)):void fMontarGrid(a,i)},error:function(r){return finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}})}catch(r){finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),null!=r.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fLimparDadosModalFundoProv(){fLimparAreaAlertaModalCad(),$("#txtCadFundoProvId").val(""),$("#txtCadFundoProvFundo").val(""),$("#txtCadFundoProvTipo").val(""),$("#txtCadFundoProvCateg").val(""),$("#txtCadFundoProvDtAprov").val(fDataAtual()),$("#txtCadFundoProvDtCom").val(""),$("#txtCadFundoProvDtEx").val(fDataAtual()),$("#txtCadFundoProvDtPagto").val(""),$("#txtCadFundoProvPreco").val("0,00"),fDefinirPadraoSelect("txtCadFundoProvFundo")}function fAbrirModalDetalheFundoProv(a,r,o){try{fLimparDadosModalFundoProv(),$("#PopModalDetalheFundoProvTit").html(""),$("#PopModalDetalheFundoProvTit").html(" - "+o),$("#BtnModalDetalheFundoProvSalvar").show(),"Visualizar"==o&&$("#BtnModalDetalheFundoProvSalvar").hide(),"Novo"==o&&$("#PopModalDetalheFundoProv").modal({backdrop:"static"}),"Alterar"!=o&&"Visualizar"!=o||fCarregarDadosModalDetalheFundoProv(a,r,o),$("#txtCadFundoProvFundo").focus()}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fCarregarDadosModalDetalheFundoProv(a,r,o){try{if(""==r)return void fCriarAlertaPrinc(TP_ALERTA_AVISO,"Id. Fundo Provento não informado!");$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"FiiFundoImobProv/carregar",data:{IdFundoProv:r},success:function(r){var t=r.data.Resultado,i=r.data.Mensagem,d=r.data.Dados;if("NSESSAO"==t)return $(location).attr("href",a+"/login"),!1;"NOK"==t?fCriarAlertaPrinc(TP_ALERTA_AVISO,i):"FALHA"==t?fCriarAlertaPrinc(TP_ALERTA_ERRO,i):"OK"==t&&d.Id?($("#txtCadFundoProvId").val(d.Id),$("#txtCadFundoProvFundo").val(d.CodFundo),$("#txtCadFundoProvTipo").val(d.Tipo),$("#txtCadFundoProvCateg").val(d.Categ),$("#txtCadFundoProvDtAprov").val(d.DtAprov),$("#txtCadFundoProvDtCom").val(d.DtCom),$("#txtCadFundoProvDtEx").val(d.DtEx),$("#txtCadFundoProvDtPagto").val(d.DtPagto),$("#txtCadFundoProvPreco").val(d.Preco.replace(".",",")),fDefinirPadraoSelect("txtCadFundoProvFundo"),"Visualizar"==o&&($("#BtnModalDetalheFundoProvSalvar").attr("disabled","disabled"),$("#BtnModalDetalheFundoProvSalvar").addClass("disabled")),$("#PopModalDetalheFundoProv").modal({backdrop:"static"})):fCriarAlertaPrinc(TP_ALERTA_ERRO,i)},error:function(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fValidarDados(){try{fLimparAreaAlertaModalCad();var a=$("#txtCadFundoProvFundo").val(),r=$("#txtCadFundoProvTipo").val(),o=$("#txtCadFundoProvDtAprov").val(),t=$("#txtCadFundoProvPreco").val(),i="";return""==a&&(i+=" - Fundo<br/>"),""==r&&(i+=" - Tipo<br/>"),""==o&&(i+=" - Data Aprov<br/>"),""!=t&&",00"!=t&&"0,00"!=t||(i+=" - Preço<br/>"),""==i||(fCriarAlertaModalCad(TP_ALERTA_AVISO,"Os seguintes campos não estão preenchido: <br/>"+i),!1)}catch(a){return fCriarAlertaModalCad(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}function fSalvarDadosFundoProv(a){try{if(!fValidarDados())return!1;iniciarAnimacaoSalvar();var r=$("#txtCadFundoProvId").val(),o=$("#txtCadFundoProvFundo").val(),t=$("#txtCadFundoProvTipo").val(),i=$("#txtCadFundoProvCateg").val(),d=$("#txtCadFundoProvDtAprov").val(),n=$("#txtCadFundoProvDtCom").val(),e=$("#txtCadFundoProvDtEx").val(),l=$("#txtCadFundoProvDtPagto").val(),u=$("#txtCadFundoProvPreco").val();$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"FiiFundoImobProv/salvar",data:{Id:r,CodFundo:o,Tipo:t,Categ:i,DtAprov:tirarFormacataoData(d),DtCom:tirarFormacataoData(n),DtEx:tirarFormacataoData(e),DtPagto:tirarFormacataoData(l),Preco:u},success:function(r){finalizarAnimacaoSalvar();var o=r.data.Resultado,t=r.data.Mensagem;if("NSESSAO"==o)return $(location).attr("href",a+"/login"),!1;"NOK"!=o?"FALHA"!=o&&"OK"==o?(fLimparDadosModalFundoProv(),$("#PopModalDetalheFundoProv").modal("hide"),fCriarAlertaPrinc(TP_ALERTA_SUCESSO,"Dados salvo com sucesso!"),fCarregarGrid(a)):fCriarAlertaModalCad(TP_ALERTA_ERRO,t):fCriarAlertaModalCad(TP_ALERTA_AVISO,t)},error:function(a){finalizarAnimacaoSalvar(),fCriarAlertaModalCad(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}})}catch(a){return finalizarAnimacaoSalvar(),void CriarAlertaModal(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fChamarPagExclusaoFundoProv(a){try{if($("#txtDelFundoProvId").val(""),""==a)return void fCriarAlertaPrinc(TP_ALERTA_AVISO,"Id. Fundo Provento não informado!");$("#PopModalDelFundoProv").modal({backdrop:"static"}),$("#txtDelFundoProvId").val(a)}catch(a){$("#PopModalDelFundoProv").modal("hide"),finalizarAnimacaoExcluir(),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fExcluirDadosFundoProv(a){try{finalizarAnimacaoExcluir();var r=$("#txtDelFundoProvId").val();if(""==r)return void fCriarAlertaModalExc(TP_ALERTA_AVISO,"Id. Fundo Provento não informado!");iniciarAnimacaoExcluir(),$.ajax({dataType:"json",type:"post",url:a+"FiiFundoImobProv/excluir",data:{FundoProvId:r},success:function(r){finalizarAnimacaoExcluir();var o=r.data.Resultado,t=r.data.Mensagem;return"NSESSAO"==o?($(location).attr("href",a+"/login"),!1):"NOK"==o?(fCriarAlertaModalExc(TP_ALERTA_AVISO,t),!1):"FALHA"==o?void fCriarAlertaModalExc(TP_ALERTA_ERRO,t):"OK"==o?(fCriarAlertaPrinc(TP_ALERTA_SUCESSO,t),$("#txtDelFundoProvId").val(""),$("#PopModalDelFundoProv").modal("hide"),fCarregarGrid(a),!0):(fCriarAlertaModalExc(TP_ALERTA_ERRO,t),!1)},error:function(a){$("#PopModalDelFundoProv").modal("hide"),finalizarAnimacaoExcluir(),fCriarAlertaModalExc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}})}catch(a){$("#PopModalDelFundoProv").modal("hide"),finalizarAnimacaoExcluir(),fCriarAlertaModalExc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}$(document).ready(function(){$("#MnPrincFiiFundoImobProv").addClass("active open"),fLimparAreaAlertaPrinc(),fLimparAreaAlertaModalCad(),fLimparAreaAlertaModalExc()});