function AdicionarTabelaNaConsulta(t=""){if(""!=(t=t.trim())){var a=$("#DivConsultaSQL").val();""!=a.trim()&&(a+="\n");var i="",e="",l=DataSetCamposTabela.data.Lista;l.length>0&&$.each(l,function(a,l){var n=l[0],o=l[1],s=l[2];t==n&&(i+=(""!=i?", ":"")+"T."+o,"PRI"==s&&(e+=(""!=e?", ":"")+"T."+o))}),""==i.trim()&&(i+=" T.* "),""==e.trim()&&(e+=" 1 ");var n="SELECT "+i+"\nFROM "+t+" T \nORDER BY "+e;$("#DivConsultaSQL").val(n+"\n\n"+a),ExecutarComandoSQL(n)}}function ExecutarComandoSQL(t=""){try{if($("#DivResultado").html(""),""==t.trim()&&(t=document.getElementById("DivConsultaSQL").value.substring(document.getElementById("DivConsultaSQL").selectionStart,document.getElementById("DivConsultaSQL").selectionEnd)),""==t.trim()&&(t=$("#DivConsultaSQL").val()),""==t.trim())return;$("#DivResultado").html('<div class="row clearfix">   <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 text-center" style="padding-left: 5px; padding-right: 5px;" >     <i class="fa fa-spinner fa-spin fa-5x fa-pulse fa-fw" aria-hidden="true"></i>   </div> </div> '),$.ajax({cache:"false",dataType:"html",async:!0,type:"POST",url:"/AdminConsulta/ComandoSQL",data:{ComandoSQL:t},success:function(t){$("#DivResultado").html(""),$("#DivResultado").html(t)},error:function(t){return $("#DivResultado").html(MSG_ALERTA_ERRO),!1}})}catch(t){null!=t.description&&$("#DivResultado").html(MSG_ALERTA_ERRO)}}$(document).ready(function(){$("#MnPrincAluguel").addClass("active open"),$("#TxtFiltroTabelas").on("keyup",function(t){27==t.keyCode&&$(this).val("");var a=$(this).val().toLowerCase();$("#DivListaTabelas li").filter(function(){$(this).toggle($(this).text().toLowerCase().indexOf(a)>-1)})}),$("#TxtFiltroTabelas").on("keypress",function(t){13==t.which&&""!=$("#DivListaTabelas li:visible:first").html().trim()&&AdicionarTabelaNaConsulta($("#DivListaTabelas li:visible:first").html().trim())}),$("#DivListaTabelas li").dblclick(function(){AdicionarTabelaNaConsulta($(this).html().trim())}),$("#DivConsultaSQL").on("keyup",function(t){27==t.keyCode&&$("#DivResultado").html(""),120==t.keyCode&&ExecutarComandoSQL()})});