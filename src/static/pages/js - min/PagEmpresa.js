function iniciarAnimacaoPesquisar(){$("#iRefresh").addClass("fa-spin"),$("#btnEmprPesquisar").addClass("disabled"),$("#btnEmprLimpar").addClass("disabled")}function finalizarAnimacaoPesquisa(){$("#iRefresh").removeClass("fa-spin"),$("#btnEmprPesquisar").removeClass("disabled"),$("#btnEmprLimpar").removeClass("disabled")}function fLimparGrid(a){$("#selFiltroSetor").val(""),$("#selFiltroSubSetor").val(""),$("#selFiltroSegmento").val(""),$("#selFiltroAtivo").val(""),$("#selFiltroTipo").val(""),fLimparSomenteGrid(a)}function fLimparSomenteGrid(a){try{finalizarAnimacaoPesquisa(),$("th").addClass("text-center"),$("#Grid").dataTable().fnClearTable(),$("#Grid").dataTable({bDestroy:!0}).fnDestroy(),$("#Grid").DataTable({oLanguage:fTraduzirGrid(),aoColumns:[{bSortable:!0,sWidth:"10px",targets:0},{bSortable:!0,sWidth:"20px",targets:1},{bSortable:!0,sWidth:"40px",targets:2},{bSortable:!0,sWidth:"40px",targets:3},{bSortable:!0,sWidth:"40px",targets:4},{bSortable:!0,sWidth:"40px",targets:5},{visible:!1,targets:6},{visible:!1,targets:7},{bSortable:!0,sWidth:"20px",targets:8}],bFilter:!0,searchable:!0,orderable:!0,bAutoWidth:!1})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fMontarGrid(a,r){try{$("#Grid").DataTable({processing:!0,serverSide:!1,oLanguage:fTraduzirGrid(),data:r,aoColumns:[{bSortable:!0,sWidth:"10px",targets:0},{bSortable:!0,sWidth:"20px",targets:1},{bSortable:!0,sWidth:"40px",targets:2},{bSortable:!0,sWidth:"40px",targets:3},{bSortable:!0,sWidth:"40px",targets:4},{bSortable:!0,sWidth:"40px",targets:5},{visible:!1,targets:6},{visible:!1,targets:7},{bSortable:!0,sWidth:"20px",targets:8,render:function(r,t,e){var i="";return"display"==t&&(IdEmpresa=e[7],i+='<a class="btn btn-sm btn-warning btn-icon btn-icon-mini btn-round btn-simple" style="font-size:0.5rem;" title="Alterar '+IdEmpresa+'" href="javascript:void(0);" onclick="fAbrirModalDetalheEmpr( \''+a+"', '"+IdEmpresa+"' );\">",i+='   <i class="fa fa-pencil fa-lg" aria-hidden="true"></i> ',i+="</a>"),i}}],createdRow:function(a,r,t){$("td",a).addClass("text-center")},initComplete:function(a,r){finalizarAnimacaoPesquisa()},bFilter:!0,bInfo:!0,bLengthChange:!1,searchable:!0,orderable:!0,bOrdering:!0,bSortable:!0,sAutoWidth:!1,bPaginate:!1,bAutoWidth:!1}),$(document).ajaxError(function(r,t,e,i){fLimparSomenteGrid(a),finalizarAnimacaoPesquisa()})}catch(r){fLimparSomenteGrid(a),finalizarAnimacaoPesquisa(),null!=r.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fCarregarGrid(a){try{fLimparAreaAlertaPrinc(),$("#Grid").dataTable().fnClearTable(),$("#Grid").dataTable({bDestroy:!0}).fnDestroy(),finalizarAnimacaoPesquisa(),iniciarAnimacaoPesquisar();var r=$("#selFiltroSetor").val().trim(),t=$("#selFiltroSubSetor").val().trim(),e=$("#selFiltroSegmento").val().trim(),i=$("#selFiltroAtivo").val().trim(),l=$("#selFiltroTipo").val().trim();$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"empresa/grid",data:{Setor:r,SubSetor:t,Segmento:e,CodAtivo:i,Tipo:l},success:function(r){var t=r.data.Resultado,e=r.data.Mensagem,i=r.data.Lista;return"NSESSAO"==t?($(location).attr("href",a+"/login"),!1):"NOK"==t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_AVISO,e)):"FALHA"==t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,e)):"OK"!=t?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,e)):void fMontarGrid(a,i)},error:function(r){return finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}})}catch(r){finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),null!=r.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fAbrirModalDetalheEmpr(a,r){try{if(""==r)return void fCriarAlertaPrinc(TP_ALERTA_AVISO,"Id. Empresa não informado!");fLimparAreaAlertaModalCad(),$("#txtCadEmprId").val(""),$("#txtCadEmprSetor").val(""),$("#txtCadEmprSubSetor").val(""),$("#txtCadEmprSegmento").val(""),$("#txtCadEmprNome").val(""),$("#txtCadEmprRazao").val(""),$("#txtCadEmprCNPJ").val(""),$("#txtCadEmprAtividade").val(""),$("#txtCadEmprCodCVM").val(""),$("#txtCadEmprSitCVM").val(""),$("#txtCadEmprSituacao").val(""),$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"empresa/carregar",data:{IdEmpresa:r},success:function(r){var t=r.data.Resultado,e=r.data.Mensagem,i=r.data.Dados;if("NSESSAO"==t)return $(location).attr("href",a+"/login"),!1;"NOK"==t?fCriarAlertaPrinc(TP_ALERTA_AVISO,e):"FALHA"==t?fCriarAlertaPrinc(TP_ALERTA_ERRO,e):"OK"==t&&i.Id?($("#txtCadEmprId").val(i.Id),$("#txtCadEmprSetor").val(i.SetorId),$("#txtCadEmprSubSetor").val(i.SubSetorId),$("#txtCadEmprSegmento").val(i.SegmentoId),$("#txtCadEmprNome").val(i.Nome),$("#txtCadEmprRazao").val(i.RazaoSocial),$("#txtCadEmprCNPJ").val(i.CNPJ),$("#txtCadEmprAtividade").val(i.Atividade),$("#txtCadEmprCodCVM").val(i.CodCVM),$("#txtCadEmprSitCVM").val(i.SitCVM),$("#txtCadEmprSituacao").val(i.Situacao),fDefinirPadraoSelect("txtCadEmprSetor"),fDefinirPadraoSelect("txtCadEmprSubSetor"),fDefinirPadraoSelect("txtCadEmprSegmento"),$("#PopModalDetalheEmpresa").modal({backdrop:"static"})):fCriarAlertaPrinc(TP_ALERTA_ERRO,e)},error:function(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fValidarDados(){try{fLimparAreaAlertaModalCad();var a=$("#txtCadEmprId").val(),r=($("#txtCadEmprSetor").val(),$("#txtCadEmprSubSetor").val(),$("#txtCadEmprSegmento").val(),$("#txtCadEmprNome").val()),t=$("#txtCadEmprRazao").val(),e=$("#txtCadEmprCNPJ").val(),i=($("#txtCadEmprAtividade").val(),$("#txtCadEmprCodCVM").val(),$("#txtCadEmprSitCVM").val(),$("#txtCadEmprSituacao").val()),l="";return""==a&&(l+=" - Id<br/>"),""==r&&(l+=" - Nome<br/>"),""==t&&(l+=" - Razao<br/>"),""==e&&(l+=" - CNPJ<br/>"),""==i&&(l+=" - Situacao<br/>"),""==l||(fCriarAlertaModalCad(TP_ALERTA_AVISO,"Os seguintes campos não estão preenchido: <br/>"+l),!1)}catch(a){return fCriarAlertaModalCad(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}function fSalvarDados(a){try{if(!fValidarDados())return!1;iniciarAnimacaoSalvar();var r=$("#txtCadEmprId").val(),t=$("#txtCadEmprSetor").val(),e=$("#txtCadEmprSubSetor").val(),i=$("#txtCadEmprSegmento").val(),l=$("#txtCadEmprNome").val(),o=$("#txtCadEmprRazao").val(),d=$("#txtCadEmprCNPJ").val(),n=$("#txtCadEmprAtividade").val(),A=$("#txtCadEmprCodCVM").val(),m=$("#txtCadEmprSitCVM").val(),s=$("#txtCadEmprSituacao").val();$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"empresa/salvar",data:{EmprId:r,EmprSetor:t,EmprSubSetor:e,EmprSegmento:i,EmprNome:l,EmprRazao:o,EmprCNPJ:d,EmprAtividade:n,EmprCodCVM:A,EmprSitCVM:m,EmprSituacao:s},success:function(r){finalizarAnimacaoSalvar();var t=r.data.Resultado,e=r.data.Mensagem;if("NSESSAO"==t)return $(location).attr("href",a+"/login"),!1;"NOK"!=t?"FALHA"!=t&&"OK"==t?($("#PopModalDetalheEmpresa").modal("hide"),fCarregarGrid(a),buscar_todos_nomes_empresas_acoes(a,"txtCadInclAtvEmpresa",!1,!1,!0),fCriarAlertaPrinc(TP_ALERTA_SUCESSO,"Dados salvo com sucesso!")):fCriarAlertaModalCad(TP_ALERTA_ERRO,e):fCriarAlertaModalCad(TP_ALERTA_AVISO,e)},error:function(a){finalizarAnimacaoSalvar(),fCriarAlertaModalCad(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}})}catch(a){return finalizarAnimacaoSalvar(),void CriarAlertaModal(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fLimparAreaAlertaModalCadEmpr(){fLimparAreaAlerta("AreaAlertaModalCadEmpr")}function fCriarAlertaModalCadEmpr(a,r){fCriarAlerta("AreaAlertaModalCadEmpr",a,r)}function fAbrirModalIncEmpresa(a){try{$("#txtCadInclEmprSetor").val(""),$("#txtCadInclEmprSubSetor").val(""),$("#txtCadInclEmprSegmento").val(""),$("#txtCadInclEmprNome").val(""),$("#txtCadInclEmprRazao").val(""),$("#txtCadInclEmprCNPJ").val(""),$("#txtCadInclEmprAtividade").val(""),$("#txtCadInclEmprCodCVM").val(""),$("#txtCadInclEmprSitCVM").val(""),$("#txtCadInclEmprSituacao").val("A"),$("#PopModalIncluirEmpresa").modal({backdrop:"static"})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fValidarDadosEmpresa(){try{fLimparAreaAlertaModalCadEmpr();var a=$("#txtCadInclEmprSetor").val(),r=$("#txtCadInclEmprSubSetor").val(),t=$("#txtCadInclEmprSegmento").val(),e=$("#txtCadInclEmprNome").val(),i=$("#txtCadInclEmprRazao").val(),l=$("#txtCadInclEmprCNPJ").val(),o=$("#txtCadInclEmprSituacao").val(),d="";return""==a&&(d+=" - Setor<br/>"),""==r&&(d+=" - Sub-Setor<br/>"),""==t&&(d+=" - Segmento<br/>"),""==e&&(d+=" - Nome<br/>"),""==i&&(d+=" - Razao<br/>"),""==l&&(d+=" - CNPJ<br/>"),""==o&&(d+=" - Situacao<br/>"),""==d||(fCriarAlertaModalCadEmpr(TP_ALERTA_AVISO,"Os seguintes campos não estão preenchido: <br/>"+d),!1)}catch(a){return fCriarAlertaModalCad(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}function fSalvarDadosEmpr(a){try{if(!fValidarDadosEmpresa())return!1;iniciarAnimacaoSalvar();var r=$("#txtCadInclEmprSetor").val(),t=$("#txtCadInclEmprSubSetor").val(),e=$("#txtCadInclEmprSegmento").val(),i=$("#txtCadInclEmprNome").val(),l=$("#txtCadInclEmprRazao").val(),o=$("#txtCadInclEmprCNPJ").val(),d=$("#txtCadInclEmprAtividade").val(),n=$("#txtCadInclEmprCodCVM").val(),A=$("#txtCadInclEmprSitCVM").val(),m=$("#txtCadInclEmprSituacao").val();$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"empresa/salvarEmpresa",data:{EmprSetor:r,EmprSubSetor:t,EmprSegmento:e,EmprNome:i,EmprRazao:l,EmprCNPJ:o,EmprAtividade:d,EmprCodCVM:n,EmprSitCVM:A,EmprSituacao:m},success:function(r){finalizarAnimacaoSalvar();var t=r.data.Resultado,e=r.data.Mensagem;if("NSESSAO"==t)return $(location).attr("href",a+"/login"),!1;"NOK"!=t?"FALHA"!=t&&"OK"==t?($("#PopModalIncluirEmpresa").modal("hide"),fCarregarFiltroEmpresa(a),fCarregarGrid(a),buscar_todos_nomes_empresas_acoes(a,"txtCadInclAtvEmpresa",!1,!1,!0),fCriarAlertaPrinc(TP_ALERTA_SUCESSO,"Dados salvo com sucesso!")):fCriarAlertaModalCadEmpr(TP_ALERTA_ERRO,e):fCriarAlertaModalCadEmpr(TP_ALERTA_AVISO,e)},error:function(a){finalizarAnimacaoSalvar(),fCriarAlertaModalCadEmpr(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}})}catch(a){return finalizarAnimacaoSalvar(),void CriarAlertaModal(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fLimparAreaAlertaModalCadAtivo(){fLimparAreaAlerta("AreaAlertaModalCadAtv")}function fCriarAlertaModalCadAtivo(a,r){fCriarAlerta("AreaAlertaModalCadAtv",a,r)}function fAbrirModalIncAtivo(a){try{$("#txtCadInclAtvEmpresa").val(""),$("#txtCadInclAtvCodigo").val(""),$("#txtCadInclAtvCodIsin").val(""),$("#txtCadInclAtvTipo").val(""),$("#txtCadInclAtvSituacao").val("A"),$("#PopModalIncluirAtivo").modal({backdrop:"static"})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fValidarDadosAtivo(){try{fLimparAreaAlertaModalCadAtivo();var a=$("#txtCadInclAtvEmpresa").val(),r=$("#txtCadInclAtvCodigo").val(),t=($("#txtCadInclAtvCodIsin").val(),$("#txtCadInclAtvTipo").val(),$("#txtCadInclAtvSituacao").val()),e="";return""==a&&(e+=" - Empresa<br/>"),""==r&&(e+=" - Ativo<br/>"),""==t&&(e+=" - Situacao<br/>"),""==e||(fCriarAlertaModalCad(TP_ALERTA_AVISO,"Os seguintes campos não estão preenchido: <br/>"+e),!1)}catch(a){return fCriarAlertaModalCad(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}function fSalvarDadosAtivo(a){try{if(!fValidarDadosAtivo())return!1;iniciarAnimacaoSalvar();var r=$("#txtCadInclAtvEmpresa").val(),t=$("#txtCadInclAtvCodigo").val(),e=$("#txtCadInclAtvCodIsin").val(),i=$("#txtCadInclAtvTipo").val(),l=$("#txtCadInclAtvSituacao").val();$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"empresa/salvarAtivo",data:{AtvEmpresa:r,AtvCodigo:t,AtvCodIsin:e,AtvTipo:i,AtvSituacao:l},success:function(r){finalizarAnimacaoSalvar();var t=r.data.Resultado,e=r.data.Mensagem;if("NSESSAO"==t)return $(location).attr("href",a+"/login"),!1;"NOK"!=t?"FALHA"!=t&&"OK"==t?($("#PopModalIncluirAtivo").modal("hide"),fCarregarGrid(a),fCriarAlertaPrinc(TP_ALERTA_SUCESSO,"Dados salvo com sucesso!")):fCriarAlertaModalCadAtivo(TP_ALERTA_ERRO,e):fCriarAlertaModalCadAtivo(TP_ALERTA_AVISO,e)},error:function(a){finalizarAnimacaoSalvar(),fCriarAlertaModalCadAtivo(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}})}catch(a){return finalizarAnimacaoSalvar(),void CriarAlertaModal(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}$(document).ready(function(){$("#MnPrincEmpresa").addClass("active open"),fLimparAreaAlertaPrinc(),fLimparAreaAlertaModalCad()});