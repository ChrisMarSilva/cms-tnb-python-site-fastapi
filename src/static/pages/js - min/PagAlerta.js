function iniciarAnimacaoPesquisar(){$("#iRefresh").addClass("fa-spin"),$("#btnPesquisar").addClass("disabled")}function finalizarAnimacaoPesquisa(){$("#iRefresh").removeClass("fa-spin"),$("#btnPesquisar").removeClass("disabled")}function fLimparGrid(a){$("#txtDataIni").val(fDataPrimeira()),$("#txtDataFim").val(fDataUltima()),fLimparSomenteGrid(a)}function fLimparSomenteGrid(a){try{finalizarAnimacaoPesquisa(),$("th").addClass("text-center"),$("#Grid").dataTable().fnClearTable(),$("#Grid").dataTable({bDestroy:!0}).fnDestroy(),$("#Grid").DataTable({data:[],oLanguage:fTraduzirGrid(),aoColumns:[{bSortable:!0,sWidth:widthGridDtHr,targets:idxGridDtHr},{bSortable:!0,sWidth:widthGridDtEnvio,targets:idxGridDtEnvio},{bSortable:!0,sWidth:widthGridNmUsuario,targets:idxGridNmUsuario},{bSortable:!0,sWidth:widthGridTipo,targets:idxGridTipo},{bSortable:!0,sWidth:widthGridMensagem,targets:idxGridMensagem},{bSortable:!0,sWidth:widthGridSitTelegram,targets:idxGridSitTelegram},{bSortable:!0,sWidth:widthGridSitEmail,targets:idxGridSitEmail},{visible:!1,targets:idxGridIdUsuario},{visible:!1,targets:idxGridIdAlerta},{bSortable:!1,sWidth:widthGridAcao,targets:idxGridAcao}],bLengthChange:!1,bFilter:!0,searchable:!0,orderable:!0,bAutoWidth:!1})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fMontarGrid(a,r){try{var i=-1;$("#Grid").DataTable({processing:!0,serverSide:!1,oLanguage:fTraduzirGrid(),data:r,aoColumns:[{bSortable:!0,sWidth:widthGridDtHr,targets:idxGridDtHr,render:function(a,r,i){return"display"==r?colcarFormacataoDataHora(i[idxGridDtHr]):a}},{bSortable:!0,sWidth:widthGridDtEnvio,targets:idxGridDtEnvio,render:function(a,r,i){return"display"==r?colcarFormacataoData(i[idxGridDtEnvio]):a}},{bSortable:!0,sWidth:widthGridNmUsuario,targets:idxGridNmUsuario,render:function(a,r,i){return"display"==r?i[idxGridIdUsuario]+" - "+i[idxGridNmUsuario]:a}},{bSortable:!0,sWidth:widthGridTipo,targets:idxGridTipo,render:function(a,r,i){return"display"==r?i[idxGridTipo]:a}},{bSortable:!0,sWidth:widthGridMensagem,targets:idxGridMensagem,render:function(a,r,i){return"display"==r?trocar_tag_br(i[idxGridMensagem]):a}},{bSortable:!0,sWidth:widthGridSitTelegram,targets:idxGridSitTelegram,render:function(a,r,i){return"display"==r?i[idxGridSitTelegram]:a}},{bSortable:!0,sWidth:widthGridSitEmail,targets:idxGridSitEmail,render:function(a,r,i){return"display"==r?i[idxGridSitEmail]:a}},{visible:!1,targets:idxGridIdUsuario,render:function(a,r,i){return"display"==r?i[idxGridIdUsuario]:a}},{visible:!1,targets:idxGridIdAlerta,render:function(a,r,i){return"display"==r?i[idxGridIdAlerta]:a}},{bSortable:!1,sWidth:widthGridAcao,targets:idxGridAcao,render:function(r,t,e){var d="";if("display"==t){i+=1;e[idxGridIdUsuario];var s=e[idxGridIdAlerta];d+='<div class="btn-group btn-group-sm" role="group" aria-label="Basic example">',d+='<a id="BtnExclAlerta-'+i+'" class="btn btn-sm btn-danger btn-icon btn-icon-mini btn-round btn-simple" style="font-size:0.5rem;" title="Excluir Alerta('+s+')" href="javascript:void(0);" role="button" aria-pressed="true" onclick="fExcluirAlerta( \''+a+"', '"+s+"', '"+i+"' );\">",d+='   <i class="fa fa-trash-o fa-lg" aria-hidden="true"></i> ',d+="</a>",d+="</div>"}return d}}],createdRow:function(a,r,i){var t=r[idxGridSitTelegram],e=r[idxGridSitEmail];$(a).attr("id","GridTr-"+i),$("td",a).eq(idxGridNmUsuario).addClass("text-left"),$("td",a).eq(idxGridTipo).addClass("text-left"),$("td",a).eq(idxGridMensagem).addClass("text-left"),"Pendente"==t&&$("td",a).eq(idxGridSitTelegram).addClass("text-muted"),"Enviado"==t&&$("td",a).eq(idxGridSitTelegram).addClass("text-success"),"Erro"==t&&$("td",a).eq(idxGridSitTelegram).addClass("text-danger"),"Desconhecido"==t&&$("td",a).eq(idxGridSitTelegram).addClass("text-primary"),"Pendente"==e&&$("td",a).eq(idxGridSitEmail).addClass("text-muted"),"Enviado"==e&&$("td",a).eq(idxGridSitEmail).addClass("text-success"),"Erro"==e&&$("td",a).eq(idxGridSitEmail).addClass("text-danger"),"Desconhecido"==e&&$("td",a).eq(idxGridSitEmail).addClass("text-primary")},initComplete:function(a,r){finalizarAnimacaoPesquisa()},bPaginate:!1,bLengthChange:!1,bFilter:!0,searchable:!0,bAutoWidth:!1,bInfo:!0,bSearchable:!0,bSortable:!0,orderable:!0,bOrderable:!0,bOrdering:!0});$(document).ajaxError(function(r,i,t,e){fLimparSomenteGrid(a),finalizarAnimacaoPesquisa()})}catch(r){fLimparSomenteGrid(a),finalizarAnimacaoPesquisa(),null!=r.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fCarregarGrid(a){try{promise=new Promise((r,i)=>{fLimparAreaAlertaPrinc(),finalizarAnimacaoPesquisa(),iniciarAnimacaoPesquisar(),$("#Grid").dataTable().fnClearTable(),$("#Grid").dataTable({bDestroy:!0}).fnDestroy();var t=tirarFormacataoData($("#txtDataIni").val().trim()),e=tirarFormacataoData($("#txtDataFim").val().trim());$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"alerta/grid",data:{DataIni:t,DataFim:e},success:function(r){var i=r.data.Resultado,t=r.data.Mensagem,e=r.data.Lista;return"NSESSAO"==i?($(location).attr("href",a+"/login"),!1):"NOK"==i?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_AVISO,t)):"FALHA"==i?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,t)):"OK"!=i?(finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,t)):void fMontarGrid(a,e)},error:function(r,i,t){return finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),!1}}),r(!0)}).then(a=>{}).catch(a=>{finalizarAnimacaoPesquisa(),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(r){finalizarAnimacaoPesquisa(),fLimparSomenteGrid(a),null!=r.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fExcluirAlerta(a,r,i){try{promise=new Promise((t,e)=>{if(""==r)return fCriarAlertaPrinc(TP_ALERTA_AVISO,"Id. Alerta não informado"),!1;$.ajax({dataType:"json",type:"post",url:a+"alerta/excluir",data:{IdAlerta:r},success:function(r){var t=r.data.Resultado,e=r.data.Mensagem;return"NSESSAO"==t?($(location).attr("href",a+"/login"),!1):"NOK"==t?(fCriarAlerta("AreaAlertaModalExcTds",TP_ALERTA_AVISO,e),!1):"FALHA"==t?void fCriarAlerta("AreaAlertaModalExcTds",TP_ALERTA_ERRO,e):"OK"==t?(fAlterarLinhaGridAlerta(a,i.toString()),!0):(fCriarAlerta("AreaAlertaModalExcTds",TP_ALERTA_ERRO,e),!1)},error:function(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}),t(!0)}).then(a=>{}).catch(a=>{fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fAlterarLinhaGridAlerta(a,r){try{promise=new Promise((a,i)=>{$("#BtnExclAlerta-"+r).removeClass("btn-danger"),$("#BtnExclAlerta-"+r).addClass("btn-muted"),$("#BtnExclAlerta-"+r).addClass("disabled"),$("#GridTr-"+r).children("td").addClass("text-danger"),$("#GridTr-"+r).closest("tr").fadeOut(400),a(!0)}).then(a=>{}).catch(a=>{finalizarAnimacaoSalvarCei(),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){return finalizarAnimacaoSalvarCei(),void fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fAbrirModalCriarAlerta(){try{fLimparAreaAlertaPrinc(),fLimparAreaAlerta("AlertaModalDadosAlerta"),$("#txtDetAlertaTipo").val(""),$("#txtDetAlertaUser").val(""),$("#txtDetAlertaMsg").val(""),fDefinirPadraoSelect("txtDetAlertaTipo"),fDefinirPadraoSelect("txtDetAlertaUser"),$("#PopModalDadosAlerta").modal({backdrop:"static"}),$("#txtDetAlertaMsg").focus()}catch(a){fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function iniciarAnimacaoSalvarAlerta(){$("#iDadosAlertaSalvar").removeClass("fa-check"),$("#iDadosAlertaSalvar").addClass("fa-spinner"),$("#iDadosAlertaSalvar").addClass("fa-pulse"),$("#BtnModalDadosAlertaSalvar").addClass("disabled")}function finalizarAnimacaoSalvarAlerta(){$("#iDadosAlertaSalvar").removeClass("fa-spinner"),$("#iDadosAlertaSalvar").removeClass("fa-pulse"),$("#iDadosAlertaSalvar").addClass("fa-check"),$("#BtnModalDadosAlertaSalvar").removeClass("disabled")}function fSalvarDadosAlerta(a){try{promise=new Promise((r,i)=>{fLimparAreaAlertaPrinc(),finalizarAnimacaoSalvarAlerta(),iniciarAnimacaoSalvarAlerta();var t=$("#txtDetAlertaTipo").val().trim(),e=$("#txtDetAlertaUser").val().trim(),d=$("#txtDetAlertaMsg").val().trim();return""==t?(finalizarAnimacaoSalvarAlerta(),void fCriarAlerta("AlertaModalDadosAlerta",TP_ALERTA_AVISO,"Tipo não informado!")):("ADMIN-01"==t&&(e=""),"ADMIN-02"==t&&""==e?(finalizarAnimacaoSalvarAlerta(),void fCriarAlerta("AlertaModalDadosAlerta",TP_ALERTA_AVISO,"Usuario não informado!")):""==d?(finalizarAnimacaoSalvarAlerta(),void fCriarAlerta("AlertaModalDadosAlerta",TP_ALERTA_AVISO,"Msg não informado!")):($.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"alerta/salvar",data:{txtTipo:t,txtUser:e,txtMsg:d},success:function(r){finalizarAnimacaoSalvarAlerta();var i=r.data.Resultado,t=r.data.Mensagem;if("NSESSAO"==i)return $(location).attr("href",a+"/login"),!1;"NOK"!=i?"OK"==i?($("#PopModalDadosAlerta").modal("hide"),fCarregarGrid(a)):fCriarAlertaPrinc(TP_ALERTA_ERRO,t):fCriarAlertaPrinc(TP_ALERTA_AVISO,t)},error:function(a,r,i){finalizarAnimacaoSalvarAlerta(),fCriarAlerta("AlertaModalDadosAlerta",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}),void r(!0)))}).then(a=>{}).catch(a=>{finalizarAnimacaoSalvarAlerta(),fCriarAlerta("AlertaModalDadosAlerta",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){return finalizarAnimacaoSalvarAlerta(),void fCriarAlerta("AlertaModalDadosAlerta",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fLimparSomenteGridUser(a){try{$("#GridUser > thead > th").addClass("text-left"),$("#GridUser > thead > tr").addClass("text-left"),$("#GridUser").dataTable().fnClearTable(),$("#GridUser").dataTable({bDestroy:!0}).fnDestroy(),$("#GridUser").DataTable({data:[],oLanguage:fTraduzirGrid(),aoColumns:[{bSortable:!0,sWidth:widthGridUserNmUsuario,targets:idxGridUserNmUsuario},{bSortable:!0,sWidth:widthGridUserTpAlerta,targets:idxGridUserTpAlerta},{bSortable:!0,sWidth:widthGridUserTpAssinatura,targets:idxGridUserTpAssinatura},{visible:!1,targets:idxGridUserIdUsuario},{visible:!1,targets:idxGridUserIdAssinatura},{visible:!1,targets:idxGridUserSituacao},{bSortable:!1,sWidth:widthGridUserAcao,targets:idxGridUserAcao}],bLengthChange:!1,bFilter:!0,searchable:!0,orderable:!0,bAutoWidth:!1})}catch(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fMontarGridUser(a,r){try{$("#GridUser > thead > th").addClass("text-left"),$("#GridUser > thead > tr").addClass("text-left");var i=-1;$("#GridUser").DataTable({processing:!0,serverSide:!1,oLanguage:fTraduzirGrid(),data:r,aoColumns:[{bSortable:!0,sWidth:widthGridUserNmUsuario,targets:idxGridUserNmUsuario,render:function(a,r,i){return"display"==r?i[idxGridUserIdUsuario]+" - "+i[idxGridUserNmUsuario]:a}},{bSortable:!0,sWidth:widthGridUserTpAlerta,targets:idxGridUserTpAlerta,render:function(a,r,i){return"display"==r?i[idxGridUserTpAlerta]:a}},{bSortable:!0,sWidth:widthGridUserTpAssinatura,targets:idxGridUserTpAssinatura,render:function(a,r,i){return"display"==r?i[idxGridUserTpAssinatura]:a}},{visible:!1,targets:idxGridUserIdUsuario,render:function(a,r,i){return"display"==r?i[idxGridUserIdUsuario]:a}},{visible:!1,targets:idxGridUserIdAssinatura,render:function(a,r,i){return"display"==r?i[idxGridUserIdAssinatura]:a}},{visible:!1,targets:idxGridUserSituacao,render:function(a,r,i){return"display"==r?i[idxGridUserSituacao]:a}},{bSortable:!1,sWidth:widthGridUserAcao,targets:idxGridUserAcao,render:function(r,t,e){var d="";if("display"==t){i+=1;e[idxGridUserIdUsuario];var s=e[idxGridUserIdAssinatura],n=e[idxGridUserSituacao];d+='<div class="btn-group btn-group-sm" role="group" aria-label="Basic example">',d+='<a id="BtnAtivaAssinatura-'+i+'" class="btn btn-sm btn-'+("I"==n?"success":"muted")+" btn-icon btn-icon-mini btn-round btn-simple"+("I"==n?"":" disabled")+'" style="font-size:0.5rem;" title="Inativar Assinatura('+s+')" href="javascript:void(0);" role="button" aria-pressed="true" onclick="fAlterarAssinatura( \''+a+"', '"+s+"', 'A', '"+i+"' );\">",d+='   <i class="fa fa-thumbs-up fa-lg" aria-hidden="true"></i> ',d+="</a>",d+="&nbsp;",d+='<a id="BtnInativaAssinatura-'+i+'" class="btn btn-sm btn-'+("A"==n?"danger":"muted")+" btn-icon btn-icon-mini btn-round btn-simple"+("A"==n?"":" disabled")+'" style="font-size:0.5rem;" title="Inativar Assinatura('+s+')" href="javascript:void(0);" role="button" aria-pressed="true" onclick="fAlterarAssinatura( \''+a+"', '"+s+"', 'I', '"+i+"' );\">",d+='   <i class="fa fa-thumbs-down fa-lg" aria-hidden="true"></i> ',d+="</a>",d+="</div>"}return d}}],createdRow:function(a,r,i){$(a).addClass("text-left font-weight-bold"),$(a).attr("id","GridUserTr-"+i);var t=r[idxGridUserSituacao];"A"==t&&$("td",a).addClass("text-success"),"I"==t&&$("td",a).addClass("text-danger")},initComplete:function(a,r){},bPaginate:!1,bLengthChange:!1,bFilter:!0,searchable:!0,bAutoWidth:!1,bInfo:!0,bSearchable:!0,bSortable:!0,orderable:!0,bOrderable:!0,bOrdering:!0});$(document).ajaxError(function(r,i,t,e){fLimparSomenteGridUser(a)})}catch(r){fLimparSomenteGridUser(a),null!=r.description&&fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fAbrirModalUserAlerta(a){try{promise=new Promise((r,i)=>{fLimparAreaAlertaPrinc(),fLimparAreaAlerta("AlertaModalDadosUserAlerta"),$("#GridUser").dataTable().fnClearTable(),$("#GridUser").dataTable({bDestroy:!0}).fnDestroy(),$.ajax({cache:"false",dataType:"json",async:!0,type:"POST",url:a+"alerta/griduserassinatura",success:function(r){var i=r.data.Resultado,t=r.data.Mensagem,e=r.data.Lista;return"NSESSAO"==i?($(location).attr("href",a+"/login"),!1):"NOK"==i?(fLimparSomenteGridUser(a),void fCriarAlertaPrinc(TP_ALERTA_AVISO,t)):"FALHA"==i?(fLimparSomenteGridUser(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,t)):"OK"!=i?(fLimparSomenteGridUser(a),void fCriarAlertaPrinc(TP_ALERTA_ERRO,t)):($("#PopModalDadosUserAlerta").modal({backdrop:"static"}),void fMontarGridUser(a,e))},error:function(r,i,t){return fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO),fLimparSomenteGridUser(a),!1}}),r(!0)}).then(a=>{}).catch(r=>{fLimparSomenteGridUser(a),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){fCriarAlerta("AreaAlertaPrinc",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fAlterarAssinatura(a,r,i,t){try{promise=new Promise((e,d)=>""==r.toString()?(fCriarAlerta("AlertaModalDadosUserAlerta","Id. Assinatura não informado"),!1):""==i?(fCriarAlerta("AlertaModalDadosUserAlerta","Situação não informada"),!1):($.ajax({dataType:"json",type:"post",url:a+"alerta/alterarassinatura",data:{id_assinatura:r,situacao:i},success:function(r){var e=r.data.Resultado,d=r.data.Mensagem;return"NSESSAO"==e?($(location).attr("href",a+"/login"),!1):"NOK"==e?(fCriarAlerta("AlertaModalDadosUserAlerta",TP_ALERTA_AVISO,d),!1):"FALHA"==e?void fCriarAlerta("AlertaModalDadosUserAlerta",TP_ALERTA_ERRO,d):"OK"==e?(fAlterarLinhaGridUserAlerta(a,t.toString(),i),!0):(fCriarAlerta("AlertaModalDadosUserAlerta",TP_ALERTA_ERRO,d),!1)},error:function(a){fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}),void e(!0))).then(a=>{}).catch(a=>{fCriarAlerta("AlertaModalDadosUserAlerta",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){null!=a.description&&fCriarAlerta("AlertaModalDadosUserAlerta",TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}function fAlterarLinhaGridUserAlerta(a,r,i){try{promise=new Promise((a,t)=>{"A"==i&&($("#GridUserTr-"+r).children("td").removeClass("text-danger"),$("#GridUserTr-"+r).children("td").addClass("text-success"),$("#BtnAtivaAssinatura-"+r).addClass("disabled"),$("#BtnAtivaAssinatura-"+r).removeClass("btn-success"),$("#BtnAtivaAssinatura-"+r).addClass("btn-muted"),$("#BtnInativaAssinatura-"+r).removeClass("disabled"),$("#BtnInativaAssinatura-"+r).removeClass("btn-muted"),$("#BtnInativaAssinatura-"+r).addClass("btn-danger")),"I"==i&&($("#GridUserTr-"+r).children("td").removeClass("text-success"),$("#GridUserTr-"+r).children("td").addClass("text-danger"),$("#BtnAtivaAssinatura-"+r).removeClass("disabled"),$("#BtnAtivaAssinatura-"+r).removeClass("btn-muted"),$("#BtnAtivaAssinatura-"+r).addClass("btn-success"),$("#BtnInativaAssinatura-"+r).addClass("disabled"),$("#BtnInativaAssinatura-"+r).removeClass("btn-danger"),$("#BtnInativaAssinatura-"+r).addClass("btn-muted")),a(!0)}).then(a=>{}).catch(a=>{finalizarAnimacaoSalvarCei(),fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)})}catch(a){return finalizarAnimacaoSalvarCei(),void fCriarAlertaPrinc(TP_ALERTA_ERRO,MSG_ALERTA_ERRO)}}$(document).ready(function(){fLimparAreaAlertaPrinc(),fLimparAreaAlertaModalCad(),fLimparAreaAlertaModalExc(),idxGridDtHr=0,idxGridDtEnvio=1,idxGridNmUsuario=2,idxGridTipo=3,idxGridMensagem=4,idxGridSitTelegram=5,idxGridSitEmail=6,idxGridIdUsuario=7,idxGridIdAlerta=8,idxGridAcao=9,widthGridDtHr="20px",widthGridDtEnvio="10px",widthGridNmUsuario="70px",widthGridTipo="60px",widthGridMensagem="120px",widthGridSitTelegram="10px",widthGridSitEmail="10px",widthGridIdUsuario="",widthGridIdAlerta="",widthGridAcao="5px",idxGridUserNmUsuario=0,idxGridUserTpAlerta=1,idxGridUserTpAssinatura=2,idxGridUserIdUsuario=3,idxGridUserIdAssinatura=4,idxGridUserSituacao=5,idxGridUserAcao=6,widthGridUserNmUsuario="100px",widthGridUserTpAlerta="80px",widthGridUserTpAssinatura="30px",widthGridUserIdUsuario="",widthGridUserIdAssinatura="",widthGridUserSituacao="",widthGridUserAcao="10px"});